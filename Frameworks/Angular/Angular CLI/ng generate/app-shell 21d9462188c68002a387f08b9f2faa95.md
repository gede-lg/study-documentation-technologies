# app-shell

## Título

**Desvendando o `ng generate app-shell`: Acelerando o Carregamento com Angular CLI**

---

## Introdução

A criação de um App Shell no Angular permite pré-renderizar a estrutura básica de uma aplicação, proporcionando percepção de maior velocidade de carregamento ao usuário e facilitando a indexação por mecanismos de busca ([v17.angular.io](https://v17.angular.io/guide/app-shell?utm_source=chatgpt.com), [blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com)). Com o Angular CLI, o comando **`ng generate app-shell`** automatiza a inclusão dessa funcionalidade, integrando-se ao Angular Universal para renderização no lado do servidor, sem a necessidade de configurar manualmente módulos ou builders ([v17.angular.io](https://v17.angular.io/cli/generate?utm_source=chatgpt.com), [blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com)).

---

## Sumário

1. Conceitos Fundamentais
2. Sintaxe e Uso
3. Restrições de Uso
4. Argumentos
5. Opções
6. Melhores Práticas e Casos de Uso
7. Exemplos Completos
8. Tópicos Adicionais
9. Tópicos Relacionados

---

## Conceitos Fundamentais

- **App Shell:** Padrão arquitetural que pré-renderiza uma rota estática da aplicação no build, exibindo ao usuário apenas o esqueleto (estrutura básica) da interface antes do carregamento completo do SPA ([v17.angular.io](https://v17.angular.io/guide/app-shell?utm_source=chatgpt.com), [blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com)).
- **Angular Universal:** Mecanismo que executa o código Angular em Node.js durante a compilação, gerando HTML estático que é injetado no `index.html`, reduzindo o Time to First Paint (TTFP) ([blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com), [github.com](https://github.com/angular/angular-cli/issues/10893?utm_source=chatgpt.com)).
- **Rota pré-renderizada:** Trecho da aplicação (por exemplo, menu ou tela de carregamento) que aparece imediatamente, enquanto o restante do conteúdo é carregado em background.

---

## Sintaxe e Uso

A sintaxe básica do comando é:

```bash
ng generate app-shell [nome] \
  --client-project <nome-do-app> \
  --universal-project <nome-do-ssr> \
  --route <rota-prerender> \
  [--defaults] [--dry-run] [--force] [--interactive]

```

- `nome`: nome do componente App Shell (padrão `app-shell`) ([blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com), [w3resource.com](https://www.w3resource.com/angular/app-shell.php?utm_source=chatgpt.com)).
- `-client-project`: projeto cliente (browser) que receberá o App Shell ([w3resource.com](https://www.w3resource.com/angular/app-shell.php?utm_source=chatgpt.com)).
- `-universal-project`: projeto Universal (SSR) responsável pelo pré-render ([w3resource.com](https://www.w3resource.com/angular/app-shell.php?utm_source=chatgpt.com)).
- `-route`: rota a ser pré-renderizada e usada como esqueleto (ex.: `shell`) ([blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com)).
- Flags comuns do CLI:
    - `-defaults`: desativa prompts interativos ([angular.dev](https://angular.dev/cli/generate?utm_source=chatgpt.com)).
    - `-dry-run` (`d`): simula sem gravar arquivos ([angular.dev](https://angular.dev/cli/generate?utm_source=chatgpt.com)).
    - `-force`: força sobrescrita de arquivos ([angular.dev](https://angular.dev/cli/generate?utm_source=chatgpt.com)).
    - `-interactive`: ativa prompts interativos ([angular.dev](https://angular.dev/cli/generate?utm_source=chatgpt.com)).

---

## Restrições de Uso

- **Apenas uma rota:** o App Shell só suporta pré-renderizar uma rota por build, o que limita seu uso a um único ponto de entrada estático ([codinglatte.com](https://codinglatte.com/posts/angular/app-shell-improve-performance-angular-6/?utm_source=chatgpt.com)).
- **Requer Angular Universal configurado:** sem um projeto SSR, não há como gerar o HTML no build ([blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com)).
- **Conteúdo estático:** não é indicado para rotas com dados altamente dinâmicos ou personalizados, pois o shell é fixo e pode não refletir alterações em tempo real ([blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com)).
- **Complexidade de build:** adiciona etapas extras no processo de build, aumentando seu tempo de compilação.

---

## Argumentos

| Argumento | Descrição | Tipo | Padrão |
| --- | --- | --- | --- |
| `schematic` | Esquema a ser executado: neste caso, `app-shell`. | string | obrigatório |
| `name` | Nome do componente gerado para o App Shell. | string | `app-shell` |

> Fonte: CLI Overview (angular.dev)
> 

---

## Opções

| Opção | Descrição | Tipo | Padrão |
| --- | --- | --- | --- |
| `--client-project <string>` | Nome do projeto cliente (build browser) | string | — |
| `--universal-project <string>` | Nome do projeto Universal (SSR) que fará o pré-render | string | — |
| `--route <string>` | Rota a ser pré-renderizada e usada como App Shell | string | `shell` |
| `--project <string>` | **Alias** para `--client-project`. | string | — |
| `--defaults` | Desativa prompts interativos, aceita valores padrão | boolean | false |
| `--dry-run`, `-d` | Simula a geração sem criar/atualizar arquivos | boolean | false |
| `--force` | Força sobrescrita de arquivos existentes | boolean | false |
| `--interactive` | Habilita prompts interativos | boolean | true |
| `--help` | Exibe mensagens de ajuda | boolean | false |

> Fontes: Angular CLI docs (angular.dev, angular.dev), W3resource (w3resource.com)
> 

---

## Melhores Práticas e Casos de Uso

- **Skeleton screens minimalistas:** exiba apenas estrutura básica (cabeçalho, menu, loading) e evite lógica complexa.
- **Integração com PWA e Service Worker:** combine App Shell com cache do Service Worker para oferecer carregamento offline rápido.
- **Testes de performance:** use Lighthouse ou Chrome DevTools para medir ganho no TTFP após implementar o shell.
- **Conteúdo estático leve:** mantenha o App Shell enxuto para não aumentar demais o tamanho do HTML inicial.
- **Fallback para rotas diferentes:** caso precise de múltiplas rotas, avalie usar o builder de pré-render ou múltiplas execuções de shell.

---

## Exemplos Completos

1. **Criar aplicação com roteamento**
    
    ```bash
    ng new meu-app --routing
    
    ```
    
    ([blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com))
    
2. **Adicionar Angular Universal**
    
    ```bash
    ng generate universal meu-app-server \
      --client-project=meu-app
    
    ```
    
    ([blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com))
    
3. **Gerar App Shell**
    
    ```bash
    ng generate app-shell shell-component \
      --client-project=meu-app \
      --universal-project=meu-app-server \
      --route=shell
    
    ```
    
    ([blog.angular-university.io](https://blog.angular-university.io/angular-app-shell/?utm_source=chatgpt.com))
    
4. **Trecho de `angular.json`**
    
    ```json
    "app-shell": {
      "builder": "@angular-devkit/build-angular:app-shell",
      "options": {
        "browserTarget": "meu-app:build",
        "serverTarget": "meu-app-server:server",
        "route": "shell"
      }
    }
    
    ```
    
    ([w3resource.com](https://www.w3resource.com/angular/app-shell.php?utm_source=chatgpt.com))
    
5. **Build com App Shell**
    
    ```bash
    ng run meu-app:app-shell
    
    ```
    
    ([w3resource.com](https://www.w3resource.com/angular/app-shell.php?utm_source=chatgpt.com))
    

---

## Tópicos Adicionais

- **Prerender:** uso do builder de pré-render para gerar HTML de múltiplas rotas.
- **Hydration:** técnicas de “hidratar” o HTML estático gerado pelo App Shell em versões recentes do Angular.
- **Service Worker e Cache Strategies:** combinar App Shell e SW para máximo desempenho e offline.

---

## Tópicos Relacionados

- Angular Universal: configuração avançada e SSR
- Service Worker em Angular: transformando apps em PWAs
- Performance Web: análise com Lighthouse e métricas Core Web Vitals
- Prerendering vs. Server-Side Rendering: quando usar cada abordagem

Espero que este guia ajude a entender em profundidade o comando `ng generate app-shell` e como aplicá-lo de forma eficaz em seus projetos Angular!