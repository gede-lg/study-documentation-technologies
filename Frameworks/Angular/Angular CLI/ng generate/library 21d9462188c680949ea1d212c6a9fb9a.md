# library

## Título

**Desbravando o comando `ng generate library` do Angular CLI**

---

## Introdução

O comando `ng generate library` do Angular CLI permite criar, de forma padronizada, um projeto de biblioteca dentro de um workspace Angular. Com ele, você gera toda a estrutura mínima — pastas, arquivos de configuração, `public-api.ts`, build scripts — necessária para desenvolver, versionar e publicar componentes, serviços e outros artefatos reutilizáveis em múltiplas aplicações ([angular.dev](https://angular.dev/tools/libraries/creating-libraries?utm_source=chatgpt.com), [angular.dev](https://angular.dev/cli/generate/library)).

---

## Sumário

1. [Conceitos Fundamentais](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#conceitos-fundamentais)
2. [Sintaxe e Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sintaxe-e-uso)
3. [Argumentos](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#argumentos)
4. [Opções](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#op%C3%A7%C3%B5es)
    - Schematic-specific
    - Globais do CLI
5. [Restrições de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#restri%C3%A7%C3%B5es-de-uso)
6. [Melhores Práticas e Casos de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#melhores-pr%C3%A1ticas-e-casos-de-uso)
7. [Exemplo Completo](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#exemplo-completo)
8. [Tópicos Adicionais](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#t%C3%B3picos-adicionais)
9. [Sugestões de Aprofundamento](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sugest%C3%B5es-de-aprofundamento)

---

## Conceitos Fundamentais

- **Workspace Monorepo:**
    
    Um único workspace pode abrigar múltiplos projetos (apps e libs). Usar `ng generate library` mantém tudo organizado em `projects/` e compartilha configurações comuns ([angular.dev](https://angular.dev/tools/libraries/creating-libraries?utm_source=chatgpt.com)).
    
- **Estrutura de uma Library:**
    - **root:** `projects/<nome-da-lib>`
    - **sourceRoot:** `projects/<nome-da-lib>/src`
    - **public-api.ts:** ponto de entrada público (tudo que exportar aqui estará disponível aos consumidores).
    - **Builders:** configurações de build/test/lint específicas para libraries (usam `ng-packagr`).
- **Propósito:**
    
    Criar pacotes reutilizáveis, versionáveis e testáveis, facilitando a manutenção de componentes compartilhados entre apps e o ecossistema de pacotes (npm, GitHub Packages etc.).
    

---

## Sintaxe e Uso

```bash
# Forma completa
ng generate library <name> [options]

# Alias
ng g lib <name> [options]

```

- `<name>`: nome da biblioteca (afeta pasta, identificadores e nomes de projeto).
- `[options]`: flags que ajustam nome, local, prefixo e comportamentos do CLI.
- O comando atualiza automaticamente o `angular.json`, criando uma seção de projeto do tipo `library` ([angular.dev](https://angular.dev/cli/generate/library)).

---

## Argumentos

| Argumento | Tipo | Descrição |
| --- | --- | --- |
| `name` | string | Nome da biblioteca. Usado para nomear pasta, chaves em `angular.json` e prefixos padrões. |

---

## Opções

### 1. Schematic-specific (biblioteca)

| Opção | Alias | Tipo | Padrão | Descrição |
| --- | --- | --- | --- | --- |
| `--entry-file` | — | string | `public-api` | Caminho relativo ao root do workspace para o arquivo de API pública (define exports visíveis). |
| `--prefix` | `-p` | string | `lib` | Prefixo aplicado a seletores de componentes gerados (ex.: `<lib-meu-componente>`). |
| `--project-root` | — | string | — | Diretório raiz da biblioteca. Default: `projects/<name>`. |
| `--skip-install` | — | boolean | `false` | Não executa `npm install` após gerar a biblioteca. |
| `--skip-package-json` | — | boolean | `false` | Não adiciona dependências no `package.json` do workspace. |
| `--skip-ts-config` | — | boolean | `false` | Não atualiza o `tsconfig.json` do workspace com mapeamento de caminhos para a nova biblioteca. |
| `--standalone` | — | boolean | `true` | Gere uma biblioteca usando API standalone (sem necessidade de `NgModule`). |

> (angular.dev)
> 

### 2. Opções Globais do Angular CLI (`ng generate`)

| Opção | Alias | Tipo | Padrão | Descrição |
| --- | --- | --- | --- | --- |
| `--defaults` | — | boolean | `false` | Desabilita prompts interativos para opções que já têm valor. |
| `--dry-run` | `-d` | boolean | `false` | Simula a execução sem gravar alterações. |
| `--force` | — | boolean | `false` | Sobrescreve arquivos existentes sem perguntar. |
| `--help` | — | boolean | — | Exibe ajuda específica para o comando. |
| `--interactive` | — | boolean | `true` | Habilita ou desabilita inputs interativos. |

> (angular.dev)
> 

---

## Restrições de Uso

- **Não usar para projetos de aplicação:**
    
    Use `ng generate application` ou `ng new` para apps.
    
- **Biblioteca muito específica ao app:**
    
    Se seu componente ou serviço só faz sentido em um único app, mantenha-o no próprio projeto.
    
- **Excesso de bibliotecas pequenas:**
    
    Evite gerar libs minúsculas demais; agrupe funcionalidades relacionadas para reduzir complexidade de manutenção.
    
- **Dependências circulares:**
    
    Cuidado ao criar libs que dependem umas das outras — pode gerar ciclos difíceis de resolver.
    

---

## Melhores Práticas e Casos de Uso

1. **Prefixos Claros e Únicos:**
    
    Use um prefixo exclusivo (ex.: `@minha-orga/ui`) para evitar colisões ([angular.dev](https://angular.dev/tools/libraries/creating-libraries?utm_source=chatgpt.com)).
    
2. **Monorepo Organizado:**
    
    Mantenha libraries em `projects/`; use `newProjectRoot` no `angular.json` para ajustar pasta padrão.
    
3. **API Pública Bem Definida:**
    
    Exporte somente o necessário em `public-api.ts` para garantir encapsulamento.
    
4. **Testes Automatizados:**
    
    Implemente testes unitários (`ng test <lib>`) antes de publicar.
    
5. **Versionamento Semântico:**
    
    Aplique SemVer (Major.Minor.Patch) e utilize ferramentas como `standard-version` ou `semantic-release`.
    
6. **Documentação Inline:**
    
    Comente código e mantenha um README na raiz da lib com instruções de uso.
    

---

## Exemplo Completo

```bash
# 1) Cria workspace sem app
ng new meu-workspace --create-application=false --package-manager=npm

cd meu-workspace

# 2) Gera biblioteca
ng generate library minha-lib \
  --prefix=ui --entry-file=public-api.ts \
  --project-root=projects/minha-lib

# 3) Gera um componente dentro da lib
ng generate component botao \
  --project=minha-lib \
  --export --flat=false

# 4) Instala dependências (caso tenha usado --skip-install)
npm install

```

### `angular.json` (trecho relevante)

```json
"projects": {
  "minha-lib": {
    "root": "projects/minha-lib",
    "sourceRoot": "projects/minha-lib/src",
    "projectType": "library",
    "prefix": "ui",
    "architect": {
      "build": {
        "builder": "@angular-devkit/build-angular:ng-packagr",
        "options": {
          "project": "projects/minha-lib/ng-package.json"
        }
      },
      ...
    }
  }
}

```

### Estrutura de Pastas

```
meu-workspace/
├── projects/
│   └── minha-lib/
│       ├── src/
│       │   ├── lib/
│       │   │   └── botao/
│       │   │       ├── botao.component.ts
│       │   │       └── botao.component.html
│       │   └── public-api.ts
│       ├── ng-package.json
│       └── package.json
└── angular.json

```

---

## Tópicos Adicionais

- Como configurar **entry points** secundários (subentry points)
- Integração com **ng-packagr** e ajustes avançados
- Estratégias de **Tree Shaking** em libraries
- Publicação no **npm** e **GitHub Packages**
- Uso de **Schematics** customizados para suas libs

---

## Sugestões de Aprofundamento

- **Criando entry points secundários em Angular Libraries**
- **Versionamento Semântico e Automação de Releases**
- **Testes unitários e integração contínua (CI) para bibliotecas**
- **Documentação automática com Compodoc**
- **Otimização de Bundle Size em Consumers de Library**

---

Espero que esta explanação ajude a dominar o `ng generate library` e a estruturar suas bibliotecas de forma profissional e escalável!