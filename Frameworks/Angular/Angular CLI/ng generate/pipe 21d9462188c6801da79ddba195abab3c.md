# pipe

## T√≠tulo

**Desvendando o `ng generate pipe`: Como criar pipes no Angular CLI passo a passo**

---

## Introdu√ß√£o

O Angular CLI oferece um conjunto poderoso de comandos para acelerar o desenvolvimento de aplica√ß√µes Angular. Entre eles, o comando `ng generate pipe` (ou seu alias `ng g pipe`) permite gerar rapidamente estruturas de pipes, que s√£o classes respons√°veis por transformar valores em templates, separando l√≥gica de apresenta√ß√£o e promovendo reuso. Nesta explica√ß√£o, veremos desde os fundamentos te√≥ricos at√© exemplos completos de uso.

---

## Sum√°rio

1. [Conceitos Fundamentais](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#conceitos-fundamentais)
2. [Sintaxe e Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sintaxe-e-uso)
3. [Restri√ß√µes de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#restricoes-de-uso)
4. [Argumentos](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#argumentos)
5. [Op√ß√µes](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#opcoes)
    - [Espec√≠ficas do schematic `pipe`](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#opcoes-schematic-specific)
    - [Globais do Angular CLI](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#opcoes-globais)
6. [Melhores Pr√°ticas e Casos de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#melhores-praticas-e-casos-de-uso)
7. [Exemplos Completos](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#exemplos-completos)
8. [T√≥picos Adicionais de Interesse](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#topicos-adicionais)
9. [Sugest√µes para Aprofundamento](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sugestoes-para-aprofundamento)

---

## Conceitos Fundamentais

- **O que √© um Pipe?**
    - No Angular, um *pipe* √© uma classe que implementa a interface `PipeTransform`, contendo um m√©todo `transform(value: any, ...args: any[]): any`.
    - Permite **transformar** dados diretamente em bindings de template, por exemplo: `{{ birthDate | date:'dd/MM/yyyy' }}`.
    - **Pure vs Impure**:
        - *Pure pipes* s√≥ executam quando o valor ou os argumentos mudam (padr√£o).
        - *Impure pipes* executam a cada ciclo de detec√ß√£o de mudan√ßas, usados com cuidado por quest√µes de performance.
- **Por que usar o CLI?**
    - Garante padroniza√ß√£o na estrutura de arquivos, nomenclaturas e atualiza√ß√µes autom√°ticas de m√≥dulos.
    - Automatiza registro do pipe no `NgModule` (ou gera pipes standalone).

---

## Sintaxe e Uso

```bash
ng generate pipe <nome-do-pipe> [--op√ß√µes]
# ou usando alias:
ng g pipe <nome-do-pipe> [--op√ß√µes]

```

- `<nome-do-pipe>`:
    - Obrigat√≥rio. Define o nome base do pipe (ex.: `currency-format` resulta em `CurrencyFormatPipe`).
    - Pode conter caminho relativo: `shared/filters/filter-by-status`.
- Exemplos pr√°ticos:
    
    ```bash
    # Gerar um pipe simples em src/app
    ng g pipe capitalize
    
    # Gerar em uma pasta e registrar em um m√≥dulo espec√≠fico
    ng g pipe shared/filters/filterByStatus \
      --module=app/shared/shared.module.ts
    
    # Pipe standalone sem m√≥dulo
    ng g pipe date-utc --standalone
    
    ```
    

Ao executar, o CLI cria:

```
src/app/
 ‚îî‚îÄ‚îÄ capitalize.pipe.ts
 ‚îî‚îÄ‚îÄ capitalize.pipe.spec.ts   (se n√£o usar --skip-tests)

```

E atualiza (se aplic√°vel) o array `declarations` do m√≥dulo ou marca a classe `@Pipe({ standalone: true, ... })`.

---

## Restri√ß√µes de Uso

- **C√°lculos Pesados**: Evite l√≥gica custosa em pipes puros; prefira m√©todos de componente ou servi√ßos.
- **Estados Mut√°veis**: Pipes puros n√£o detectam mudan√ßas internas de objetos; para isso, use pipes impuros ou gerencie estados externamente.
- **Dados Ass√≠ncronos**: N√£o use pipes para lidar diretamente com *Observables* (use o `| async` embutido).
- **Reuso Inadequado**: N√£o crie pipes para cada varia√ß√£o pontual; avalie se √© melhor fun√ß√£o no componente.

---

## Argumentos

| Argumento | Descri√ß√£o |
| --- | --- |
| `<name>` | Nome do pipe a ser criado (ex.: `my-custom` ‚Üí `MyCustomPipe`). |

> Observa√ß√£o: Todos os demais par√¢metros s√£o passados como options (flags nomeadas), n√£o como argumentos posicionais.
> 

---

## Op√ß√µes

### Op√ß√µes Schematic-specific

| Op√ß√£o | Tipo | Padr√£o | Descri√ß√£o |
| --- | --- | --- | --- |
| `--project <string>` | string | workspace definido | Nome do projeto no workspace onde o pipe ser√° criado. |
| `--path <string>` | string | `src/app` | Caminho base para gerar o pipe. |
| `--module <string>` (`-m`) | string | ‚Äî | Arquivo de m√≥dulo (`.module.ts`) para declarar e importar automaticamente o pipe. |
| `--flat`/`--no-flat` | boolean | `true` | Se `false`, cria uma pasta com o nome do pipe e gera os arquivos dentro dela. |
| `--skip-import` | boolean | `false` | Se `true`, n√£o adiciona o pipe ao `NgModule`. |
| `--skip-tests` | boolean | `false` | Se `true`, n√£o gera o arquivo de teste `.spec.ts`. |
| `--type <string>` | string | `'pipe'` | Sufixo a ser usado no nome do arquivo e classe (ex.: `snake.pipe.ts`). |
| **`--type-separator <string>`** | string | `-` | Caractere separador entre o nome e o tipo no nome de arquivo e nome da classe (ex.: `my-name_pipe.ts` se for `_`). |
| `--prefix <string>` | string | definido no projeto | Prefixo a ser usado na metadata `@Pipe({ name: 'app' + Nome })`. |
| `--standalone` | boolean | `false` | Se `true`, gera o pipe como *standalone* (sem necessidade de m√≥dulo). |
| `--export` | boolean | `false` | Se `true` e m√≥dulo for especificado, adiciona o pipe ao array `exports` do m√≥dulo. |

### Op√ß√µes Globais do Angular CLI

| Op√ß√£o | Tipo | Descri√ß√£o |
| --- | --- | --- |
| `--dry-run` / `-d` | boolean | Simula a gera√ß√£o sem escrever arquivos. |
| `--help` / `-h` | boolean | Exibe ajuda sobre o comando. |
| `--verbose` | boolean | Exibe informa√ß√µes detalhadas durante a execu√ß√£o. |
| `--force` / `-f` | boolean | Sobrescreve arquivos existentes sem solicitar confirma√ß√£o. |
| `--collection <name>` | string | Use uma cole√ß√£o de schematics diferente (ex.: `@nrwl/workspace`). |
| `--interactive` | boolean | Habilita/desabilita prompts interativos. |

---

## Melhores Pr√°ticas e Casos de Uso

1. **Prefixo Consistente**
    - Use o mesmo prefixo do projeto (`app`, `shared`) para evitar conflitos de nome no DOM.
2. **Pipes Puros para Formata√ß√£o**
    - Datas, moedas, texto (mai√∫sculas, min√∫sculas), pluraliza√ß√£o.
3. **Pipes Impuros com Cautela**
    - Filtros din√¢micos (listas), mas controle a quantidade de itens para n√£o degradar performance.
4. **Organiza√ß√£o de Pastas**
    - Agrupe pipes compartilhados em `src/app/shared/pipes/`.
5. **Testes Automatizados**
    - Mantenha `skip-tests=false` para garantir cobertura de transforma√ß√µes cr√≠ticas.
6. **Pipes Standalone**
    - Em arquiteturas modulares, prefira pipes standalone e importe-os em componentes espec√≠ficos.

---

## Exemplos Completos

### 1. Pipe de Filtro de Status (Impuro)

```bash
ng g pipe shared/pipes/filterByStatus \
  --module=app/shared/shared.module.ts \
  --flat=false \
  --skip-tests=false \
  --type=filter \
  --prefix=app \
  --standalone=false

```

**Arquivos gerados**

```
src/app/shared/pipes/filter-by-status/
 ‚îú‚îÄ‚îÄ filter-by-status.filter.ts
 ‚îú‚îÄ‚îÄ filter-by-status.filter.spec.ts

```

**filter-by-status.filter.ts**

```
import { Pipe, PipeTransform } from '@angular/core';
import { Item } from '../models/item.model';

@Pipe({
  name: 'appFilterByStatus',
  pure: false  // impuro para reagir a altera√ß√µes internas
})
export class FilterByStatusFilter implements PipeTransform {
  transform(items: Item[], status: string): Item[] {
    if (!items || !status) return items;
    return items.filter(item => item.status === status);
  }
}

```

**Uso no template**

```html
<ul>
  <li *ngFor="let item of items | appFilterByStatus:'active'">
    {{ item.name }}
  </li>
</ul>

```

### 2. Pipe Standalone de Uppercase

```bash
ng g pipe pipes/upper \
  --standalone=true \
  --skip-tests=true

```

**upper.pipe.ts**

```
import { Pipe, PipeTransform } from '@angular/core';

@Pipe({
  name: 'upper',
  standalone: true
})
export class UpperPipe implements PipeTransform {
  transform(value: string): string {
    return value?.toUpperCase() || '';
  }
}

```

**Uso em componente standalone**

```
@Component({
  selector: 'app-hello',
  template: `<p>{{ 'Ol√°, mundo!' | upper }}</p>`,
  standalone: true,
  imports: [UpperPipe]
})
export class HelloComponent {}

```

---

## T√≥picos Adicionais

- **Pure vs Impure Pipes:** quando e como escolher.
- **Criando Schematics Personalizados:** estenda o CLI com seus pr√≥prios blueprints.
- **Integra√ß√£o com Bibliotecas de Terceiros:** como gerar pipes em bibliotecas Angular.
- **Performance de Pipes:** perfilando mudan√ßas de detec√ß√£o.

---

## Sugest√µes para Aprofundamento

- **`ng generate component`**, **`ng generate directive`**, **`ng generate service`**
- **Custom Schematics**: desenvolver seus pr√≥prios comandos
- **Standalone Components & NgModules**: arquiteturas h√≠bridas
- **`async` Pipe**: manipula√ß√£o de streams no template
- **Monorepos Angular**: gerenciando m√∫ltiplos projetos e bibliotecas

---

> Essa estrutura visa cobrir desde a teoria at√© a aplica√ß√£o pr√°tica do ng generate pipe, detalhando cada op√ß√£o e apresentando exemplos robustos para diferentes cen√°rios. Se desejar aprofundar em algum ponto espec√≠fico, basta indicar! üòä
>