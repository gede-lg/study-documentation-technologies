# service

**ng generate service: Gerando Serviços de Forma Consistente no Angular CLI**

---

## Parte 1: Visão Geral e Conceitos

### Introdução

O comando `ng generate service` (ou `ng g s`) do Angular CLI facilita a criação de serviços no seu projeto Angular, gerando automaticamente a estrutura de arquivos e o boilerplate necessário. Serviços em Angular são classes anotadas com `@Injectable` que encapsulam lógica reutilizável—como acesso a APIs, manipulação de dados ou utilitários—e são distribuídos via Dependency Injection ([angular.dev](https://angular.dev/cli/generate/service)).

### Sumário

1. [Conceitos Fundamentais](service%2021d9462188c680f4b1efc7c53f6bcd54.md)
2. [Restrições de Uso](service%2021d9462188c680f4b1efc7c53f6bcd54.md)
3. [Sintaxe e Uso](service%2021d9462188c680f4b1efc7c53f6bcd54.md)
4. [Argumentos](service%2021d9462188c680f4b1efc7c53f6bcd54.md)
5. [Opções](service%2021d9462188c680f4b1efc7c53f6bcd54.md)
    - Schematic-specific
    - Globais do Angular CLI
6. [Melhores Práticas e Casos de Uso](service%2021d9462188c680f4b1efc7c53f6bcd54.md)
7. [Exemplos Completos](service%2021d9462188c680f4b1efc7c53f6bcd54.md)
8. [Tópicos Adicionais](service%2021d9462188c680f4b1efc7c53f6bcd54.md)
9. [Sugestões para Aprofundamento](service%2021d9462188c680f4b1efc7c53f6bcd54.md)

---

### Conceitos Fundamentais

- **Service**: Classe que, anotada com `@Injectable`, disponibiliza dados e comportamentos compartilhados entre componentes e outros serviços.
- **Dependency Injection (DI)**: Mecanismo pelo qual o Angular instancia e injeta serviços nas classes que os declaram como dependências, garantindo baixo acoplamento e fácil testabilidade.
- **providedIn**: Propriedade do `@Injectable` que define o escopo do provedor. Por padrão, `providedIn: 'root'` registra o serviço no injector raiz, tornando-o singleton em toda a aplicação.

---

### Restrições de Uso

- **Lógica trivial**: Para funcionalidades muito simples ou de uso único, implementar funções utilitárias puras pode ser mais eficiente do que criar um serviço completo.
- **Escopo de provedor específico**: Se precisar de um serviço disponível apenas em um *feature module* ou em um *lazy-loaded module*, o CLI não oferece opção direta de `-providedIn` distinto; será necessário editar manualmente o `@Injectable` ou configurar *providers* no `NgModule`.
- **Custom Schematics avançados**: Em arquiteturas DDD ou quando você exige múltiplos artefatos (interfaces, testes mock, registro automático em rotas), considere criar schematics próprios em vez de usar o gerador padrão.

---

## Parte 2: Sintaxe, Argumentos e Opções

### Sintaxe e Uso

```bash
# Gerar um serviço "auth"
ng generate service auth
# Alias curto:
ng g s auth

# Gerar sem criar subpasta (flat) e sem spec file
ng g s services/auth --flat=true --skip-tests=true

```

```
// auth.service.ts (gerado automaticamente)
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root'  // injector raiz
})
export class AuthService {
  constructor() { }
  // métodos de autenticação, chamadas HTTP, etc.
}

```

### Argumentos

| Argumento | Tipo | Descrição |
| --- | --- | --- |
| `name` | string | Nome do serviço. Será usado para gerar `name.service.ts` e `name.service.spec.ts`. ([angular.dev](https://angular.dev/cli/generate/service)) |

### Opções

### 1. Schematic-specific

| Opção | Alias | Tipo | Padrão | Descrição |
| --- | --- | --- | --- | --- |
| `--flat` | — | boolean | `true` | Se `true`, cria os arquivos no nível informado; se `false`, gera uma pasta com o nome do serviço. ([angular.dev](https://angular.dev/cli/generate/service)) |
| `--project` | — | string | (auto) | Nome do projeto no qual o serviço será criado. |
| `--skip-tests` | — | boolean | `false` | Se `true`, não gera o arquivo de teste (`*.service.spec.ts`). ([angular.dev](https://angular.dev/cli/generate/service)) |
| `--type` | — | string | `'service'` | Sufixo customizado para o nome do arquivo (ex.: `auth.manager.ts`). ([angular.dev](https://angular.dev/cli/generate/service)) |

### 2. Globais do Angular CLI

| Opção | Alias | Tipo | Padrão | Descrição |
| --- | --- | --- | --- | --- |
| `--defaults` | — | boolean | `false` | Desativa perguntas interativas para opções com valor padrão. ([angular.dev](https://angular.dev/cli/generate)) |
| `--dry-run` | `-d` | boolean | `false` | Simula a execução e mostra quais arquivos seriam criados, sem gravar alterações. ([angular.dev](https://angular.dev/cli/generate)) |
| `--force` | — | boolean | `false` | Força sobrescrita de arquivos existentes sem perguntar. ([angular.dev](https://angular.dev/cli/generate)) |
| `--help` | — | boolean | — | Exibe ajuda do comando no terminal. ([angular.dev](https://angular.dev/cli/generate)) |
| `--interactive` | — | boolean | `true` | Habilita ou desabilita perguntas interativas. ([angular.dev](https://angular.dev/cli/generate)) |

---

## Parte 3: Melhores Práticas e Exemplos Completos

### Melhores Práticas e Casos de Uso

- **Injeção em componentes**: Sempre declare o serviço no construtor do componente onde ele for usado, aproveitando a DI do Angular.
- **Organização de pastas**: Agrupe serviços por *feature* (ex.: `app/features/auth/auth.service.ts`) para facilitar a navegação.
- **Testes**: Mantenha `-skip-tests=false` para fomentar cobertura de testes unitários.
- **providedIn**: Use `providedIn: 'root'` para serviços globais; para serviços de *lazy-loaded modules*, avalie `providedIn: SomeModule` ou insira em `providers` do módulo.
- **Documentação**: Comente métodos públicos explicando entrada, saída e efeitos colaterais.

---

### Exemplos Completos

### Contexto: Serviço de Autenticação com HttpClient

1. **Gerar service**
    
    ```bash
    ng g s features/auth/auth --flat=false
    
    ```
    
2. **auth.service.ts**
    
    ```
    import { Injectable } from '@angular/core';
    import { HttpClient } from '@angular/common/http';
    import { Observable } from 'rxjs';
    import { User } from '../models/user.model';
    
    @Injectable({
      providedIn: 'root'
    })
    export class AuthService {
      private readonly API = '/api/auth';
    
      constructor(private http: HttpClient) { }
    
      /**
       * Efetua login e retorna o token de acesso.
       * @param credentials Objeto com { email, password }
       */
      login(credentials: { email: string; password: string }): Observable<{ token: string }> {
        return this.http.post<{ token: string }>(`${this.API}/login`, credentials);
      }
    
      /**
       * Busca os dados do usuário logado.
       */
      getProfile(): Observable<User> {
        return this.http.get<User>(`${this.API}/profile`);
      }
    }
    
    ```
    
3. **Uso em componente**
    
    ```
    import { Component, OnInit } from '@angular/core';
    import { AuthService } from './features/auth/auth.service';
    
    @Component({
      selector: 'app-login',
      template: `
        <form (ngSubmit)="onSubmit()">
          <!-- campos de e-mail e senha -->
        </form>
      `
    })
    export class LoginComponent implements OnInit {
      constructor(private auth: AuthService) { }
    
      ngOnInit() { }
    
      onSubmit(): void {
        this.auth.login({ email: 'user@mail.com', password: '1234' })
          .subscribe(response => {
            localStorage.setItem('token', response.token);
          });
      }
    }
    
    ```
    

---

## Tópicos Adicionais

- **Custom Schematics**: Criar geradores personalizados para seu padrão de projeto.
- **Tokens de Injeção**: Uso de `InjectionToken` para valores não-relacionais.
- **Scopes de Provider**: `providedIn: 'any'` e impacto em *lazy loading*.
- **Interceptors**: Encadeamento de chamadas HTTP via serviços.
- **Resolvers e Guards**: Serviços que pré-carregam dados ou protegem rotas.

---

## Sugestões para Aprofundamento

- Padrão **Facade** em Angular: organização de serviços por camada.
- **RXJS** avançado dentro de serviços (subjects, operators, cancelamento).
- Testes unitários de serviços com `HttpTestingController`.
- **Angular Dependency Injection**: hierarquia de *injectors* e *multi-providers*.
- Criação de **bibliotecas** (Angular Libraries) e geração de serviços nelas.

---

Com esta visão detalhada, você está pronto para explorar todas as facetas do comando `ng generate service` e aplicá-lo de forma eficaz em seus projetos Angular!