# ng lint

**Título:Desvendando o `ng lint` no Angular CLI: Guia Completo e Detalhado**

---

## 1. Introdução

O `ng lint` é o comando do Angular CLI responsável por executar a análise estática de código em projetos Angular. Por meio de regras configuráveis, ele identifica inconsistências de estilo, potenciais erros e más práticas antes mesmo da execução da aplicação, garantindo maior qualidade, consistência e manutenibilidade ao longo do desenvolvimento.

---

## 2. Sumário

1. [Conceitos Fundamentais](ng%20lint%2021d9462188c680c4a733d2306009f4b7.md)
2. [Sintaxe e Uso](ng%20lint%2021d9462188c680c4a733d2306009f4b7.md)
3. [Restrições de Uso](ng%20lint%2021d9462188c680c4a733d2306009f4b7.md)
4. [Argumentos](ng%20lint%2021d9462188c680c4a733d2306009f4b7.md)
5. [Opções](ng%20lint%2021d9462188c680c4a733d2306009f4b7.md)
6. [Melhores Práticas e Casos de Uso](ng%20lint%2021d9462188c680c4a733d2306009f4b7.md)
7. [Exemplos Completos](ng%20lint%2021d9462188c680c4a733d2306009f4b7.md)
8. [Tópicos Relacionados](ng%20lint%2021d9462188c680c4a733d2306009f4b7.md)

---

## 3. Conceitos Fundamentais <a name="con-10"></a>

- **Linting / Static Analysis:** Processo de examinar código-fonte sem executá-lo, para detectar erros de sintaxe, violações de padrões de estilo e possíveis bugs antes da compilação/runtime.
- **Histórico no Angular:** Até Angular 10, usava-se TSLint nativamente; após a depreciação do TSLint, recomenda-se ESLint via **@angular-eslint**.
- **Builder do Angular CLI:** No `angular.json`, a seção `projects → <nome> → architect → lint` define o *builder* que `ng lint` invoca (pode ser `@angular-devkit/build-angular:tslint` ou `@angular-eslint/builder:lint`).
- **Propósito:**
    - **Qualidade de código:** Impor padrões e evitar “code smells”.
    - **Padronização:** Mesmo time, mesmo estilo.
    - **Automação:** Correção automática de problemas simples com `-fix`.

---

## 4. Sintaxe e Uso <a name="sintaxe-e-uso"></a>

```bash
# Executa o lint para o projeto padrão configurado
ng lint

# Executa para um projeto específico (ex.: 'app')
ng lint app

# Lint com correção automática de erros corrigíveis
ng lint --fix

# Especificando configuração de ambiente (por exemplo, 'ci')
ng lint --configuration=ci

# Usando formatador de saída diferente (json, stylish, etc.)
ng lint --format=json

```

> Comentários nos exemplos:
> 
> - `ng lint` sem argumentos usa o *project* default do `angular.json`.
> - `-fix` tenta aplicar correções automaticamente em violações simples.
> - `-configuration` referencia configurações definidas em `angular.json` (por exemplo, um arquivo `.eslintrc.ci.json`).
> - `-format` ajusta a apresentação dos relatórios (útil para integração com ferramentas de CI).

---

## 5. Restrições de Uso <a name="restricoes-de-uso"></a>

- **Projetos sem ESLint/TSLint configurados:** Se não houver seção `lint` no `angular.json`, o comando falha.
- **Repositórios monolíticos muito grandes:** Execuções isoladas de lint em cada sub-projeto são mais eficientes.
- **Quando usar outros linters:** Em complementação ao ESLint, pode-se usar Prettier para formatação de estilo; nesse caso, opte por rodar `prettier --check` em vez de `ng lint`.
- **Performance:** Evite `-fix` em pipelines críticos, pois pode alterar muitos arquivos e atrasar o build; prefira rodar `-fix` localmente.

---

## 6. Argumentos <a name="argumentos"></a>

| Argumento | Descrição |
| --- | --- |
| `<project>` | Nome do projeto ou *target* definido em `angular.json`. Se omitido, usa o default. |
| `:<target>` | Ex.: `ng lint my-app:lint` executa o *target* específico em vez do padrão. |

---

## 7. Opções <a name="opcoes"></a>

| Opção | Valor | Descrição |
| --- | --- | --- |
| `--fix` | — | Aplica automaticamente as correções disponíveis nas regras configuradas. |
| `--format` | `stylish` (default) ou `json`, `prose`, `msbuild`… | Define o formatador de saída do relatório. |
| `--force` | — | Continua mesmo se ocorrerem erros; retorna código 0 pós-execução. |
| `--silent` | — | Supressão de logs informativos, exibindo apenas erros. |
| `--type-check` | — | Ativa checagem de tipo do TypeScript antes do lint. |
| `--fix-dry-run` | — | Mostra quais correções seriam aplicadas sem alterar arquivos. |
| `--max-warnings` | `<n>` | Define o número máximo de avisos permitidos antes de falhar com código de erro. |
| `--parallel` | `<n>` ou `true` | Executa lint em múltiplos processos (útil em monorepos). |
| `--watch` | — | Fica rodando em modo observador; reexecuta ao detectar alterações nos arquivos. |
| `--formatters-dir` | `<path>` | Diretório customizado para resolvers de formatadores de saída. |
| `--quiet` | — | Exibe apenas erros (sem avisos). |

---

## 8. Melhores Práticas e Casos de Uso <a name="praticas-e-casos-de-uso"></a>

1. **Integração com CI/CD:**
    - Configure um stage dedicado ao `ng lint --configuration=ci` no pipeline.
    - Use `-max-warnings=0` para garantir zero avisos antes de mesclar PRs.
2. **Pré-commit Hooks (Husky + lint-staged):**
    - Em `lint-staged.config.js`:
        
        ```
        module.exports = {
          '*.ts': ['ng lint --fix', 'git add']
        };
        
        ```
        
    - Garante correção automática local antes de cada commit.
3. **Customização de Regras:**
    - Em `.eslintrc.json`, ajuste severidade e regras específicas do time:
        
        ```json
        {
          "rules": {
            "@typescript-eslint/no-unused-vars": ["error", { "argsIgnorePattern": "^_" }]
          }
        }
        
        ```
        
4. **Monorepos / Nx:**
    - Use `-parallel` para ganhar performance:
        
        ```bash
        ng lint --parallel=4
        
        ```
        
5. **Uso de Fix-dry-run:**
    - Teste correções sem comprometer o repositório:
        
        ```bash
        ng lint --fix --fix-dry-run
        
        ```
        

---

## 9. Exemplos Completos <a name="exemplos-completos"></a>

### 9.1. Configuração no `angular.json`

```
{
  "projects": {
    "minha-app": {
      "architect": {
        "lint": {
          "builder": "@angular-eslint/builder:lint",
          "options": {
            "lintFilePatterns": [
              "src/**/*.ts",
              "src/**/*.html"
            ],
            "format": "stylish"
          }
        }
      }
    }
  }
}

```

### 9.2. Execução no terminal

```bash
# Lint padrão
$ ng lint minha-app
✔ No lint errors found

# Lint com correção automática
$ ng lint minha-app --fix
Fixed 3 errors in 2 files
✔ Lint completed with 0 errors

```

### 9.3. Pipeline de GitLab CI

```yaml
stages:
  - lint
lint_job:
  stage: lint
  script:
    - npm ci
    - ng lint minha-app --configuration=ci --max-warnings=0
  allow_failure: false

```

---

## 10. Tópicos Relacionados para Aprofundamento

- **Integração ESLint + Prettier em Angular**
- **Criação de regras customizadas com @typescript-eslint**
- **Husky e lint-staged para fluxo de commits**
- **Monitoramento de qualidade de código com SonarQube**
- **Performance de lint em monorepos (Nx, Lerna)**

---

*Com esta explicação, você possui um panorama completo sobre o `ng lint` no Angular CLI: desde conceitos teóricos até exemplos práticos de uso e integração em CI/CD. Bons lintings!*