# ng config

Deu certo, Gedê\! Aqui está a explicação detalhada sobre o comando `ng config` do Angular CLI, como você pediu.

---

# Gerenciando a Configuração do seu Projeto Angular com `ng config`

## Introdução

O Angular CLI é uma ferramenta poderosa que simplifica o desenvolvimento de aplicações Angular. Entre seus diversos comandos, o `ng config` desempenha um papel fundamental no gerenciamento da configuração do seu projeto. Ele permite que você visualize, defina e modifique as configurações armazenadas no arquivo `angular.json` de forma programática, garantindo consistência e controle sobre o comportamento do seu aplicativo.

## Sumário

Esta explicação detalhada aborda o comando `ng config` do Angular CLI, cobrindo sua base teórica, sintaxe, argumentos e opções. Serão apresentados exemplos práticos, melhores práticas e casos de uso, além de sugestões de cenários onde o comando deve ser evitado. O objetivo é fornecer um guia completo para que você, Gedê, possa dominar a gestão da configuração do seu projeto Angular.

## Conceitos Fundamentais

O arquivo `angular.json` é o coração da configuração de um projeto Angular. Ele define como o Angular CLI deve construir, testar e servir sua aplicação. Dentro desse arquivo, há uma estrutura JSON que organiza as configurações em diferentes níveis: global, por projeto e por alvo (como `build`, `serve`, `test`).

O comando `ng config` atua como uma interface para interagir com esse arquivo. Ele permite:

- **Visualizar configurações:** Obter o valor de uma propriedade específica ou de um caminho completo dentro do `angular.json`.
- **Definir configurações:** Alterar o valor de uma propriedade existente ou adicionar uma nova.
- **Manipular arrays:** Adicionar ou remover itens de arrays de configuração.

O propósito principal do `ng config` é automatizar e padronizar o gerenciamento da configuração, sendo especialmente útil em scripts de CI/CD ou para garantir que todos os desenvolvedores de uma equipe utilizem as mesmas configurações.

---

## Sintaxe e Uso

A sintaxe básica do comando `ng config` é a seguinte:

```bash
ng config <json-path> [value] [options]

```

- `<json-path>`: Representa o caminho dentro do arquivo `angular.json` para a propriedade que você deseja acessar ou modificar. O caminho é especificado usando a notação de pontos, semelhante a como você acessaria propriedades em um objeto JavaScript (ex: `projects.my-app.architect.build.options.outputPath`).
- `[value]`: É o novo valor que você deseja atribuir à propriedade especificada. Se omitido, o comando exibirá o valor atual da propriedade.
- `[options]`: São opções adicionais que modificam o comportamento do comando.

Vamos ver alguns exemplos práticos:

```bash
# Exemplo 1: Visualizar o outputPath do projeto padrão
# Isso mostrará o diretório de saída para a construção do seu aplicativo.
ng config projects.your-app-name.architect.build.options.outputPath
# Saída esperada: "dist/your-app-name" (ou o que estiver configurado)

# Exemplo 2: Definir um novo outputPath para o projeto padrão
# Altera o diretório de saída para "dist/meu-app-personalizado".
ng config projects.your-app-name.architect.build.options.outputPath "dist/meu-app-personalizado"

# Exemplo 3: Visualizar a versão do schematics global
# Mostra qual schematics está sendo usado para geração de componentes, etc.
ng config cli.defaultCollection

# Exemplo 4: Definir um novo schematics global
# Define "@schematics/angular" como o schematics padrão, caso não esteja.
ng config cli.defaultCollection "@schematics/angular"

# Exemplo 5: Adicionar um item a um array (com --append)
# Adiciona "src/environments/environment.prod.ts" aos arquivos de estilo globais.
# (Note que 'styles' é um array de strings)
ng config projects.your-app-name.architect.build.options.styles "src/environments/environment.prod.ts" --append

# Exemplo 6: Remover um item de um array (com --delete)
# Remove "src/environments/environment.prod.ts" dos arquivos de estilo globais.
ng config projects.your-app-name.architect.build.options.styles "src/environments/environment.prod.ts" --delete

```

**Observação:** Ao usar o `ng config`, você precisará substituir `your-app-name` pelo nome real do seu projeto Angular, conforme definido no seu arquivo `angular.json` dentro da seção `projects`.

---

## Restrições de Uso

Embora o `ng config` seja uma ferramenta poderosa, há cenários onde seu uso pode não ser o ideal ou até mesmo contraproducente:

- **Edição manual para mudanças simples:** Para alterações pontuais e rápidas que você faz com pouca frequência, editar o `angular.json` diretamente em um editor de código é geralmente mais rápido e intuitivo. O `ng config` brilha mais em automação.
- **Estruturas complexas ou grandes edições:** Se você precisa fazer alterações significativas na estrutura do `angular.json`, como adicionar um novo projeto completo ou reestruturar grandes seções, manipular o JSON manualmente é mais seguro e menos propenso a erros. O `ng config` é mais adequado para modificações de valores em chaves existentes ou adição/remoção de itens em arrays.
- **Compreensão da estrutura do `angular.json`:** Se você não tem certeza sobre a estrutura interna do `angular.json` e os caminhos corretos, usar o `ng config` pode levar a erros. Nesses casos, consultar a documentação do Angular ou inspecionar o arquivo manualmente é recomendável.
- **Alterações que afetam múltiplos arquivos:** O `ng config` modifica apenas o `angular.json`. Se sua alteração de configuração requer modificações em outros arquivos do projeto (por exemplo, arquivos de TypeScript, HTML, CSS), o `ng config` por si só não será suficiente.

---

## Argumentos

O comando `ng config` aceita o seguinte argumento posicional:

| Argumento | Descrição | Exemplo |
| --- | --- | --- |
| `json-path` | **Obrigatório**. O caminho da propriedade JSON dentro do arquivo `angular.json` que você deseja ler ou modificar. O caminho é especificado usando a notação de pontos, seguindo a hierarquia do arquivo JSON (ex: `projects.my-app.architect.build.options.assets`). Se o caminho terminar em um índice numérico para um array (ex: `styles.0`), ele acessará aquele elemento específico. | `projects.my-app.architect.build.options.outputPath` \<br\> `schematics.@schematics/angular:component.style` |
| `value` | **Opcional**. O novo valor a ser atribuído à propriedade especificada pelo `json-path`. O tipo do valor deve corresponder ao tipo esperado pela propriedade (string, number, boolean, array, object, etc.). Se o `value` for omitido, o comando `ng config` simplesmente exibirá o valor atual da propriedade no `json-out`. | `"dist/meu-projeto"` \<br\> `true` \<br\> `100` \<br\> `"{ \\"env\\": \\"production\\" }"` (para objetos JSON) |

---

## Opções

As opções do comando `ng config` permitem refinar o comportamento da operação.

| Opção | Alias | Descrição | Tipo | Padrão |
| --- | --- | --- | --- | --- |
| `--global` | `-g` | Aplica a configuração ao arquivo de configuração global do Angular CLI (geralmente `~/.angular-config.json` ou `~/.config/@angular/cli/config.json`) em vez do `angular.json` do projeto atual. Use com cautela, pois isso afeta todos os projetos Angular no seu sistema. | `boolean` | `false` |
| `--json-out` |  | Imprime a saída do comando no formato JSON. Isso é particularmente útil quando você está lendo uma configuração e deseja processar a saída programaticamente em scripts. | `boolean` | `false` |
| `--unquote` |  | Usado em conjunto com `--json-out`. Remove as aspas do valor de saída, útil para obter um valor puro para uso em scripts. Isso só funciona para valores escalares (strings, numbers, booleans). Se o valor for um objeto ou array, ele ainda será impresso como JSON. | `boolean` | `false` |
| `--apply` |  | Usado para aplicar um valor a um array. O valor fornecido é adicionado ao array no `json-path` especificado. Se a propriedade não for um array, o comando falhará. | `boolean` | `false` |
| `--add` |  | **(Obsoleto, use `--apply` ou `--append` ou `--insert`)** - Adiciona um item a um array. O uso de `--append` ou `--insert` é geralmente preferível por serem mais explícitos. | `boolean` | `false` |
| `--append` |  | Adiciona o valor fornecido ao final do array especificado pelo `json-path`. Se a propriedade não for um array, o comando falhará. | `boolean` | `false` |
| `--insert` |  | Insere o valor fornecido no início do array especificado pelo `json-path`. Se a propriedade não for um array, o comando falhará. | `boolean` | `false` |
| `--delete` |  | Remove o valor fornecido do array especificado pelo `json-path`. Se o valor não for encontrado no array, nenhuma ação é realizada. Se a propriedade não for um array, o comando falhará. | `boolean` | `false` |
| `--help` |  | Exibe informações de ajuda para o comando `ng config`. | `boolean` | `false` |

---

## Melhores Práticas e Casos de Uso

- **Automação de Build e Deploy:** Integre `ng config` em seus scripts de CI/CD para ajustar configurações de ambiente (produção, staging) antes de construir ou implantar. Por exemplo, você pode alterar `optimization` ou `sourceMap` para builds de produção.
    
    ```bash
    # Em um pipeline de CI/CD para produção
    ng config projects.my-app.architect.build.options.optimization true
    ng config projects.my-app.architect.build.options.sourceMap false
    ng build --configuration=production
    
    ```
    
- **Gerenciamento de Múltiplos Ambientes:** Se você tem ambientes de desenvolvimento, teste e produção, pode usar `ng config` para alternar rapidamente entre configurações específicas.
- **Padronização de Projetos:** Em equipes grandes, `ng config` pode ser usado em scripts de inicialização de projeto para garantir que as configurações padrão sejam aplicadas a todos os novos projetos, como o prefixo de componente (`prefix`) ou o estilo padrão (`style`).
    
    ```bash
    # Definir o prefixo padrão para novos componentes
    ng config schematics.@schematics/angular:component.prefix "app"
    ng config schematics.@schematics/angular:component.style "scss"
    
    ```
    
- **Configuração de Testes:** Ajuste as configurações de teste para diferentes cenários, como a adição de arquivos de setup de teste ou a mudança do framework de teste.
    
    ```bash
    # Adicionar um arquivo de setup para testes (ex: um mock global)
    ng config projects.my-app.architect.test.options.setupFilesAfterEnv "src/test-setup.ts" --append
    
    ```
    
- **Scripts para Desenvolvedores:** Crie scripts npm personalizados que usam `ng config` para alternar rapidamente entre diferentes configurações sem ter que editar o `angular.json` manualmente.
Então, Gedê pode simplesmente executar `npm run set-dev-output` ou `npm run set-prod-output`.
    
    ```json
    // package.json
    "scripts": {
      "set-dev-output": "ng config projects.my-app.architect.build.options.outputPath 'dist/dev-build'",
      "set-prod-output": "ng config projects.my-app.architect.build.options.outputPath 'dist/prod-build'"
    }
    
    ```
    

---

## Exemplos Completos

Vamos considerar um cenário onde você tem um projeto Angular e quer automatizar a configuração de caminhos de assets e a habilitação/desabilitação de otimizações para diferentes tipos de build.

**Cenário:**

1. Um build de desenvolvimento que usa assets de uma pasta `assets-dev`.
2. Um build de produção que usa assets de uma pasta `assets-prod` e habilita otimização.
3. Um script para alternar rapidamente entre essas configurações.

**Arquivo `angular.json` (antes das modificações):**

```json
{
  "$schema": "./node_modules/@angular/cli/lib/config/schema.json",
  "version": 1,
  "newProjectRoot": "projects",
  "projects": {
    "my-app": {
      "projectType": "application",
      "schematics": {},
      "root": "",
      "sourceRoot": "src",
      "prefix": "app",
      "architect": {
        "build": {
          "builder": "@angular-devkit/build-angular:browser",
          "options": {
            "outputPath": "dist/my-app",
            "index": "src/index.html",
            "main": "src/main.ts",
            "polyfills": [
              "zone.js"
            ],
            "tsConfig": "tsconfig.app.json",
            "assets": [
              "src/favicon.ico",
              "src/assets"
            ],
            "styles": [
              "src/styles.css"
            ],
            "scripts": []
          },
          "configurations": {
            "production": {
              "budgets": [
                {
                  "type": "initial",
                  "maximumWarning": "500kb",
                  "maximumError": "1mb"
                },
                {
                  "type": "anyComponentStyle",
                  "maximumWarning": "2kb",
                  "maximumError": "4kb"
                }
              ],
              "outputHashing": "all"
            },
            "development": {
              "buildOptimizer": false,
              "optimization": false,
              "vendorChunk": true,
              "extractLicenses": false,
              "sourceMap": true,
              "namedChunks": true
            }
          },
          "defaultConfiguration": "production"
        },
        "serve": { /* ... */ },
        "extract-i18n": { /* ... */ },
        "test": { /* ... */ }
      }
    }
  }
}

```

**Scripts no `package.json` para automatizar as configurações:**

```json
{
  "name": "my-app",
  "version": "0.0.0",
  "scripts": {
    "ng": "ng",
    "start": "ng serve",
    "build": "ng build",
    "watch": "ng build --watch --configuration development",
    "test": "ng test",
    "config:set-dev": "ng config projects.my-app.architect.build.options.optimization false && ng config projects.my-app.architect.build.options.assets '[{\\"glob\\": \\"**/*\\", \\"input\\": \\"src/assets-dev\\", \\"output\\": \\"/assets\\"}, \\"src/favicon.ico\\"]'",
    "config:set-prod": "ng config projects.my-app.architect.build.options.optimization true && ng config projects.my-app.architect.build.options.assets '[{\\"glob\\": \\"**/*\\", \\"input\\": \\"src/assets-prod\\", \\"output\\": \\"/assets\\"}, \\"src/favicon.ico\\"]'"
  },
  "private": true,
  "dependencies": { /* ... */ },
  "devDependencies": { /* ... */ }
}

```

**Explicação dos scripts:**

- `config:set-dev`:
    - `ng config projects.my-app.architect.build.options.optimization false`: Desabilita a otimização no build.
    - `ng config projects.my-app.architect.build.options.assets '[{"glob": "**/*", "input": "src/assets-dev", "output": "/assets"}, "src/favicon.ico"]'`: Isso é um pouco mais complexo. Estamos passando uma string JSON que representa um array de objetos de asset.
        - `{"glob": "**/*", "input": "src/assets-dev", "output": "/assets"}`: Configura para copiar todos os arquivos de `src/assets-dev` para o diretório `assets` no output.
        - `"src/favicon.ico"`: Garante que o favicon ainda seja copiado.
- `config:set-prod`:
    - `ng config projects.my-app.architect.build.options.optimization true`: Habilita a otimização no build.
    - `ng config projects.my-app.architect.build.options.assets '[{"glob": "**/*", "input": "src/assets-prod", "output": "/assets"}, "src/favicon.ico"]'`: Altera a origem dos assets para `src/assets-prod`.

**Como usar:**

1. Crie as pastas `src/assets-dev` e `src/assets-prod` com diferentes arquivos dentro.
2. Para configurar o projeto para um build de desenvolvimento:
    
    ```bash
    npm run config:set-dev
    ng build --configuration=development # Ou ng build, se development for o defaultConfiguration
    
    ```
    
3. Para configurar o projeto para um build de produção:
    
    ```bash
    npm run config:set-prod
    ng build --configuration=production # Ou ng build, se production for o defaultConfiguration
    
    ```
    

Este exemplo demonstra como o `ng config` pode ser usado para gerenciar de forma dinâmica configurações complexas como o array de `assets` e valores booleanos como `optimization`, tornando seus processos de build mais flexíveis e automatizados.

---

## Tópicos Relacionados para Aprofundamento

Para você, Gedê, que está buscando um cargo de Backend GO e já tem experiência em Java, entender a fundo as ferramentas de linha de comando é um diferencial. Aqui estão alguns tópicos para continuar seu aprendizado:

- **Estrutura do `angular.json`:** Aprofunde-se na documentação oficial do Angular sobre a estrutura e as propriedades do arquivo `angular.json`. Entender cada seção é crucial para usar `ng config` de forma eficaz.
- **Angular Schematics:** Explore como os Schematics funcionam. Eles são uma ferramenta poderosa para automatizar modificações no seu projeto Angular, desde a geração de componentes até a refatoração de código, e muitas vezes interagem com o `angular.json`.
- **Variáveis de Ambiente no Angular:** Entenda como o Angular lida com variáveis de ambiente e como elas se integram com as configurações do `angular.json` para diferentes builds (desenvolvimento, produção).
- **Custom Builders:** Para cenários mais avançados, você pode criar seus próprios builders personalizados para o Angular CLI. Isso permite estender as capacidades do CLI e integrar ferramentas externas ao processo de build, testes, etc.
- **CI/CD com Angular:** Estude como integrar seus projetos Angular em pipelines de Integração Contínua e Entrega Contínua (CI/CD), utilizando o `ng config` para automação. Ferramentas como Jenkins, GitLab CI/CD, GitHub Actions ou Azure DevOps são excelentes para isso.

Espero que esta explicação detalhada seja muito útil para você e a Ju\! Se tiver mais alguma dúvida, é só chamar a A.R.I.A.\!