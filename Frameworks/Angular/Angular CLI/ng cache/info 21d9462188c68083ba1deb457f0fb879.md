# info

## Título

**Diagnóstico e Estatísticas de Cache com `ng cache info` no Angular CLI**

---

## Introdução

O comando `ng cache info` faz parte do conjunto de subcomandos do Angular CLI que gerencia o cache persistente em disco, armazenando operações como builds e testes para acelerar execuções subsequentes. Ao executar `ng cache info`, você obtém uma visão detalhada da configuração atual do cache — incluindo status, ambiente, caminho de armazenamento e tamanho em disco — permitindo diagnosticar e otimizar o comportamento de cache da sua aplicação. ([angular.dev](https://angular.dev/cli/cache)) ([tutorialspoint.com](https://www.tutorialspoint.com/angular_cli/angular_cli_ng_cache.htm?utm_source=chatgpt.com))

---

## Sumário

1. Conceitos Fundamentais
2. Sintaxe e Uso
3. Restrições de Uso
4. Argumentos
5. Opções
6. Melhores Práticas e Casos de Uso
7. Exemplos Completos
8. Tópicos Adicionais
9. Tópicos Relacionados

---

## 1. Conceitos Fundamentais

- **Cache Persistente:** Área em disco (por padrão `./.angular/cache`) onde o Angular CLI guarda artefatos de operações codificáveis que podem ser reutilizados em builds e testes posteriores, reduzindo significativamente o tempo de execução ([angular.dev](https://angular.dev/cli/cache)).
- **Benefícios do Cache:**
    - Restauração do estado de builds anteriores
    - Reutilização de resultados de compilação e testes
    - Menor tempo de resposta em loops de desenvolvimento e pipelines de CI ([tutorialspoint.com](https://www.tutorialspoint.com/angular_cli/angular_cli_ng_cache.htm?utm_source=chatgpt.com)).
- **Ambientes de Cache:**
    - `local` (padrão): cache ativado apenas em máquinas de desenvolvimento
    - `ci`: cache ativado apenas em sistemas de integração contínua
    - `all`: cache ativado em qualquer ambiente ([angular.dev](https://angular.dev/cli/cache)).

---

## 2. Sintaxe e Uso

```bash
ng cache info

```

- Executa o subcomando `info`, exibindo configuração e estatísticas do cache persistente em disco.
- Pode ser precedido por parâmetros de configuração via `ng config cli.cache` para ajustar ambiente (`environment`), caminho (`path`) e habilitação (`enabled`) antes da inspeção ([angular.dev](https://angular.dev/cli/cache)).

---

## 3. Restrições de Uso

- **Ambiente CI sem cache:** Se `cli.cache.environment` estiver configurado como `local` e a variável de ambiente `CI` estiver definida, o cache não será utilizado, e `ng cache info` mostrará status desabilitado, mesmo que `enabled: true` no `angular.json` ([angular.dev](https://angular.dev/cli/cache)).
- **Sistemas sem persistência de disco:** Em containers efêmeros ou runners que limitem acesso a disco, o cache pode não ser criado ou ser limpo a cada execução, tornando as estatísticas pouco relevantes.
- **Quando não usar:**
    - Para builds que exigem limpeza integral de cada execução (por exemplo, releases onde você sempre quer um build “clean”).
    - Em cenários de build-sharding onde múltiplos processos concorrentes possam corromper o cache.

---

## 4. Argumentos

| Argumento | Descrição |
| --- | --- |
| `<subcomando>` | A ação de cache a ser executada. Para `ng cache info`, o argumento é `info`, que instrui o CLI a imprimir configuração e estatísticas do cache. Pode também ser `clean`, `enable` ou `disable`. ([angular.dev](https://angular.dev/cli/cache)) ([tutorialspoint.com](https://www.tutorialspoint.com/angular_cli/angular_cli_ng_cache.htm?utm_source=chatgpt.com)) |

---

## 5. Opções

| Opção | Tipo | Descrição | Padrão |
| --- | --- | --- | --- |
| `--help` | boolean | Exibe mensagem de ajuda para o comando `ng cache info`. | `false` ([angular.dev](https://angular.dev/cli/cache)) |

> Nota: Outras opções globais do Angular CLI (como --verbose) podem ser usadas, mas não alteram o comportamento específico de ng cache info.
> 

---

## 6. Melhores Práticas e Casos de Uso

- **Verificação em Pipelines CI:** Insira `ng cache info` antes do build para validar se o cache está efetivamente ativado em runners CI — ajudando a diagnosticar ganhos de performance ou falhas de configuração. ([blog.angular.io](https://blog.angular.io/angular-v14-is-now-available-391a6db736af/?utm_source=chatgpt.com))
- **Auditoria de Espaço em Disco:** Em projetos grandes, monitore o `Size on disk` regularmente para evitar que o cache consuma espaço excessivo.
- **Debug de Performance Local:** Ao alterar configurações de cache (por ex., ambiente ou caminho), use `ng cache info` para confirmar impactos na utilização do cache.
- **Integração com Ferramentas de Monitoramento:** Parse o JSON de saída (quando disponível) ou o texto gerado para alimentar dashboards de performance de build.

---

## 7. Exemplos Completos

```bash
# 1. Configurar cache para todos os ambientes
ng config cli.cache.environment all

# 2. Definir caminho customizado para o cache
ng config cli.cache.path ".cache/ng"

# 3. Habilitar cache (equivalente a ng cache enable)
ng cache enable

# 4. Exibir informações detalhadas do cache
ng cache info

```

**Exemplo de saída:**

```
Enabled: yes
Environment: all
Path: /projeto/.cache/ng
Size on disk: 12.3 MB
Effective status on current machine: enabled

```

**Exemplo em CI (GitHub Actions):**

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 18
      - run: npm ci
      - run: ng cache info
      - run: ng build --configuration=production

```

---

## 8. Tópicos Adicionais

- **Cache environments**: como o Angular detecta o valor `CI` para ativar/desativar cache
- **Custom cache path**: vantagens de separar cache em diretórios específicos
- **Análise de corrupção de cache**: identificando e recuperando caches inválidos
- **Integração com ferramentas de análise de build**

---

## 9. Tópicos Relacionados

- `ng cache clean` (limpeza de cache em disco)
- `ng config cli.cache` (configurações avançadas de cache no `angular.json`)
- Cache persistente do Webpack (`-cache`)
- Cache em serviços de CI (e.g., GitLab CI, Jenkins)
- Monitoramento de performance de build no Angular DevKit

---

**Sugestão para aprofundamento:**

- Como usar cache em builds incrementais de bibliotecas
- Estratégias de invalidar cache seletivamente
- Comparativo de cache em diferentes builders (Ivy vs. esbuild)

Espero que esta explicação detalhada ajude você a dominar o uso de `ng cache info` e a otimizar seus processos de desenvolvimento e integração contínua!