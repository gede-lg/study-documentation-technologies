# enable/on

**Título:**

Desvendando o Cache do Angular CLI: Como Habilitar e Gerenciar com `ng cache enable`

---

## Introdução

O Angular CLI oferece, desde a versão 13, um mecanismo de cache em disco que armazena resultados de operações “cacháveis” (como builds, testes e análises), reduzindo significativamente o tempo de execução das tarefas ao reutilizar artefatos previamente gerados ([angular.dev](https://angular.dev/cli/cache?utm_source=chatgpt.com), [balramchavan.medium.com](https://balramchavan.medium.com/angular-cache-whats-inside-and-how-it-improves-angular-build-timing-on-local-and-ci-pipeline-f6821d22d67a?utm_source=chatgpt.com)). O comando `ng cache enable` (`ng cache on`) permite ativar globalmente esse cache em todos os projetos do workspace, enquanto outros subcomandos oferecem controle granular sobre limpeza, desativação e inspeção do cache ([angular.dev](https://angular.dev/cli/cache/enable?utm_source=chatgpt.com)).

---

## Sumário

1. [Conceitos Fundamentais](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#conceitos-fundamentais)
2. [Sintaxe e Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sintaxe-e-uso)
3. [Restrições de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#restricoes-de-uso)
4. [Argumentos (Subcomandos)](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#argumentos-subcomandos)
5. [Opções (Flags)](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#opcoes-flags)
6. [Melhores Práticas e Casos de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#melhores-praticas-e-casos-de-uso)
7. [Exemplos Completos](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#exemplos-completos)
8. [Tópicos Adicionais](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#topicos-adicionais)
9. [Sugestões para Aprofundamento](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sugestoes-para-aprofundamento)

---

## Conceitos Fundamentais

- **Cache em Disco:** Armazena no diretório padrão `.angular/cache` artefatos (hashes, pacotes proces­sados, etc.) para acelerar execuções subsequentes do CLI ([angular.dev](https://angular.dev/cli/cache?utm_source=chatgpt.com)).
- **Ambientes de Cache:** Por padrão, o cache em disco é habilitado apenas em máquinas locais (`local`). Outros valores possíveis são:
    - `all` – permite cache em qualquer ambiente;
    - `ci` – habilita somente em sistemas de Integração Contínua (CI) ([angular.dev](https://angular.dev/cli/cache?utm_source=chatgpt.com)).
- **Relação com `ng config`:** As configurações de cache podem ser ajustadas manualmente no arquivo `angular.json` sob o objeto `cli.cache`, definindo propriedades como `enabled`, `environment` e `path` ([angular.dev](https://angular.dev/cli/cache?utm_source=chatgpt.com)).

---

## Sintaxe e Uso

```bash
# Habilita cache em disco para todos os projetos do workspace
ng cache enable
# ou
ng cache on

# Desabilita cache
ng cache disable
# ou
ng cache off

# Limpa todo o cache persistente em disco
ng cache clean

# Exibe informações de configuração e estatísticas do cache
ng cache info

```

Cada subcomando executa sua ação imediatamente e exibe feedback mínimo no console (salvo em `info`, que detalha status, caminho e tamanho em disco) ([angular.dev](https://angular.dev/cli/cache/enable?utm_source=chatgpt.com)).

---

## Restrições de Uso

- **Desenvolvimento de Bibliotecas Linkadas:** Quando você usa `npm link` ou `yalc` para desenvolver uma biblioteca e a aplica em um app, o cache pode reter versões antigas do código, impedindo que mudanças locais sejam refletidas sem limpeza manual ([stackoverflow.com](https://stackoverflow.com/questions/69953135/clear-angular-cache-in-angular-folder?utm_source=chatgpt.com)).
- **Cenários de Debug:** Em investigações de bugs que exigem recompilação completa a cada alteração, recomenda-se desabilitar o cache (`ng cache off`) para garantir que todos os arquivos sejam reprocessados ([stackoverflow.com](https://stackoverflow.com/questions/69953135/clear-angular-cache-in-angular-folder?utm_source=chatgpt.com)).
- **Espaço em Disco:** Em projetos muito grandes, o cache pode crescer consideravelmente. Utilize `ng cache clean` regularmente em pipelines CI para evitar acúmulo desnecessário.

---

## Argumentos (Subcomandos)

| Subcomando | Descrição |
| --- | --- |
| `enable` / `on` | Habilita o cache em disco para todos os projetos do workspace. |
| `disable` / `off` | Desabilita de forma global o uso de cache em disco. |
| `clean` | Remove todos os arquivos de cache persistente do diretório configurado. |
| `info` | Exibe status (`enabled`/`disabled`), ambiente, caminho e tamanho do cache. |

> Obs.: Estes subcomandos são passados como argumentos ao ng cache e não requerem parâmetros adicionais (angular.dev).
> 

---

## Opções (Flags)

Além dos subcomandos, existe ao menos uma flag dedicada ao grupo `cache`:

| Flag | Tipo | Descrição | Padrão |
| --- | --- | --- | --- |
| `--help` | boolean | Exibe a ajuda/descritivo do comando. | `false` |

> Flags Globais do Angular CLI: Note que flags como --verbose, --configuration e --json também podem ser utilizadas, herdadas do comportamento padrão do CLI.
> 

---

## Melhores Práticas e Casos de Uso

- **Ambientes Locais vs CI:**
    - *Local:* mantenha `environment: local` (padrão) para acelerar iterações diárias.
    - *CI:* defina `environment: all` ou `ci` e limpe (`clean`) no início do pipeline para obter caches “limpos” sem resíduos de execuções locais ([angular.dev](https://angular.dev/cli/cache?utm_source=chatgpt.com)).
- **Configuração em `angular.json`:** Consolidar parâmetros evita a necessidade de re-executar comandos toda vez:
    
    ```
    {
      "cli": {
        "cache": {
          "enabled": true,
          "environment": "all",
          "path": ".angular/cache"
        }
      }
    }
    
    ```
    
- **Automatização:** Incluir `ng cache enable` nos *hooks* de inicialização do projeto (por exemplo, em scripts `postinstall`) garante que colaboradores não precisem executar manualmente.
- **Monitoramento de Uso:** Use `ng cache info` para verificar tamanho e localização, ajustando `path` se for necessário direcionar para um volume maior ou dedicado.

---

## Exemplos Completos

### 1. Configuração em `angular.json`

```
{
  "$schema": "./node_modules/@angular/cli/lib/config/schema.json",
  "version": 1,
  "cli": {
    "cache": {
      "enabled": true,
      "environment": "all",
      "path": ".angular/cache"
    }
  },
  "projects": {
    "app": { /* ... */ }
  }
}

```

### 2. Pipeline de CI (exemplo em YAML)

```yaml
steps:
  - name: Instalar Dependências
    run: npm ci
  - name: Habilitar Cache Angular
    run: ng cache enable
  - name: Limpar Cache Anterior
    run: ng cache clean
  - name: Build de Produção
    run: ng build --configuration production
  - name: Reportar Informações de Cache
    run: ng cache info

```

### 3. Fluxo Rápido em Terminal

```bash
# Ativar cache localmente
ng cache enable

# Verificar status
ng cache info
# Saída esperada:
#   Enabled: yes
#   Environment: local
#   Path: /caminho/para/projeto/.angular/cache
#   Size on disk: 24 MB

# Limpar cache quando desejar forçar rebuild completo
ng cache clean

```

---

## Tópicos Adicionais

- Customização avançada de `cli.cache.path` para monorepos.
- Estratégias de limpeza seletiva de cache.
- Integração com ferramentas externas de caching (e.g., Redis).
- Análise de performance antes e depois do cache: métricas e *benchmarks*.

---

## Sugestões para Aprofundamento

- **ng build --watch e cache:** como o cache interage com o modo *watch*.
- **Cache de testes:** `jest` vs `Karma` e como cachear resultados de testes rápidos.
- **Uso de cache em monorepos Nx:** melhores práticas.
- **Comparativo:** `-cache` (flag de comando) vs `ng cache` (grupo de comandos).
- **Impacto do cache no CI/CD:** estudo de caso em pipelines reais.

---

*Explicação dividida em seções lógicas para facilitar a consulta e permitir aprofundamentos futuros de acordo com seu fluxo de trabalho.*