# disable/off

**Título:**

**Desabilitando o Cache Persistente do Angular CLI com `ng cache disable`**

---

## Introdução

Desde o Angular 13, o Angular CLI introduziu um *cache* persistente em disco para acelerar builds e testes, armazenando operações já realizadas e reutilizando-as em execuções subsequentes. Embora essa funcionalidade melhore significativamente o desempenho, há cenários em que é necessário desativá-la temporariamente — por exemplo, ao desenvolver uma biblioteca vinculada via `npm link`, quando queremos forçar a recompilação completa a cada alteração ([angular.dev](https://angular.dev/cli/cache), [danielbarta.com](https://danielbarta.com/avoid-caching-local-libraries-during-angular-build/?utm_source=chatgpt.com)).

---

## Sumário

1. [Conceitos Fundamentais](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#conceitos-fundamentais)
2. [Sintaxe e Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sintaxe-e-uso)
3. [Restrições de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#restricoes-de-uso)
4. [Argumentos](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#argumentos)
5. [Opções](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#opcoes)
6. [Melhores Práticas e Casos de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#melhores-praticas-e-casos-de-uso)
7. [Exemplos Completos](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#exemplos-completos)
8. [Tópicos Adicionais Interessantes](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#topicos-adicionais-interessantes)
9. [Tópicos Relacionados para Aprofundamento](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#topicos-relacionados-para-aprofundamento)

---

### Conceitos Fundamentais

O comando `ng cache` faz parte do conjunto de ferramentas do Angular CLI para gerenciar o cache em disco. Por padrão, o cache está ativo em ambientes *locais*, armazenando artefatos de build (*webpack*, *babel* etc.) na pasta `.angular/cache` para acelerar execuções posteriores. Desabilitar esse cache interrompe esse armazenamento, forçando o CLI a refazer todas as etapas do build do zero ([angular.dev](https://angular.dev/cli/cache)).

---

### Sintaxe e Uso

- **Comandos:**
    
    ```bash
    ng cache disable
    ng cache off
    
    ```
    
    Ambos desativam o *cache* persistente para todos os projetos no workspace ([angular.dev](https://angular.dev/cli/cache/disable)).
    
- **Alternativa via configuração:**
    
    Você também pode desabilitar editando o `angular.json`:
    
    ```
    {
      "$schema": "./node_modules/@angular/cli/lib/config/schema.json",
      "version": 1,
      "cli": {
        "cache": {
          "enabled": false
        }
      },
      "projects": { ... }
    }
    
    ```
    
    Ou usando o comando:
    
    ```bash
    ng config cli.cache.enabled false
    ``` :contentReference[oaicite:3]{index=3}.
    
    ```
    

---

### Restrições de Uso

- **Performance:** Desabilitar o cache impacta negativamente o tempo de build, já que todo o pipeline é reexecutado do zero ([danielbarta.com](https://danielbarta.com/avoid-caching-local-libraries-during-angular-build/?utm_source=chatgpt.com)).
- **CI e produção:** Em pipelines de integração contínua e ambientes de produção, recomenda-se manter o cache ativo para reduzir tempo de build e uso de recursos.
- **Casos de debugging especializados:** Use `ng cache disable` apenas quando precisar garantir recompilações completas, como no desenvolvimento de bibliotecas vinculadas.

---

### Argumentos

O comando `ng cache disable` **não** aceita argumentos posicionais adicionais. Basta invocá-lo conforme mostrado em [Sintaxe e Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sintaxe-e-uso).

---

### Opções

| Opção | Descrição | Tipo | Padrão |
| --- | --- | --- | --- |
| `--help`, `-h` | Exibe mensagem de ajuda para o comando | boolean | false |

> Além dessa opção específica, qualquer comando Angular CLI suporta as opções globais documentadas no CLI Reference (por exemplo, --verbose, --dry-run, --configuration etc.) (angular.dev).
> 

---

### Melhores Práticas e Casos de Uso

- **Desenvolvimento de bibliotecas:** Ao usar `npm link` para depurar bibliotecas locais, desative o cache para ver imediatamente as alterações de código.
- **Testes específicos:** Em testes onde o estado anterior pode interferir nos resultados, use `ng cache disable` para garantir builds limpos.
- **Reativar após uso:** Não esqueça de reativar o cache com `ng cache enable` assim que concluir o debugging, para retomar os ganhos de performance.

---

### Exemplos Completos

1. **Desativar cache na linha de comando**
    
    ```bash
    # Desativa o cache persistente
    ng cache disable
    
    # Exemplo de build forçado
    ng build --prod
    
    ```
    
2. **Configuração no angular.json**
    
    ```
    {
      "$schema": "./node_modules/@angular/cli/lib/config/schema.json",
      "version": 1,
      "cli": {
        "cache": {
          "enabled": false,
          "environment": "all",
          "path": ".cache/ng"
        }
      },
      "projects": { ... }
    }
    
    ```
    
    ```bash
    # Atualiza via comando
    ng config cli.cache.enabled false
    
    ```
    
3. **Reativar o cache**
    
    ```bash
    ng cache enable
    ng cache on
    
    ```
    

---

### Tópicos Adicionais Interessantes

- **`ng cache clean`**: Remove o diretório de cache em disco.
- **`ng cache info`**: Mostra estatísticas e configuração do cache.
- **Configuração de `cli.cache.environment`**: Controla em quais ambientes o cache é ativado (`local`, `ci`, `all`).
- **Configuração de `cli.cache.path`**: Altera o diretório base do cache (padrão `.angular/cache`).
- **Integração com prebundle (Vite)**: Ajuste de pré-bundling para evitar cache excessivo em desenvolvimento de bibliotecas.

---

### Tópicos Relacionados para Aprofundamento

- **Otimização de builds no Angular**
- **Angular CLI: flags globais e personalização**
- **Configurações avançadas do `angular.json`**
- **Debugging de bibliotecas locais com `npm link`**
- **Ferramentas de profiling de build (webpack, Vite)**