# ng update

**Título:** Atualizando Aplicações Angular com `ng update`

---

## 1. Introdução

O comando `ng update` do Angular CLI automatiza a atualização de dependências Angular (core, CLI e pacotes relacionados), aplicando também migrações definidas pelos esquemas (schematics) de cada versão. Ele facilita a adoção de novas versões, garantindo que mudanças de API e configurações sejam aplicadas de forma incremental e controlada. ([angular.dev](https://angular.dev/cli/update))

---

## 2. Sumário

1. [Conceitos Fundamentais](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#conhecimentos-fundamentais)
2. [Sintaxe e Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#sintaxe-e-uso)
3. [Restrições de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#restricoes-de-uso)
4. [Argumentos](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#argumentos)
5. [Opções](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#opcoes)
6. [Melhores Práticas e Casos de Uso](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#melhores-praticas-e-casos-de-uso)
7. [Exemplos Completos](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#exemplos-completos)
8. [Tópicos Adicionais](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#topicos-adicionais)
9. [Tópicos Relacionados para Aprofundamento](https://chatgpt.com/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#topicos-relacionados-para-aprofundamento)

---

## 3. Conceitos Fundamentais

- **Objetivo:** Atualizar de forma segura e automatizada as versões de pacotes Angular instalados em um workspace, alinhando-os à versão estável ou a versões pré-lançamento (beta/RC). ([angular.dev](https://angular.dev/cli/update))
- **Migrações (Schematics):** Além de atualizar o `package.json`, o CLI executa scripts de migração que ajustam código e configurações (`tsconfig.json`, `angular.json`), prevenindo erros de incompatibilidade. ([angular.dev](https://angular.dev/cli/update))
- **Escopo:** Focado em pacotes com namespace `@angular/*`, mas extensível a bibliotecas de terceiros que forneçam esquemas de migração compatíveis. ([angular.dev](https://angular.dev/cli/update))

---

## 4. Sintaxe e Uso

```bash
ng update [pacotes..] [opções]

```

- **Chamada básica:**
    
    ```bash
    ng update
    
    ```
    
    Lista atualizações disponíveis e sugere comandos. ([angular.dev](https://angular.dev/cli/update))
    
- **Atualizar core e CLI para a versão estável mais recente:**
    
    ```bash
    ng update @angular/cli @angular/core
    
    ```
    
- **Atualizar para um major específico (por ex., 10.x.x):**
    
    ```bash
    ng update @angular/cli@^10 @angular/core@^10
    
    ```
    
- **Pré-lançamentos (beta/RC):**
    
    ```bash
    ng update --next
    ``` :contentReference[oaicite:5]{index=5}
    
    ```
    

---

## 5. Restrições de Uso

- **Repositório “sujo” sem `-allow-dirty`:** por padrão, `ng update` falha se houver alterações não commitadas.
- **Múltiplos pacotes sem suporte a migrações:** bibliotecas sem esquemas de migração não recebem transformações automáticas.
- **Atualizações drásticas de versão (>2 majors):** recomenda-se atualizar incrementalmente (major a major).
- **Projetos não Angular / sem `angular.json`:** o comando não se aplica fora de workspaces gerados pelo Angular CLI.

---

## 6. Argumentos

| Argumento | Descrição | Tipo | Padrão |
| --- | --- | --- | --- |
| `packages` | Nome(s) do(s) pacote(s) a atualizar | `array` | — |

> Define quais pacotes serão atualizados; ao omitir, mostra apenas sugestões de updates. (angular.dev)
> 

---

## 7. Opções

Segundo a documentação oficial, as opções disponíveis são as seguintes:

- `-allow-dirty`
    - **Descrição:** Permite rodar mesmo com arquivos modificados ou não versionados.
    - **Tipo:** `boolean`
    - **Padrão:** `false`
- `-create-commits` (alias `C`)
    - **Descrição:** Cria commits no Git para cada atualização e migração.
    - **Tipo:** `boolean`
    - **Padrão:** `false`
- `-force`
    - **Descrição:** Ignora erros de dependências peer incompatíveis.
    - **Tipo:** `boolean`
    - **Padrão:** `false`
- `-from`
    - **Descrição:** Versão de origem para migração (somente em modo `-migrate-only` e pacote único).
    - **Tipo:** `string`
- `-help`
    - **Descrição:** Exibe ajuda do comando.
    - **Tipo:** `boolean`
- `-migrate-only`
    - **Descrição:** Executa apenas migrações, sem alterar versões instaladas.
    - **Tipo:** `boolean`
- `-name`
    - **Descrição:** Nome específico da migração a executar (pacote único).
    - **Tipo:** `string`
- `-next`
    - **Descrição:** Usa versões pré-lançamento (beta/RC).
    - **Tipo:** `boolean`
    - **Padrão:** `false`
- `-to`
    - **Descrição:** Versão alvo até a qual aplicar migrações (requer `-from`).
    - **Tipo:** `string`
- `-verbose`
    - **Descrição:** Exibe detalhes internos do processo.
    - **Tipo:** `boolean`
    - **Padrão:** `false`

> (angular.dev)
> 

---

## 8. Melhores Práticas e Casos de Uso

- **Backup e Controle de Versão:** Certifique-se de commit — ou ter um branch separado — antes de rodar atualizações.
- **Atualizações Incrementais:** Suba um major de cada vez (ex.: 10→11, depois 11→12) para facilitar diagnóstico de regressões.
- **Testes Automatizados:** Execute suite de testes (unitários/E2E) após cada update para verificar impactos.
- **Uso de `-create-commits`:** Ideal para equipes, pois cria checkpoints no Git para cada migração.
- **Revisão Manual de Migrations:** Algumas migrações podem exigir ajustes manuais em templates, imports ou configurações.
- **Ambientes Isolados:** Em pipelines CI, crie artefatos de build antes e depois do update para comparação.

---

## 9. Exemplos Completos

```bash
# 1. Iniciar um projeto de exemplo
ng new projeto-exemplo --routing --style=scss

# 2. Adicionar dependência fictícia
npm install ngx-exemplo@1.2.3 --save

# 3. Atualizar core, CLI e rodar migrações
ng update @angular/cli @angular/core --create-commits

# 4. Atualizar para próxima versão beta
ng update --next --allow-dirty

# 5. Executar apenas migração de um pacote específico
ng update @angular/material --migrate-only --from=12.0.0 --to=13.0.0

# 6. Atualizar todas as dependências Angular disponíveis
# (não há --all em v20; use lista explícita ou ferramentas externas)
ng update @angular/cli @angular/core @angular/material

```

Em um contexto de CI/CD (GitHub Actions, GitLab CI), você pode encadear:

```yaml
steps:
  - uses: actions/checkout@v3
  - name: Instalar dependências
    run: npm ci
  - name: Atualizar Angular
    run: ng update @angular/cli @angular/core --force --verbose
  - name: Testar
    run: npm test

```

---

## 10. Tópicos Adicionais

- Integração com o [Angular Update Guide Interativo](https://update.angular.dev/)
- Atualização de bibliotecas de terceiros com migrações customizadas
- Estratégias de rollback em caso de falha de atualização
- Monitoramento de dependências e alertas de versão

---

## 11. Tópicos Relacionados para Aprofundamento

- **Angular Schematics e Migrations:** como criar seus próprios esquemas de migração.
- **Versionamento Semântico (SemVer) em Angular:** entendimento de major, minor e patch.
- **Configuração Avançada do Angular CLI (`angular.json`).**
- **Automação de Pipelines CI/CD para Angular.**

---

Espero que esta explicação, organizada em seções lógicas e enriquecida com exemplos práticos, ajude a dominar totalmente o uso do `ng update` no Angular CLI. Se houver mais dúvidas ou necessidade de aprofundamento em algum ponto específico, é só dizer!