# ng-template

E a√≠, Ged√™\! Beleza?
Com certeza\! Como A.R.I.A, vou te ajudar a desmistificar o `ng-template` no Angular. Voc√™, como desenvolvedor Backend Java buscando uma transi√ß√£o para Go, vai ver como essa diretiva √© fundamental para criar interfaces din√¢micas e flex√≠veis no frontend, algo que com certeza te ajudar√° a ter um entendimento mais profundo do funcionamento de aplica√ß√µes web modernas.

---

## Introdu√ß√£o ao `ng-template`

O Angular √© uma ferramenta poderosa para construir aplica√ß√µes web din√¢micas e interativas. No cora√ß√£o dessa capacidade est√° a renderiza√ß√£o condicional e estrutural de elementos, e √© aqui que o `ng-template` brilha.

O `ng-template` √© uma **diretiva estrutural** do Angular que atua como um cont√™iner para conte√∫do que **n√£o ser√° renderizado diretamente** na DOM (Document Object Model) at√© que seja explicitamente instru√≠do a faz√™-lo. Em outras palavras, ele permite que voc√™ defina um bloco de HTML que pode ser reutilizado, exibido ou ocultado com base em certas condi√ß√µes ou l√≥gica, sem adicionar elementos extras ao seu HTML final. Sua relev√¢ncia reside na otimiza√ß√£o da performance, na reusabilidade de c√≥digo e na flexibilidade para lidar com cen√°rios de UI complexos.

### O que √© `ng-template` e para que serve?

O `ng-template` √© uma tag especial do Angular que serve como um "molde" para elementos HTML. Ele √© um elemento que **n√£o √© renderizado por padr√£o** na √°rvore DOM. Pense nele como uma "receita" de HTML que o Angular s√≥ vai "cozinhar" e exibir quando e onde for necess√°rio. Isso √© crucial para:

- **Renderiza√ß√£o condicional:** Usar com diretivas como `ngIf` e `ngFor` para definir o que deve ser renderizado quando uma condi√ß√£o √© verdadeira ou falsa, ou para criar blocos de template que s√£o inseridos dinamicamente.
- **Reuso de templates:** Definir um peda√ßo de UI uma vez e reutiliz√°-lo em v√°rios lugares, evitando duplica√ß√£o de c√≥digo.
- **Melhorar a performance:** Conte√∫do dentro do `ng-template` s√≥ √© renderizado quando necess√°rio, o que pode otimizar a performance da aplica√ß√£o, especialmente em cen√°rios com muitos elementos ou l√≥gica complexa de exibi√ß√£o.

---

## Sum√°rio

Esta explica√ß√£o detalhada abordar√° os seguintes t√≥picos sobre `ng-template`:

- Sintaxe e Estrutura do `ng-template`
- Componentes Principais e Associados
- Restri√ß√µes de Uso do `ng-template`
- Exemplos de C√≥digo Otimizados
- Informa√ß√µes Adicionais
- Refer√™ncias para Estudo Independente

---

## Conte√∫do Detalhado

### Sintaxe e Estrutura

A sintaxe b√°sica do `ng-template` √© bastante simples:

```html
<ng-template>
  <p>Este conte√∫do s√≥ ser√° renderizado sob demanda.</p>
</ng-template>

```

Como mencionado, o conte√∫do dentro de `ng-template` n√£o √© renderizado por padr√£o. Para que ele seja renderizado, voc√™ precisa usar outras diretivas ou APIs do Angular.

### Componentes Principais e Associados

O `ng-template` raramente √© usado sozinho. Ele geralmente √© combinado com outras diretivas estruturais ou com a API `ViewContainerRef` e `TemplateRef`.

- **`ngIf` (e `else`):**
    - O `ngIf` √© a forma abreviada de `ngIf` (diretiva estrutural). Quando voc√™ usa `ngIf`, o Angular internamente o reescreve para usar `<ng-template>`.
    - O `ngIf` remove ou recria elementos no DOM com base em uma condi√ß√£o. Ele pode ser combinado com um `else` para exibir um `ng-template` alternativo.
    
    <!-- end list -->
    
    ```tsx
    import { Component } from '@angular/core';
    
    @Component({
      selector: 'app-condicional',
      template: `
        <button (click)="toggleExibir()">Alternar Exibi√ß√£o</button>
    
        <p *ngIf="exibir; else outroConteudo">
          Este par√°grafo √© exibido se 'exibir' for verdadeiro.
        </p>
    
        <ng-template #outroConteudo>
          <p>Este √© o conte√∫do do 'else', exibido se 'exibir' for falso.</p>
        </ng-template>
    
        <hr>
    
        <div *ngIf="condicaoComplexa; then blocoVerdadeiro; else blocoFalso"></div>
    
        <ng-template #blocoVerdadeiro>
          <p>Conte√∫do complexo do bloco verdadeiro.</p>
        </ng-template>
    
        <ng-template #blocoFalso>
          <p>Conte√∫do complexo do bloco falso.</p>
        </ng-template>
      `
    })
    export class CondicionalComponent {
      exibir = true;
      condicaoComplexa = false;
    
      toggleExibir() {
        this.exibir = !this.exibir;
      }
    }
    
    ```
    
- **`ngFor` (e `empty`):**
    - Similar ao `ngIf`, o `ngFor` tamb√©m usa `ng-template` internamente para iterar sobre cole√ß√µes e renderizar elementos para cada item. Embora menos comum, √© poss√≠vel usar `ng-template` com `ngFor` para casos mais avan√ßados, como templates vazios ou customiza√ß√£o da renderiza√ß√£o.
    - No Angular 12+, o `ngFor` ganhou a sintaxe de `empty` para definir um template quando a lista est√° vazia, o que internamente usa `ng-template`.
    
    <!-- end list -->
    
    ```tsx
    import { Component } from '@angular/core';
    
    @Component({
      selector: 'app-lista',
      template: `
        <h2>Minha Lista de Itens</h2>
        <button (click)="adicionarItem()">Adicionar Item</button>
        <button (click)="limparLista()">Limpar Lista</button>
    
        <ul *ngFor="let item of itens; empty vazio">
          <li>{{ item }}</li>
        </ul>
    
        <ng-template #vazio>
          <p>A lista est√° vazia. Adicione alguns itens!</p>
        </ng-template>
      `
    })
    export class ListaComponent {
      itens: string[] = ['Ma√ß√£', 'Banana', 'Cereja'];
    
      adicionarItem() {
        this.itens.push(`Item ${this.itens.length + 1}`);
      }
    
      limparLista() {
        this.itens = [];
      }
    }
    
    ```
    
- **`ViewContainerRef` e `TemplateRef`:**
    - Essas classes s√£o fundamentais para a cria√ß√£o din√¢mica de visualiza√ß√µes (views) no Angular.
    - **`TemplateRef`**: Representa um `<ng-template>` no c√≥digo TypeScript. Permite que voc√™ acesse uma refer√™ncia ao template e instancie uma visualiza√ß√£o a partir dele.
    - **`ViewContainerRef`**: Representa um cont√™iner onde uma ou mais visualiza√ß√µes podem ser anexadas. Ele pode ser obtido em um elemento HTML ou componente para inserir dinamicamente templates ou componentes.
    
    <!-- end list -->
    
    ```tsx
    import { Component, ViewChild, TemplateRef, ViewContainerRef, AfterViewInit } from '@angular/core';
    
    @Component({
      selector: 'app-dynamic-template',
      template: `
        <h2>Exemplo de Template Din√¢mico</h2>
        <button (click)="criarTemplate()">Criar Template Din√¢mico</button>
        <button (click)="limparTemplates()">Limpar Templates</button>
    
        <div #container></div>
    
        <ng-template #meuTemplate let-nome="nome" let-idade="idade">
          <p>Ol√°, {{ nome }}! Voc√™ tem {{ idade }} anos.</p>
        </ng-template>
      `
    })
    export class DynamicTemplateComponent implements AfterViewInit {
      @ViewChild('meuTemplate', { static: true }) meuTemplateRef!: TemplateRef<any>;
      @ViewChild('container', { read: ViewContainerRef, static: true }) viewContainerRef!: ViewContainerRef;
    
      ngAfterViewInit() {
        // Opcional: Criar o template logo ap√≥s a inicializa√ß√£o
        // this.criarTemplate();
      }
    
      criarTemplate() {
        // Limpa o container antes de adicionar um novo template (opcional)
        // this.viewContainerRef.clear();
    
        // Cria uma visualiza√ß√£o a partir do template e a insere no container
        // O contexto √© passado para as vari√°veis locais do template (let-nome, let-idade)
        this.viewContainerRef.createEmbeddedView(this.meuTemplateRef, { nome: 'Ged√™', idade: 23 });
        this.viewContainerRef.createEmbeddedView(this.meuTemplateRef, { nome: 'Ju', idade: 24 });
      }
    
      limparTemplates() {
        this.viewContainerRef.clear(); // Remove todas as visualiza√ß√µes do container
      }
    }
    
    ```
    

### Restri√ß√µes de Uso

- **N√£o √© um elemento DOM:** O `ng-template` por si s√≥ n√£o adiciona um n√≥ ao DOM. Ele √© um elemento que o Angular "entende" e usa para criar outros elementos. Isso significa que voc√™ n√£o pode aplicar estilos CSS diretamente a um `ng-template` da mesma forma que faria com um `div` ou `p`.
- **N√£o suporta atributos diretamente:** Atributos aplicados diretamente ao `ng-template` (exceto `#templateRefName`) n√£o ter√£o efeito no HTML renderizado, pois o `ng-template` n√£o √© um elemento renderiz√°vel. Os atributos devem ser aplicados aos elementos *dentro* do `ng-template`.

---

## Exemplos de C√≥digo Otimizados

### Caso de Uso: Renderiza√ß√£o Condicional com Mensagens Diferentes

Imagine um componente que exibe o status de um pedido. Queremos mostrar uma mensagem diferente dependendo se o pedido est√° "pendente", "conclu√≠do" ou "cancelado".

```tsx
import { Component } from '@angular/core';

@Component({
  selector: 'app-order-status',
  template: `
    <h2>Status do Pedido: {{ currentStatus }}</h2>

    <div [ngSwitch]="currentStatus">
      <ng-template [ngSwitchCase]="'pendente'">
        <p class="status-pending">Seu pedido est√° aguardando processamento.</p>
        <button (click)="changeStatus('concluido')">Marcar como Conclu√≠do</button>
      </ng-template>

      <ng-template [ngSwitchCase]="'concluido'">
        <p class="status-completed">Seu pedido foi conclu√≠do com sucesso!</p>
        <button (click)="changeStatus('cancelado')">Marcar como Cancelado</button>
      </ng-template>

      <ng-template [ngSwitchCase]="'cancelado'">
        <p class="status-cancelled">Seu pedido foi cancelado.</p>
        <button (click)="changeStatus('pendente')">Reativar Pedido</button>
      </ng-template>

      <ng-template ngSwitchDefault>
        <p class="status-unknown">Status desconhecido.</p>
      </ng-template>
    </div>

    <hr>
    <h3>Exemplo com *ngIf...else (Mais Comum)</h3>
    <button (click)="toggleLogin()">Alternar Login</button>

    <div *ngIf="isLoggedIn; else logoutButton">
      <p>Bem-vindo, Ged√™! Voc√™ est√° logado.</p>
    </div>

    <ng-template #logoutButton>
      <p>Voc√™ n√£o est√° logado.</p>
      <button>Fazer Login</button>
    </ng-template>
  `,
  styles: `
    .status-pending { color: orange; }
    .status-completed { color: green; }
    .status-cancelled { color: red; }
    .status-unknown { color: gray; }
  `
})
export class OrderStatusComponent {
  currentStatus: 'pendente' | 'concluido' | 'cancelado' = 'pendente';
  isLoggedIn: boolean = true;

  changeStatus(status: 'pendente' | 'concluido' | 'cancelado') {
    this.currentStatus = status;
  }

  toggleLogin() {
    this.isLoggedIn = !this.isLoggedIn;
  }
}

```

Neste exemplo, usamos `ngSwitchCase` com `ng-template` para controlar qual bloco de conte√∫do √© exibido. Isso mant√©m o template limpo e organizado, especialmente √∫til quando h√° muitos estados. O exemplo de `*ngIf...else` mostra a forma mais comum de usar `ng-template` de forma impl√≠cita.

### Caso de Uso: Reuso de Template para Cards de Produto

Imagine que voc√™ tem uma lista de produtos e quer exibir cada um em um card com um layout similar, mas com pequenas varia√ß√µes.

```tsx
import { Component, Input, OnInit } from '@angular/core';

// Componente para o template do card
@Component({
  selector: 'app-product-card',
  template: `
    <ng-template #defaultCard let-product="product">
      <div class="product-card">
        <h3>{{ product.name }}</h3>
        <p>Pre√ßo: R$ {{ product.price | number:'1.2-2' }}</p>
        <p *ngIf="product.description">{{ product.description }}</p>
        <button (click)="addToCart(product)">Adicionar ao Carrinho</button>
      </div>
    </ng-template>

    <ng-template #specialOfferCard let-product="product">
      <div class="product-card special-offer">
        <h3>üéâ OFERTA ESPECIAL: {{ product.name }} üéâ</h3>
        <p>De: <span class="old-price">R$ {{ product.originalPrice | number:'1.2-2' }}</span> Por: <span class="new-price">R$ {{ product.price | number:'1.2-2' }}</span></p>
        <button (click)="buyNow(product)">Comprar Agora!</button>
      </div>
    </ng-template>

    <ng-container *ngTemplateOutlet="product.isSpecialOffer ? specialOfferCard : defaultCard; context: { product: product }"></ng-container>
  `,
  styles: [`
    .product-card {
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
    }
    .special-offer {
      border-color: gold;
      background-color: #fffacd;
    }
    .old-price {
      text-decoration: line-through;
      color: #888;
    }
    .new-price {
      color: green;
      font-weight: bold;
    }
  `]
})
export class ProductCardComponent {
  @Input() product: any;

  addToCart(product: any) {
    alert(`Adicionado ${product.name} ao carrinho!`);
  }

  buyNow(product: any) {
    alert(`Comprando agora: ${product.name}!`);
  }
}

// Componente pai que usa o ProductCard
@Component({
  selector: 'app-product-list',
  template: `
    <h2>Nossos Produtos</h2>
    <app-product-card *ngFor="let prod of products" [product]="prod"></app-product-card>
  `
})
export class ProductListComponent implements OnInit {
  products = [
    { id: 1, name: 'Smart TV 4K', price: 2500.00, description: 'Tela LED de 50 polegadas.' },
    { id: 2, name: 'Smartphone Pro X', price: 1800.00, isSpecialOffer: true, originalPrice: 2200.00 },
    { id: 3, name: 'Fone de Ouvido Bluetooth', price: 350.00, description: 'Cancelamento de ru√≠do.' },
    { id: 4, name: 'Notebook Gamer', price: 5000.00, isSpecialOffer: true, originalPrice: 6000.00 }
  ];

  ngOnInit(): void {
    // Para fins de demonstra√ß√£o, podemos adicionar mais l√≥gica aqui se necess√°rio
  }
}

```

Neste exemplo, o `ProductCardComponent` define dois `ng-template`s diferentes: um para o card padr√£o e outro para ofertas especiais. Usamos `*ngTemplateOutlet` para escolher qual template renderizar com base na propriedade `isSpecialOffer` do produto, passando o objeto `product` como contexto. Isso demonstra um poderoso padr√£o de reusabilidade e flexibilidade.

---

## Informa√ß√µes Adicionais

- **`ng-container` vs `ng-template`:**
    - `ng-container` √© uma diretiva do Angular que serve como um agrupador l√≥gico de elementos. Ao contr√°rio de `ng-template`, `ng-container` **n√£o √© removida do DOM** ap√≥s o Angular process√°-la, mas **n√£o adiciona um novo n√≥ ao DOM**. √â √∫til quando voc√™ precisa agrupar elementos para aplicar uma diretiva estrutural (como `ngIf` ou `ngFor`) sem introduzir um elemento extra no DOM (como uma `div`).
    - **Resumindo:** `ng-template` √© para definir **blocos de HTML que ser√£o instanciados posteriormente**, enquanto `ng-container` √© para **agrupar elementos sem adicionar n√≥s extras no DOM**.
    
    <!-- end list -->
    
    ```html
    <ng-container *ngIf="showDetails">
      <p>Detalhes do usu√°rio:</p>
      <span>Nome: Ged√™</span>
      <span>Idade: 23</span>
    </ng-container>
    
    <div *ngIf="showDetails">
      <p>Detalhes do usu√°rio:</p>
      <span>Nome: Ged√™</span>
      <span>Idade: 23</span>
    </div>
    
    ```
    
- **Renderiza√ß√£o Otimizada:** O uso de `ng-template` para conte√∫do condicional ou din√¢mico pode levar a uma renderiza√ß√£o mais eficiente. Ao inv√©s de criar e remover elementos do DOM, o Angular simplesmente n√£o cria os elementos at√© que o `ng-template` seja instanciado, economizando recursos e tempo de processamento do navegador.
- **Templates Locais (`#nomeDoTemplate`):** O uso do hash (`#`) para nomear um `ng-template` (e outros elementos) cria uma vari√°vel de template local que pode ser referenciada por outras partes do template ou pelo componente via `@ViewChild`.

---

## Refer√™ncias para Estudo Independente

Para se aprofundar ainda mais no `ng-template` e outras diretivas estruturais do Angular, recomendo os seguintes recursos:

- **Documenta√ß√£o Oficial do Angular - Structural Directives:**
    - [Angular.io - Structural Directives](https://angular.io/guide/structural-directives) (√â o ponto de partida mais confi√°vel e completo).
- **Documenta√ß√£o Oficial do Angular - `ngTemplateOutlet`:**
    - [Angular.io - `ngTemplateOutlet`](https://www.google.com/search?q=%5Bhttps://angular.io/api/common/NgTemplateOutlet%5D%5C(https://angular.io/api/common/NgTemplateOutlet%5C)) (Detalha o uso dessa diretiva importante).
- **Artigos e Tutoriais:**
    - "Understanding ng-template, ng-container and ngTemplateOutlet in Angular" - Artigo no Medium ou blog do Netanel Basal (procure por artigos recentes, pois as APIs podem evoluir).
    - Canais no YouTube como o "Academind" ou "Loiane Groner" frequentemente t√™m v√≠deos explicando esses conceitos de forma pr√°tica.

Espero que esta explica√ß√£o detalhada ajude voc√™, Ged√™, a entender melhor o poder do `ng-template` no Angular\! Se tiver mais alguma d√∫vida, A.R.I.A est√° aqui para ajudar\!