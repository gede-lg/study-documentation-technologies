# Introdução

**1. Introdução**

As **diretivas** em Angular são mecanismos que permitem estender o comportamento de elementos no DOM sem criar componentes adicionais. Elas atuam como “anotações” que informam ao framework como processar, manipular ou estruturar partes da interface.

- **Relevância:**
    - Promovem reutilização de lógica na camada de apresentação.
    - Facilitam abstração de comportamentos DOM (animações, formatações, validações).
    - Permitem criar APIs declarativas, mantendo templates limpos e sem lógica imperativa.
- **Definições fundamentais:**
    - **Tema Principal:** o conceito de Diretivas como um todo em Angular.
    - **Subtemas:** podem incluir:
        1. **Tipos de Diretivas** (estruturais, atributos, componentes).
        2. **API e ciclo de vida** (decorator, hooks, injeção de dependência).
        3. **Boas práticas e restrições.**
    - **Para que servem:** encapsular comportamento de baixo nível no DOM e permitir que templates permaneçam simples e declarativos.

---

**2. Sumário**

1. [Introdução](https://chatgpt.com/g/g-p-67fc74e4e4b0819191996b70ff86754a-angular/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#1-introdu%C3%A7%C3%A3o)
2. [Tipos de Diretivas](https://chatgpt.com/g/g-p-67fc74e4e4b0819191996b70ff86754a-angular/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#2-tipos-de-diretivas)
3. [API e Ciclo de Vida](https://chatgpt.com/g/g-p-67fc74e4e4b0819191996b70ff86754a-angular/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#3-api-e-ciclo-de-vida)
4. [Restrições de Uso](https://chatgpt.com/g/g-p-67fc74e4e4b0819191996b70ff86754a-angular/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#4-restri%C3%A7%C3%B5es-de-uso)
5. [Exemplos de Código Otimizados](https://chatgpt.com/g/g-p-67fc74e4e4b0819191996b70ff86754a-angular/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#5-exemplos-de-c%C3%B3digo-otimizados)
6. [Informações Adicionais](https://chatgpt.com/g/g-p-67fc74e4e4b0819191996b70ff86754a-angular/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#6-informa%C3%A7%C3%B5es-adicionais)
7. [Referências para Estudo Independente](https://chatgpt.com/g/g-p-67fc74e4e4b0819191996b70ff86754a-angular/c/685bd1e4-9d88-8013-9f64-1ff6bede9ffc#7-refer%C3%AAncias-para-estudo-independente)

---

## 3. Conteúdo Detalhado

### 3.1 Tipos de Diretivas

- **Diretivas de Componente**
    - Equivalem a componentes (decorator `@Component`), com template próprio.
    - **Diretivas Estruturais**
    - Alteram a estrutura do DOM (inserem, removem elementos).
    - Exemplo built-in: `ngIf`, `ngFor`, `ngSwitchCase`.
    - Sintaxe: prefixo  converte a diretiva em `<ng-template>`.
- **Diretivas de Atributo**
    - Modificam aparência ou comportamento de um elemento existente.
    - Exemplo built-in: `ngClass`, `ngStyle`, `routerLinkActive`.
    - Sintaxe: usadas como atributos sem .

### 3.2 API e Ciclo de Vida

### Decorator `@Directive`

```tsx
import { Directive, ElementRef, Input, HostListener } from '@angular/core';

@Directive({
  selector: '[appHighlight]'      // como usar: <p appHighlight>
})
export class HighlightDirective { ... }

```

- **selector:** string ou array de seletores CSS/atributo.

### Injeção de Dependência

- `constructor(private el: ElementRef, private renderer: Renderer2) { }`
    - `ElementRef`: acesso nativo ao elemento.
    - `Renderer2`: manipulação safe do DOM.

### Inputs & Outputs

- `@Input() highlightColor: string;`
- `@Output() clicked = new EventEmitter<Event>();`

### Lifecycle Hooks

- `ngOnInit()`: inicialização de lógica;
- `ngOnChanges(changes: SimpleChanges)`: quando `@Input` muda;
- `ngOnDestroy()`: limpeza (ex: unsubscribes).

### Host Bindings & Listeners

- `@HostBinding('style.backgroundColor') bg: string;`
- `@HostListener('mouseenter') onEnter() { ... }`

### 3.3 Restrições de Uso

- **Estruturais** só funcionam com  e geram `<ng-template>`.
- Não misturar manipulação direta de DOM sem `Renderer2`.
- **Pureza de Diretivas:** por padrão, tratadas como puras (determinísticas), exceto quando configurado `pure: false` no decorator (usar com cuidado para performance).

---

## 4. Exemplos de Código Otimizados

### 4.1 Diretiva de Atributo Simples

```tsx
import { Directive, ElementRef, HostListener, Renderer2, Input } from '@angular/core';

@Directive({
  selector: '[appHighlight]'
})
export class HighlightDirective {
  @Input('appHighlight') color = 'yellow'; // valor default

  constructor(private el: ElementRef, private renderer: Renderer2) {}

  @HostListener('mouseenter') onMouseEnter() {
    this.renderer.setStyle(this.el.nativeElement, 'backgroundColor', this.color);
  }

  @HostListener('mouseleave') onMouseLeave() {
    this.renderer.removeStyle(this.el.nativeElement, 'backgroundColor');
  }
}

```

**Uso no template:**

```html
<p appHighlight="lightblue">Passe o mouse aqui!</p>

```

### 4.2 Diretiva Estrutural Personalizada

```tsx
import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';

@Directive({
  selector: '[appUnless]' // inverso do *ngIf
})
export class UnlessDirective {
  private hasView = false;
  @Input() set appUnless(condition: boolean) {
    if (!condition && !this.hasView) {
      this.vcRef.createEmbeddedView(this.tplRef);
      this.hasView = true;
    } else if (condition && this.hasView) {
      this.vcRef.clear();
      this.hasView = false;
    }
  }

  constructor(
    private tplRef: TemplateRef<any>,
    private vcRef: ViewContainerRef
  ) {}
}

```

**Uso no template:**

```html
<div *appUnless="isLoggedIn">Você precisa logar!</div>

```

### 4.3 Boas Práticas

- **OnPush** para componentes e pipes associados, evitando reexecuções desnecessárias.
- Evite lógica pesada em `ngOnChanges`.
- Prefira manipular classes via `renderer.addClass()` em vez de `nativeElement.classList`.

---

## 5. Informações Adicionais

- **Diferença entre Diretivas e Componentes:**
    - Componentes incluem template e encapsulamento de estilos; diretivas não têm template.
- **Performance:**
    - Diretivas estruturais criam views; usar com parcimônia para listas grandes (`trackBy`).
- **Debugging:** usar `ng.probe($0)` no console do Chrome para inspecionar instâncias em runtime.
- **Testes Unitários:**
    - Use `TestBed` para criar fixture de host component que utilize a diretiva.

---

## 6. Referências para Estudo Independente

- [Angular – Diretivas (Guia Oficial)](https://angular.io/guide/directive)
- [Angular API – `@Directive`](https://angular.io/api/core/Directive)
- Livro **“Angular: Up & Running”** (Shyam Seshadri)
- Artigo **“Creating Custom Directives in Angular”** – DigitalOcean
- Curso **Egghead.io** – “Angular Directives Fundamentals”