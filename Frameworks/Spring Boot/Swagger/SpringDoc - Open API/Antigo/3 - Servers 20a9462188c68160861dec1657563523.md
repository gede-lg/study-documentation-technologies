# 3 - Servers

A estrutura `Servers` no contexto do Swagger e OpenAPI é uma componente crucial para definir a(s) URL(s) base onde a API está hospedada ou será acessada. Esta seção é particularmente útil em documentos OpenAPI porque permite aos desenvolvedores e aos usuários da API entenderem onde as operações da API podem ser executadas.

## O que é e para que serve?

Em um documento OpenAPI, a seção `Servers` especifica um ou mais URLs que representam a base dos caminhos de acesso aos recursos da API. Cada entrada na lista de `servers` pode também incluir uma descrição, ajudando assim na identificação do ambiente de servidor (produção, desenvolvimento, teste, etc.). Isso é essencial para APIs que possuem múltiplos ambientes com diferentes pontos de acesso.

## Quando utilizar?

Você deve configurar a seção `Servers` sempre que sua API estiver acessível em diferentes ambientes ou quando o endpoint base não for o mesmo que o do servidor que hospeda a documentação. Isso é especialmente relevante para:

- **Desenvolvimento e Teste**: Definir diferentes servidores para desenvolvimento, teste e produção.
- **APIs Multi-Regionais**: Especificar diferentes servidores para diferentes regiões geográficas.
- **Versões da API**: Indicar diferentes servidores se diferentes versões da API estiverem ativas em URLs distintos.

## Definição completa por meio de uma classe de configuração

Para configurar a seção `Servers` por meio de uma classe Java em um projeto que utiliza Spring Boot com SpringDoc, você pode definir um bean do tipo `OpenAPI` e configurar os servidores como mostrado no exemplo a seguir:

```java
import io.swagger.v3.oas.models.OpenAPI;import io.swagger.v3.oas.models.servers.Server;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;@Configurationpublic class OpenApiConfig {    @Bean    public OpenAPI customOpenAPI() {        return new OpenAPI()            .addServersItem(new Server().url("https://api.example.com").description("Servidor de Produção"))            .addServersItem(new Server().url("https://dev-api.example.com").description("Servidor de Desenvolvimento"));    }}
```

Neste exemplo, definimos dois servidores: um para produção e outro para desenvolvimento, com URLs e descrições apropriadas.

## Definição completa por meio de anotação

No contexto de uma abordagem mais centrada na declaração diretamente nos controladores ou métodos, o SpringDoc OpenAPI suporta a definição de servidores também através de anotações, embora seja menos comum para definições globais como servidores. A anotação principal seria em nível de método ou classe, mas para uma configuração global, recomenda-se o uso de uma classe de configuração como mostrado anteriormente. Aqui está como você poderia teoricamente usar anotações se fosse possível especificar servidores diretamente:

```java
import io.swagger.v3.oas.annotations.servers.Server;import io.swagger.v3.oas.annotations.servers.ServerVariable;import io.swagger.v3.oas.annotations.Operation;public class ApiController {    @Operation(summary = "Get User", description = "Get a user by ID")    @Server(url = "https://api.example.com", description = "Servidor de Produção")    public User getUserById(String id) {        // lógica do método    }}
```

## Definição completa por meio de anotação OpenAPIDefinition

```java
import io.swagger.v3.oas.annotations.OpenAPIDefinition;import io.swagger.v3.oas.annotations.servers.Server;import io.swagger.v3.oas.annotations.servers.ServerVariable;import io.swagger.v3.oas.annotations.info.Info;@OpenAPIDefinition(    info = @Info(title = "API de Exemplo", version = "v1"),    servers = {        @Server(url = "https://dev.example.com/api", description = "Development server"),        @Server(url = "https://example.com/api", description = "Production server")    })public class Application {    public static void main(String[] args) {        // Start application    }}
```

## Conclusão

A definição da seção `Servers` é essencial para uma documentação de API clara e eficaz, facilitando a compreensão e o uso adequado dos diferentes ambientes de uma API. Ao configurar esta seção, os desenvolvedores garantem que os consumidores da API tenham clareza sobre onde as operações devem ser executadas, o que é fundamental em cenários de desenvolvimento e operação de APIs complexas.