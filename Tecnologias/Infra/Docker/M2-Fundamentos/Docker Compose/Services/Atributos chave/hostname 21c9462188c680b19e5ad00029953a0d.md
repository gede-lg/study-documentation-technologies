# hostname

**Entendendo o atributo `hostname` no Docker Compose**

---

## Índice

1. [Introdução](https://chatgpt.com/g/g-p-68596a64c76c819185e08bdb9bacec85-infra/c/6859817f-01e8-8013-9e5a-cbb14e4c689f#introdu%C3%A7%C3%A3o)
2. [Conceitos Fundamentais](https://chatgpt.com/g/g-p-68596a64c76c819185e08bdb9bacec85-infra/c/6859817f-01e8-8013-9e5a-cbb14e4c689f#conceitos-fundamentais)
3. [Sintaxe Detalhada e Uso Prático](https://chatgpt.com/g/g-p-68596a64c76c819185e08bdb9bacec85-infra/c/6859817f-01e8-8013-9e5a-cbb14e4c689f#sintaxe-detalhada-e-uso-pr%C3%A1tico)
4. [Cenários de Restrição ou Não Aplicação](https://chatgpt.com/g/g-p-68596a64c76c819185e08bdb9bacec85-infra/c/6859817f-01e8-8013-9e5a-cbb14e4c689f#cen%C3%A1rios-de-restri%C3%A7%C3%A3o-ou-n%C3%A3o-aplica%C3%A7%C3%A3o)
5. [Componentes-Chave Associados](https://chatgpt.com/g/g-p-68596a64c76c819185e08bdb9bacec85-infra/c/6859817f-01e8-8013-9e5a-cbb14e4c689f#componentes-chave-associados)
6. [Melhores Práticas e Padrões de Uso](https://chatgpt.com/g/g-p-68596a64c76c819185e08bdb9bacec85-infra/c/6859817f-01e8-8013-9e5a-cbb14e4c689f#melhores-pr%C3%A1ticas-e-padr%C3%B5es-de-uso)
7. [Exemplo Prático Completo](https://chatgpt.com/g/g-p-68596a64c76c819185e08bdb9bacec85-infra/c/6859817f-01e8-8013-9e5a-cbb14e4c689f#exemplo-pr%C3%A1tico-completo)
8. [Sugestões para Aprofundamento](https://chatgpt.com/g/g-p-68596a64c76c819185e08bdb9bacec85-infra/c/6859817f-01e8-8013-9e5a-cbb14e4c689f#sugest%C3%B5es-para-aprofundamento)

---

## Introdução

O Docker Compose é uma ferramenta para definir e executar aplicações multicontêiner Docker por meio de um arquivo YAML, onde cada serviço é configurado em uma seção `services` ([docs.docker.com](https://docs.docker.com/reference/compose-file/services/)). Um dos atributos disponíveis para cada serviço é o `hostname`, que especifica qual será o nome de host interno atribuído ao contêiner quando ele for iniciado. Ajustar esse valor pode ser essencial para aplicações que realizam ligações baseadas em nome (resolução interna de DNS) ou que precisam de um nome estático para logs e monitoramento.

---

## Conceitos Fundamentais

- **O que é `hostname`?**
    
    O atributo `hostname` define o nome do host dentro do contêiner, adotado pelo sistema operacional como `hostname` (o conteúdo de `/etc/hostname`). Esse valor também é usado pelo mecanismo interno de DNS do Docker Compose. ([docs.docker.com](https://docs.docker.com/reference/compose-file/services/))
    
- **Validação segundo RFC 1123:**
    
    O nome deve cumprir o padrão RFC 1123, ou seja:
    
    - Comprimento máximo de 63 caracteres por “label”;
    - Somente letras (a–z), dígitos (0–9) e hífens ();
    - Não pode começar nem terminar com hífen. ([datatracker.ietf.org](https://datatracker.ietf.org/doc/html/draft-andrews-dns-hostnames-00?utm_source=chatgpt.com))
- **Diferença entre `hostname` e `container_name`:**
    - `container_name` define o nome do contêiner (visível no Docker Engine), incluindo prefixos de projeto e sequência.
    - `hostname` ajusta somente o nome interno do sistema operacional e a entrada DNS local do contêiner.

---

## Sintaxe Detalhada e Uso Prático

```yaml
version: "3.9"
services:
  app:
    image: myapp:latest
    hostname: meu-app          # Define o host interno como "meu-app"
    container_name: meuapp01   # Container será chamado "meuapp01" no Docker
    domainname: exemplo.local  # (opcional) Domínio de pesquisa para DNS interno
    networks:
      - frontnet

networks:
  frontnet: {}

```

1. **Declaração simples**
    
    ```yaml
    hostname: meu-app
    
    ```
    
    - Atribui “meu-app” como nome de host. ([docs.docker.com](https://docs.docker.com/reference/compose-file/services/))
2. **Combinação com `domainname`**
    
    ```yaml
    domainname: exemplo.local
    
    ```
    
    - Forma FQDN: “meu-app.exemplo.local”.
3. **Escopo de redes**
    - Cada contêiner usa esse hostname em todas as redes às quais pertence; porém, aliases de rede podem sobrepor nomes de DNS específicos via `networks:` → `aliases:`.

---

## Cenários de Restrição ou Não Aplicação

- **Orquestração Swarm:**
    
    No Docker Swarm, a resolução de nomes usa o Service Discovery interno, que prioriza o nome do serviço e VIPs; `hostname` pode ser ignorado em alguns drivers de redes externas.
    
- **Ambientes de produção sem DNS interno:**
    
    Se sua arquitetura não faz uso de DNS no nível de contêiner (ex.: host networking), alterar `hostname` não afetará a comunicação entre contêineres.
    
- **Containers efêmeros e escala automática:**
    
    Em cenários de replicação dinâmica, definir o mesmo hostname pode gerar conflitos de DNS interno.
    

---

## Componentes-Chave Associados

| Componente | Finalidade |
| --- | --- |
| `hostname` | Nome interno do SO do contêiner e registro DNS no namespace da rede. |
| `container_name` | Nome público do contêiner no Docker Engine (CLI/API). |
| `domainname` | Sufixo de domínio para formar FQDN dentro do contêiner. |
| `networks.aliases` | Alias de DNS por rede, que pode sobrescrever `hostname` em determinado contexto de rede. |
| `extra_hosts` | Mapeamento manual de hosts/IPs no `/etc/hosts`, complementando `hostname`. |

---

## Melhores Práticas e Padrões de Uso

- **Evitar conflitos:** Ao usar replicação (multi-instância), prefira DNS de serviço em vez de definir `hostname` fixo.
- **Validação de nomes:** Sempre use nomes válidos segundo RFC 1123 (letras minúsculas e hífens) para garantir compatibilidade ([datatracker.ietf.org](https://datatracker.ietf.org/doc/html/draft-andrews-dns-hostnames-00?utm_source=chatgpt.com)).
- **Uso de aliases de rede:** Para múltiplas redes, utilize `networks:` → `aliases:` em vez de depender apenas de `hostname`, oferecendo flexibilidade de resolução.
- **Documentação clara:** Mantenha comentários explicando por que um `hostname` customizado é necessário, evitando “doc debt” em equipes.

---

## Exemplo Prático Completo

Suponha um sistema com um back-end, front-end e um serviço de caching, cada um precisando de hostnames customizados:

```yaml
version: "3.8"
services:
  web:
    image: nginx:latest
    hostname: frontend               # Nome interno: frontend
    domainname: corp.local           # FQDN: frontend.corp.local
    networks:
      frontnet:
        aliases:
          - webapp                   # Também acessível como "webapp" na rede frontnet

  api:
    build: ./api
    hostname: backend
    domainname: corp.local
    environment:
      - REDIS_HOST=cache.corp.local
    networks:
      - frontnet
      - backnet

  cache:
    image: redis:7
    hostname: cache
    domainname: corp.local
    networks:
      backnet:

networks:
  frontnet: {}
  backnet: {}

```

- **Resolução entre serviços:**
    - `web` resolve `api` via DNS “api.corp.local” ou “backend.corp.local”.
    - `api` conecta-se ao Redis através de “cache.corp.local”.

---

## Sugestões para Aprofundamento

- Documentação oficial de Compose File Reference (seção Services)
- RFC 1123 (nomeação de hosts) ([datatracker.ietf.org](https://datatracker.ietf.org/doc/html/rfc1123?utm_source=chatgpt.com))
- Estudos sobre DNS interno em Docker Compose e Swarm

---

Com este guia você terá uma visão completa do atributo `hostname` em Docker Compose, desde a teoria até a aplicação prática em arquiteturas reais.