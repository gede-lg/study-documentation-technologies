# name

**Título da Explicação:** Entendendo o atributo `name` em `networks` no Docker Compose

---

## Introdução

No Docker Compose, redes (networks) são essenciais para definir a forma de comunicação entre containers. Por padrão, o Compose gera uma única rede com nome baseado no “nome do projeto” (geralmente o nome do diretório), mas é possível personalizar diversos aspectos dessas redes. Dentre os atributos configuráveis, o campo `name` permite definir explicitamente o nome da rede, sem escopo de projeto, suportando caracteres especiais e integração com redes externas ([docs.docker.com](https://docs.docker.com/reference/compose-file/networks/)).

---

## Sumário

1. Conceitos Fundamentais
2. Sintaxe Detalhada e Uso Prático
3. Cenários de Restrição ou Não Aplicação
4. Componentes Chave Associados
5. Melhores Práticas e Padrões de Uso
6. Exemplo Prático Completo
7. Sugestões para Aprofundamento

---

## 1. Conceitos Fundamentais

- **Projeto e Escopo de Rede:**
    
    O Docker Compose agrupa containers num “projeto” cujo nome padrão é o diretório em que o `docker-compose.yml` está. Todas as redes criadas sem `name` são prefixadas por `<projeto>_<nome_da_rede>` ([docs.docker.com](https://docs.docker.com/compose/how-tos/networking/?utm_source=chatgpt.com)).
    
- **Campo `name`:**
    
    Ao usar `name`, o Compose dá à rede exatamente o valor configurado, **sem** concatenar o nome do projeto. Isso é útil para:
    
    - Referenciar redes com caracteres especiais (p.ex. underscores, pontos).
    - Compartilhar uma rede gerenciada fora do Compose (via atributo `external`). ([docs.docker.com](https://docs.docker.com/reference/compose-file/networks/)).

---

## 2. Sintaxe Detalhada e Uso Prático

```yaml
version: "3.9"

services:
  app:
    image: nginx
    networks:
      - minha-rede-custom

networks:
  minha-rede-custom:
    name: my-app-net        # define o nome exato da rede

```

- **Definição Simples:**
    - `networks.<identificador>.name`: string literal ou variável de ambiente (interpolação).
- **Interpolação de Variáveis:**
    
    ```yaml
    networks:
      rede-runtime:
        external: true
        name: "${NETWORK_ID}"  # valor fornecido em tempo de execução
    
    ```
    
    O Compose não tentará criar essa rede, mas conectará o serviço à rede já existente de nome `NETWORK_ID` ([docs.docker.com](https://docs.docker.com/reference/compose-file/networks/)).
    

---

## 3. Cenários de Restrição ou Não Aplicação

- **Redes Implícitas:**
    
    Se não houver seção `networks`, o Compose cria a rede `default` (`<projeto>_default`). O atributo `name` só funciona em redes declaradas explicitamente.
    
- **Redes Externas sem `name`:**
    
    Se usar `external: true` sem `name`, o Compose assume que o nome da rede no Compose é também o nome real. Outros atributos são ignorados ou causam erro ([docs.docker.com](https://docs.docker.com/reference/compose-file/networks/)).
    
- **Scope de Swarm vs. Compose:**
    
    Em ambientes Swarm, recomenda-se usar `docker network create` e depois referenciar como externo, deixando o gerenciamento de nomes a cargo da infraestrutura de orquestração.
    

---

## 4. Componentes Chave Associados

- **`driver`**: define o driver de rede (bridge, overlay, host etc.)
- **`external`**: indica que a rede existe fora do Compose
- **`labels`**: metadados para containers e redes
- **`ipam`**: configurações de IPAM (subnet, gateway, opções)
- **`attachable`**: permite que containers “standalone” se conectem à rede ([docs.docker.com](https://docs.docker.com/reference/compose-file/networks/)).

Cada um desses componentes pode interagir com `name`: por exemplo, `external: true` + `name` customiza a rede externa que o Compose deve usar.

---

## 5. Melhores Práticas e Padrões de Uso

- **Consistência de Nomes:** escolha convenções claras (por ex. `team-service-env-net`) para facilitar identificação em ambientes compartilhados.
- **Variáveis de Ambiente:** utilize `${NETWORK_NAME}` em vez de hard-code, favorecendo portabilidade entre ambientes (desenvolvimento, staging, produção).
- **Redes Externas:** para infra de múltiplos projetos que compartilham redes (p.ex. backend-services), crie-as manualmente com `docker network create` e utilize `external: true` + `name` para evitar recriação involuntária.
- **Evite Caracteres Inválidos:** embora `name` suporte caracteres especiais, mantenha nomes alfanuméricos e  ou `_` para compatibilidade com ferramentas de monitoração e scripts.

---

## 6. Exemplo Prático Completo

Imagine um microserviço `api` e um painel `ui` que devem compartilhar uma rede chamada `prod-net`, já criada externamente:

```yaml
version: "3.9"

services:
  api:
    image: company/api:latest
    networks:
      - prod-net-compose

  ui:
    image: company/ui:latest
    networks:
      - prod-net-compose

networks:
  prod-net-compose:
    external: true
    name: prod-net        # conecta-se à rede existente 'prod-net'

```

**Fluxo de criação / conexão:**

1. `docker network create prod-net`
2. `docker compose up` liga `api` e `ui` à rede `prod-net` sem tentar recriá-la.

---

## 7. Sugestões para Aprofundamento

- Explorar **IPAM avançado** para sub-redes e gateways personalizados.
- Ler mais sobre **drivers overlay** e uso em Swarm/Kubernetes.
- Integrar redes Compose com **plugins de rede SDN** (Weave, Calico).
- Consultar a seção de **labels** para automação de serviços via Docker API.

---

Com este guia, você tem uma visão completa de como o atributo `name` em `networks` permite controlar precisamente o nome e o escopo das suas redes no Docker Compose, garantindo previsibilidade e flexibilidade na comunicação entre containers.