# Update

---

## 1. Finalidade do `docker update`

O **`docker update`** permite **ajustar dinamicamente** os limites de recurso e algumas configurações de um ou mais contêineres em execução ou parados, sem precisar recriá-los. É útil para:

- Adaptar consumo de CPU e memória conforme a carga.
- Ajustar políticas de reinício durante a execução.
- Modificar limites de PIDs ou I/O sem interromper o serviço.

---

## 2. Sintaxe básica

```bash
docker update [OPTIONS] CONTAINER [CONTAINER...]

```

- **`CONTAINER`**: um ou mais nomes/IDs de contêineres a serem atualizados.

---

## 3. Opções de recurso

### CPU e cgroups

| Opção | Descrição |
| --- | --- |
| `-c, --cpu-shares int` | Peso relativo de CPU (padrão 1024). |
| `--cpus decimal` | Número de CPUs permitidas (ex.: `--cpus 1.5`). |
| `--cpu-period int` | Período CFS em microssegundos. |
| `--cpu-quota int` | Quota de CPU em microssegundos por período. |
| `--cpu-rt-period int` | Período real-time CFS (para workloads RT). |
| `--cpu-rt-runtime int` | Tempo real-time permitido no período. |
| `--cpuset-cpus string` | CPUs específicas permitidas (ex.: `0-3`, `1,2`). |
| `--cpuset-mems string` | Nodos de memória permitidos (ex.: `0-1`). |

### Memória e swap

| Opção | Descrição |
| --- | --- |
| `-m, --memory bytes` | Limite de RAM (ex.: `-m 512m`, `-m 2g`). |
| `--memory-reservation bytes` | Limite “soft” de memória, para acionar OOM-killer mais tarde. |
| `--memory-swap bytes` | Limite total de RAM + swap (`-1` para ilimitado). |

### Outros recursos

| Opção | Descrição |
| --- | --- |
| `--blkio-weight uint16` | Peso relativo de I/O em bloco (10–1000). |
| `--pids-limit int` | Número máximo de PIDs (`-1` para ilimitado). |

---

## 4. Opções gerais

| Opção | Descrição |
| --- | --- |
| `--restart string` | Política de reinício para quando o contêiner sair (ex.: `no`, `on-failure`, `always`, `unless-stopped`). |

---

## 5. Exemplos de uso

1. **Aumentar memória de um contêiner**
    
    ```bash
    docker update -m 1g my_container
    
    ```
    
2. **Diminuir CPU share e limitar a 0.5 CPUs**
    
    ```bash
    docker update --cpu-shares 512 --cpus 0.5 api_server
    
    ```
    
3. **Limitar PIDs e ajustar política de reinício**
    
    ```bash
    docker update --pids-limit 100 --restart on-failure:5 worker
    
    ```
    
4. **Ajustar I/O de bloco**
    
    ```bash
    docker update --blkio-weight 500 db_container
    
    ```
    

---

## 6. Tabela de referência rápida

| Categoria | Opções principais |
| --- | --- |
| CPU | `-c`, `--cpus`, `--cpu-period`, `--cpu-quota` |
| Memória | `-m`, `--memory-reservation`, `--memory-swap` |
| I/O | `--blkio-weight` |
| PIDs | `--pids-limit` |
| Restart | `--restart` |

---

Com o **`docker update`**, você ajusta em tempo de execução os limites de recurso e políticas dos seus contêineres de forma ágil, sem precisar recriá-los.