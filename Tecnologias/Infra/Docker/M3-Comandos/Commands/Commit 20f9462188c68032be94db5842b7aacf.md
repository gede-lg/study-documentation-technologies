# Commit

---

## 1. Finalidade do `docker commit`

O **`docker commit`** cria uma **nova imagem** Docker a partir das **alterações** realizadas em um **contêiner em execução** ou parado. Ele “congela” o estado atual do sistema de arquivos do contêiner e gera uma imagem reutilizável com base nele.

---

## 2. Sintaxe básica

```bash
docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]

```

- **`CONTAINER`**: nome ou ID do contêiner cuja árvore de camadas será “comitada”.
- **`REPOSITORY[:TAG]`** *(opcional)*: repositório e tag que serão atribuídos à nova imagem; se omitido, retorna apenas o ID da imagem.

---

## 3. Parâmetros

| Parâmetro | Obrigatório | Descrição |
| --- | --- | --- |
| `CONTAINER` | Sim | Nome ou ID do contêiner a ser comitado. |
| `REPOSITORY[:TAG]` | Não | Nome (e opcionalmente tag) para a nova imagem, ex.: `minharepo/minhaimagename:versao1.0`. |

---

## 4. Opções disponíveis

| Opção | Tipo | Padrão | Finalidade |
| --- | --- | --- | --- |
| `-a, --author string` | string | — | Define o autor (campo MAINTAINER) na metadata da imagem, ex.: `"João Silva <joao@exemplo.com>"`. |
| `-m, --message string` | string | — | Mensagem de commit (campo COMMENT) que descreve as alterações, semelhante a um commit Git. |
| `-c, --change list` | lista | — | Aplica instruções Dockerfile na imagem resultante. Pode repetir, ex.: `-c CMD=["/bin/bash"] -c EXPOSE=8080`. |
| `-p, --pause` | boolean | `true` | Pausa o contêiner durante o commit para garantir um snapshot consistente; use `--pause=false` para desativar. |

---

## 5. Fluxo de funcionamento

1. **(Opcional) Pausa do contêiner**
    - Se `-pause=true`, o contêiner é congelado brevemente para capturar um estado consistente.
2. **Captura de camadas**
    - Docker gera uma nova camada com todas as alterações no sistema de arquivos desde que o contêiner foi criado ou comitado anteriormente.
3. **Aplicação de metadados**
    - Registra o autor, mensagem e mudanças adicionais (via `c`).
4. **Criação da imagem**
    - Grava a nova imagem no armazenamento local, retornando seu ID ou nome completo.
5. **(Opcional) Despausa**
    - Se pausado, o contêiner é retomado após o snapshot.

---

## 6. Exemplos de uso

1. **Criar imagem a partir de um contêiner e nomeá-la**
    
    ```bash
    docker commit my_container minharepo/minhaimagem:latest
    # Saída: minharepo/minhaimagem:latest
    
    ```
    
2. **Adicionar autor e mensagem de commit**
    
    ```bash
    docker commit \
      -a "Ju Gomes <ju@example.com>" \
      -m "Configurado ambiente com dependências X e Y" \
      my_container minharepo/env-config:1.0
    
    ```
    
3. **Aplicar instruções Dockerfile na imagem**
    
    ```bash
    docker commit \
      -c 'EXPOSE 8080' \
      -c 'CMD["/usr/bin/start.sh"]' \
      my_container custom/app:exposed
    
    ```
    
4. **Fazer commit sem pausar o contêiner**
    
    ```bash
    docker commit --pause=false live_container snapshot:no-pause
    
    ```
    

---

## 7. Tabela de referência rápida

| Componente | Sintaxe | Descrição |
| --- | --- | --- |
| Comando base | `docker commit [OPTIONS] CONTAINER [REPO:TAG]` | Cria uma imagem a partir do estado de um contêiner. |
| Parâmetro | `CONTAINER` | Nome ou ID do contêiner de origem. |
| Parâmetro | `REPOSITORY[:TAG]` | Nome e tag (opcional) para a imagem resultante. |
| Opção | `-a, --author "<autor>"` | Define o campo autor/maintainer da imagem. |
| Opção | `-m, --message "<mensagem>"` | Mensagem descritiva do commit. |
| Opção | `-c, --change <instrução>` | Adiciona instruções Dockerfile (`CMD`, `ENTRYPOINT`, `EXPOSE` etc.). |
| Opção | `-p, --pause [true | false]` |

---

Com essas informações, você pode utilizar o **`docker commit`** para capturar rapidamente estados de contêineres em imagens reutilizáveis, adicionando metadados e instruções conforme necessário. Se tiver cenários específicos ou dúvidas adicionais, estou à disposição!