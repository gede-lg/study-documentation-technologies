# History

---

## 1. Finalidade do `docker history`

O **`docker history`** exibe o **histórico de camadas** de uma imagem Docker, listando cada camada criada durante o build, seu tamanho, comando que a gerou e o timestamp. É útil para:

- Auditar como a imagem foi construída.
- Identificar camadas pesadas que podem ser otimizadas.
- Verificar instruções Dockerfile aplicadas em cada etapa.

---

## 2. Sintaxe básica

```bash
docker history [OPTIONS] IMAGE

```

- **`IMAGE`**: nome (com tag opcional) ou ID da imagem cuja história você quer inspecionar (ex.: `ubuntu:20.04`, `myapp:latest`).

---

## 3. Parâmetro

| Parâmetro | Obrigatório | Descrição |
| --- | --- | --- |
| `IMAGE` | Sim | A imagem Docker (nome:tag ou ID) para exibir o histórico. |

---

## 4. Opções disponíveis

| Opção | Tipo | Padrão | Descrição |
| --- | --- | --- | --- |
| `--format string` | string | `table` | Formata a saída usando template Go ou JSON. Use: |
- `table` (padrão),
- `json`,
- `table TEMPLATE` ou
- `TEMPLATE`. |
    
    | `-H, --human`                    | boolean  | `true`   | Exibe **tamanhos** e **datas** em formato legível (ex.: `5MB`, `2 days ago`).                             |
    
    | `--no-trunc`                     | boolean  | `false`  | Não trunca o conteúdo das colunas (IDs, comandos, tamanhos, etc.).                                        |
    
    | `--platform string`              | string   | host     | Mostra histórico para uma plataforma específica (ex.: `linux/amd64`, `linux/arm64`).                      |
    
    | `-q, --quiet`                    | boolean  | `false`  | Exibe **apenas** os IDs das camadas, um por linha.                                                        |
    

---

## 5. Exemplo de saída

```bash
$ docker history --human ubuntu:20.04
IMAGE          CREATED         CREATED BY                                      SIZE     COMMENT
<missing>      3 weeks ago     /bin/sh -c #(nop)  CMD ["bash"]                 0B
<missing>      3 weeks ago     /bin/sh -c #(nop) ADD file:abcdef123456 in /     72.8MB
<missing>      3 weeks ago     /bin/sh -c #(nop)  LABEL org.label-schema.sc…   0B
<missing>      3 weeks ago     /bin/sh -c set -eux; apt-get update; apt-get…   70.3MB
<missing>      3 weeks ago     /bin/sh -c #(nop)  ARG LAUNCHPAD_BUILD_ARCH      0B
<missing>      3 weeks ago     /bin/sh -c #(nop)  ARG RELEASE                   0B
<missing>      3 weeks ago     /bin/sh -c #(nop)  ARG PACKER_BUILDER_TYPE      0B
<missing>      3 weeks ago     /bin/sh -c #(nop)  FROM debian:buster-slim       0B

```

---

## 6. Exemplos de uso

1. **Histórico padrão em tabela**
    
    ```bash
    docker history myapp:latest
    
    ```
    
2. **Somente IDs das camadas**
    
    ```bash
    docker history -q nginx:alpine
    
    ```
    
3. **Formato JSON para scripts**
    
    ```bash
    docker history --format json myimage:1.0
    
    ```
    
4. **Mostrar sem truncar comandos longos**
    
    ```bash
    docker history --no-trunc myimage
    
    ```
    
5. **Ver histórico de outra plataforma**
    
    ```bash
    docker history --platform linux/arm64 mymultiarch/image:2.0
    
    ```
    

---

## 7. Tabela de referência rápida

| Componente | Sintaxe / Valor | Descrição |
| --- | --- | --- |
| Comando base | `docker history [OPTIONS] IMAGE` | Exibe histórico de camadas de uma imagem Docker. |
| Parâmetro | `IMAGE` | Imagem (nome:tag ou ID) para inspecionar. |
| Opção | `--format <template | json>` |
| Opção | `-H, --human` | Datas e tamanhos em formato legível. |
| Opção | `--no-trunc` | Sem truncamento de colunas. |
| Opção | `--platform <os/arch>` | Histórico de plataforma específica. |
| Opção | `-q, --quiet` | Apenas IDs das camadas. |

---

Com isso, você tem tudo o que precisa para analisar o **histórico de builds** e otimizar suas imagens Docker de forma informada.