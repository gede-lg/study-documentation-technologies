# Update

## Visão Geral

O comando `docker container update` permite alterar **em tempo de execução** configurações de recursos e políticas de reinício em um ou mais containers já existentes, sem necessidade de recriá-los. É ideal para ajustar CPU, memória, limites de processos e políticas de reinício de forma dinâmica.

---

## Sintaxe

```bash
docker container update [OPÇÕES] CONTAINER [CONTAINER...]

```

- **CONTAINER [CONTAINER…]**: nome(s) ou ID(s) do(s) container(es) a serem atualizados.

Aliases equivalentes:

```bash
docker update [OPÇÕES] CONTAINER [CONTAINER...]

```

---

## Opções Principais

| Opção | Descrição |
| --- | --- |
| `--blkio-weight uint16` | Define peso relativo de I/O em bloco (10–1000; `0` desliga limitação). |
| **CPU** |  |
| `--cpu-period int` | Limita o período CFS (Completely Fair Scheduler) em microssegundos. |
| `--cpu-quota int` | Define o quota CFS total em microssegundos. |
| `--cpu-rt-period int` | Limita o período de CPU em tempo real em microssegundos. |
| `--cpu-rt-runtime int` | Limita o tempo de CPU em tempo real que o container pode usar. |
| `-c, --cpu-shares int` | Ajusta shares de CPU (peso relativo quando há disputa). |
| `--cpus decimal` | Número de CPUs atribuídas (ex.: `1.5`). |
| `--cpuset-cpus string` | CPUs permitidas (ex.: `0-3`, `0,1`). |
| `--cpuset-mems string` | Memórias NUMA permitidas (ex.: `0-3`, `0,1`). |
| **Memória** |  |
| `-m, --memory bytes` | Limite de memória (ex.: `512m`, `2g`). |
| `--memory-reservation bytes` | Limite “soft” de memória. |
| `--memory-swap bytes` | Swap + memória (use `-1` para ilimitado). |
| **Processos e Reinício** |  |
| `--pids-limit int` | Máximo de PIDs/threads permitidos (`-1` para ilimitado). |
| `--restart string` | Política de reinício (`no`, `on-failure[:max]`, `always`, `unless-stopped`). |

> Observação:
> 
> - Nem todas as opções estão disponíveis em versões mais antigas do Docker.
> - Valores configurados aqui se aplicam imediatamente e são mantidos até o próximo `docker restart`.

---

## Exemplos de Uso

1. **Ajustar memória e CPU de um container em execução**
    
    ```bash
    docker container update \
      --memory 1g \
      --cpus 2.0 \
      minha_aplicacao
    
    ```
    
    Passa a alocar 1 GiB de RAM e 2 CPUs à aplicação já em execução.
    
2. **Mudar política de reinício**
    
    ```bash
    docker update --restart=on-failure:5 worker
    
    ```
    
    Faz com que o container `worker` seja reiniciado até 5 vezes em caso de falha.
    
3. **Limitar número de processos**
    
    ```bash
    docker container update --pids-limit=100 db_service
    
    ```
    
    Evita que o serviço de banco de dados crie mais de 100 processos/threads.
    
4. **Configurar I/O e tempo real de CPU**
    
    ```bash
    docker update \
      --blkio-weight=500 \
      --cpu-rt-runtime=200000 \
      realtime_app
    
    ```
    
    Ajusta peso de I/O e tempo real de CPU para a aplicação sensível à latência.
    

---

> Dica:
> 
> 
> Antes de atualizar, use `docker ps` para confirmar o nome/ID do container, e `docker inspect` para revisar os limites atuais.
>