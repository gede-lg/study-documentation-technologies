# Up

## 1. Introdução

O comando `docker compose up` serve para criar e iniciar todos os contêineres definidos em um arquivo `docker-compose.yml`. Por padrão, ele lê o arquivo na pasta atual, monta as redes, volumes e, se necessário, faz o build das imagens antes de subir os serviços.

---

## 2. Sintaxe Geral

```bash
docker compose up [OPTIONS] [SERVICE...]

```

- **SERVICE...** (opcional): lista de serviços definidos no Compose file que você quer subir. Se não for especificado, todos os serviços serão iniciados.

---

## 3. Descrição Detalhada das Opções

A seguir, cada opção do `docker compose up` com sua **sintaxe**, **finalidade** e **observações de uso**.

### 3.1 Controle de Ciclo de Vida

| Opção | Sintaxe | Finalidade | Observações |
| --- | --- | --- | --- |
| **Abortar se qualquer contêiner sair** | `--abort-on-container-exit` | Para: se **qualquer** contêiner parar (exit), todos os demais são interrompidos. | Incompatível com `-d`. |
| **Abortar somente em falha** | `--abort-on-container-failure` | Para: se **algum** contêiner sair com código ≠ 0, interrompe todos. | Incompatível com `-d`. |
| **Não iniciar após criação** | `--no-start` | Cria redes e contêineres, mas **não** inicia os serviços. | — |
| **Forçar recreação** | `--force-recreate` | Mesmo que nada tenha mudado, recria sempre todos os contêineres. | Incompatível com `--no-recreate`. |
| **Não recriar** | `--no-recreate` | Se já existir contêiner para o serviço, **não** recria. | Incompatível com `--force-recreate`. |
| **Recriar dependências** | `--always-recreate-deps` | Recria também contêineres de serviços dos quais o atual depende. | Incompatível com `--no-recreate`. |

### 3.2 Build e Pull de Imagens

| Opção | Sintaxe | Finalidade | Padrão / Observações |
| --- | --- | --- | --- |
| **Build antes de subir** | `--build` | Executa `docker compose build` antes de criar e iniciar os contêineres. | — |
| **Não buildar** | `--no-build` | Não executa build, mesmo que a política do Compose file exija. | — |
| **Pull de imagem** | `--pull <always|missing|never>` | Puxa a imagem do registry antes de rodar. | Default: `"policy"` (equivalente a missing). |
| **Pull silencioso** | `--quiet-pull` | Suprime o progresso (barra de download) ao puxar imagens. | — |

### 3.3 Anexar e Logs

| Opção | Sintaxe | Finalidade | Observações |
| --- | --- | --- | --- |
| **Anexar serviços específicos** | `--attach <SERVICES>` | Exibe logs apenas dos serviços listados. | Incompatível com `--attach-dependencies`. |
| **Não anexar serviços** | `--no-attach <SERVICES>` | Não exibe logs dos serviços listados. | — |
| **Anexar dependências** | `--attach-dependencies` | Além dos serviços principais, exibe logs de serviços dos quais dependem. | — |
| **Sem prefixo nos logs** | `--no-log-prefix` | Remove prefixes como ` | ` no início de cada linha de log. |
| **Monocromático** | `--no-color` | Remove cores/ANSI codes da saída. | Útil para gravação de logs. |
| **Timestamps** | `--timestamps` | Exibe data/hora antes de cada linha de log. | — |

### 3.4 Modo de Execução

| Opção | Sintaxe | Finalidade | Observações |
| --- | --- | --- | --- |
| **Detached** | `-d`, `--detach` | Inicia contêineres em segundo plano e retorna o prompt. | Logs não são mostrados (use `logs`). |
| **Dry run** | `--dry-run` | Simula o que aconteceria, mas **não** executa de fato. | Bom para validar configurações. |
| **Interativo (menu)** | `--menu` | Ativa atalhos interativos de atalho durante o modo attach. | Incompatível com `--detach`. |
| **Assume “yes”** | `-y`, `--yes` | Responde “yes” a todos os prompts, rodando de forma não interativa. | — |

### 3.5 Dependências e Limpeza

| Opção | Sintaxe | Finalidade | Observações |
| --- | --- | --- | --- |
| **Sem iniciar dependências** | `--no-deps` | Não inicia serviços nos quais o atual depende automaticamente. | Só subirá o serviço(ões) especificado(s). |
| **Remover órfãos** | `--remove-orphans` | Remove contêineres de serviços que não estão mais definidos no Compose file. | Útil após remoção de serviços no YML. |
| **Renovar volumes anônimos** | `-V`, `--renew-anon-volumes` | Recria volumes sem nome em vez de reaproveitá-los. | Perde dados armazenados nesses volumes. |

### 3.6 Escala, Timeouts e Espera

| Opção | Sintaxe | Finalidade | Observações |
| --- | --- | --- | --- |
| **Escalar serviço** | `--scale <SERVICE>=<N>` | Inicia **N** instâncias do serviço, ignorando valor definido no Compose file. | Pode ser usado com múltiplos `--scale`. |
| **Timeout de shutdown** | `-t`, `--timeout <segundos>` | Tempo (em segundos) para aguardar o contêiner desligar quando enviado SIGTERM/SIGINT. | Padrão: 10s. |
| **Aguardar healthy/running** | `--wait` | Fica bloqueado até que todos os serviços estejam “running” ou “healthy”. | Implica `--detach`. |
| **Timeout do wait** | `--wait-timeout <segundos>` | Tempo máximo (em segundos) para aguardar o estado “running”/“healthy” antes de falhar. | Default: 30s. |

### 3.7 Watch e Atualização Automática

| Opção | Sintaxe | Finalidade | Observações |
| --- | --- | --- | --- |
| **Watch do código** | `-w`, `--watch` | Fica observando alterações em arquivos e rebuild/recreate automaticamente. | Ideal para desenvolvimento local. |

---

## 4. Tabela Resumo de Opções

| Categoria | Opções Principais |
| --- | --- |
| **Ciclo de Vida** | `--abort-on-container-exit`, `--no-start`, `--force-recreate` |
| **Build/Pull** | `--build`, `--no-build`, `--pull`, `--quiet-pull` |
| **Logs/Attach** | `--attach`, `--attach-dependencies`, `--no-attach`, `--no-log-prefix` |
| **Modo de Execução** | `-d`, `--dry-run`, `--menu`, `-y` |
| **Deps & Limpeza** | `--no-deps`, `--remove-orphans`, `-V` |
| **Escala & Timeouts** | `--scale`, `-t`, `--wait`, `--wait-timeout` |
| **Desenvolvimento** | `-w` |
| **Saída** | `--no-color`, `--timestamps` |

---

## 5. Exemplos de Uso

1. **Subir tudo em background e escalar o serviço `web` para 3 instâncias**
    
    ```bash
    docker compose up -d --scale web=3
    
    ```
    
2. **Subir somente o serviço `db`, sem dependências, e não reconstrua contêineres existentes**
    
    ```bash
    docker compose up --no-deps --no-recreate db
    
    ```
    
3. **Subir, rebuildando sempre as imagens e aguardando que fiquem healthy**
    
    ```bash
    docker compose up --build --force-recreate --wait
    
    ```
    
4. **Simular (dry run) sem executar de fato**
    
    ```bash
    docker compose up --dry-run
    
    ```
    

---

Com essa estrutura você tem à mão:

- **Sintaxe básica** e propósito.
- **Detalhamento** de cada opção (uso, compatibilidades e defaults).
- **Tabela resumo** para consulta rápida.
- **Exemplos práticos** para cobrir os cenários mais comuns.