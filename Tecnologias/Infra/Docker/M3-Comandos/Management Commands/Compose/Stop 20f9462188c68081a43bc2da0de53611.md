# Stop

Olá Gedê, aqui é a A.R.I.A. Com certeza! Vamos detalhar o comando `docker compose stop` para que você não tenha nenhuma dúvida.

### O que faz o comando `docker compose stop`?

O comando `docker compose stop` é usado para **parar contêineres em execução** que foram iniciados pelo `docker compose up`.

A principal característica é que ele **não remove os contêineres**. Ele apenas interrompe sua execução. Isso significa que o estado dos contêineres, seus volumes e as redes criadas pelo Compose são preservados. Você pode iniciá-los novamente de forma rápida com o comando `docker compose start`.

---

### Sintaxe do Comando

A estrutura geral do comando é a seguinte:

```bash
docker compose stop [OPTIONS] [SERVICE...]

```

- `[OPTIONS]`: São as flags opcionais que modificam o comportamento do comando (como `-timeout`).
- `[SERVICE...]`: É um ou mais nomes dos serviços (definidos no seu arquivo `docker-compose.yml`) que você deseja parar. Se nenhum serviço for especificado, o comando será aplicado a **todos** os serviços do projeto.

---

### Parâmetros e Opções

Vamos analisar cada parte que você viu no `--help`.

### 1. `[SERVICE...]` (Parâmetro)

- **Finalidade**: Especificar quais serviços parar. Isso é útil quando você tem vários serviços rodando (ex: `database`, `backend`, `frontend`), mas só quer parar um ou dois deles.
- **Sintaxe**: Você simplesmente lista os nomes dos serviços separados por espaços após o comando.
    
    ```bash
    docker compose stop backend_api database
    
    ```
    
- **Uso**: Se você omitir este parâmetro, o Docker irá parar **todos** os serviços definidos no seu arquivo `docker-compose.yml`.

### 2. `t, --timeout int` (Opção)

- **Finalidade**: Especificar um tempo limite (em segundos) para que um contêiner pare de forma "graciosa".
- **Sintaxe**:
    - Forma curta: `docker compose stop -t 5`
    - Forma longa: `docker compose stop --timeout=5`
- **Como funciona**: Quando você executa `docker compose stop`, o Docker envia um sinal `SIGTERM` para o processo principal dentro de cada contêiner, pedindo que ele termine sua execução de forma limpa. O contêiner tem um tempo para fazer isso (salvar arquivos, fechar conexões, etc.). Se o contêiner não parar dentro do tempo especificado pelo `timeout` (o padrão é **10 segundos**), o Docker "perde a paciência" e envia um sinal `SIGKILL`, que força o encerramento imediato do processo, o que pode levar à corrupção de dados.
- **Uso**: Aumente o `timeout` se você tiver um serviço que demora mais de 10 segundos para desligar corretamente. Diminua se souber que seus serviços são rápidos e quiser acelerar o processo de parada.

### 3. `-dry-run` (Opção)

- **Finalidade**: Simular a execução do comando sem realmente parar nenhum contêiner.
- **Sintaxe**: `docker compose stop --dry-run`
- **Como funciona**: Ele exibe na tela quais contêineres *seriam* parados se você executasse o comando de verdade. É uma ótima ferramenta de segurança para verificar o impacto do seu comando antes de executá-lo, especialmente em ambientes complexos.

---

### Tabela Resumo

| Parâmetro/Opção | Sintaxe de Exemplo | Finalidade |
| --- | --- | --- |
| **`[SERVICE...]`** | `docker compose stop api db` | Para apenas os serviços especificados (`api` e `db`). |
| **`-t, --timeout`** | `docker compose stop -t 30` | Define um tempo limite de 30 segundos para o desligamento gracioso. |
| **`--dry-run`** | `docker compose stop --dry-run` | Mostra quais contêineres seriam parados, mas não executa a ação. |

---

### Diferença Crucial: `stop` vs `down`

É muito comum confundir `docker compose stop` com `docker compose down`.

- `docker compose stop`: Apenas **para** os contêineres. Eles continuam existindo e podem ser reiniciados com `docker compose start`.
- `docker compose down`: **Para E remove** os contêineres. Também remove a rede padrão associada. Para começar de novo, você precisa usar `docker compose up`, que recriará tudo do zero.

Espero que esta explicação bem estruturada ajude você, Gedê! Se tiver mais alguma dúvida, pode perguntar.