# PS

Olá Gedê!

Com certeza! Preparei uma explicação bem estruturada sobre o comando `docker compose ps`, detalhando cada um de seus parâmetros e como utilizá-los.

---

### Comando `docker compose ps`

O comando `docker compose ps` é utilizado para listar os contêineres que estão sendo gerenciados pelo Docker Compose no projeto atual (definido pelo seu arquivo `docker-compose.yml`). Ele mostra o estado de cada contêiner, os comandos que estão executando e as portas que estão mapeadas.

É uma ferramenta essencial para verificar o status da sua aplicação multi-contêiner de forma rápida.

---

### Sintaxe de Uso

A sintaxe geral do comando é:

```bash
docker compose ps [OPÇÕES] [SERVIÇO...]

```

- **`[OPÇÕES]`**: São os flags que modificam o comportamento do comando (ex: `-all`, `-quiet`).
- **`[SERVIÇO...]`**: (Opcional) Você pode especificar o nome de um ou mais serviços (definidos no `docker-compose.yml`) para listar apenas os contêineres relacionados a eles.

---

### Parâmetros (Opções)

Vamos detalhar cada uma das opções disponíveis.

- **`a, --all`**
    - **Finalidade**: Por padrão, o comando `ps` exibe apenas os contêineres que estão em execução (*running*). A opção `-all` mostra **todos** os contêineres do projeto, incluindo os que foram parados (`exited`), pausados (`paused`) ou que ainda estão sendo criados (`created`). É muito útil para depurar contêineres que não iniciam corretamente.
- **`-dry-run`**
    - **Finalidade**: Executa o comando em modo de "simulação". Ele mostra o que o Docker faria, mas não executa a ação de fato. Para o comando `ps`, seu efeito é menos evidente do que em comandos como `up` ou `down`, mas serve para validar a configuração e os filtros aplicados sem gerar a listagem final.
- **`-filter string`**
    - **Finalidade**: Permite filtrar a lista de serviços com base em uma propriedade. Atualmente, o filtro suportado é o `status`.
    - **Sintaxe**: `-filter status=<estado>`, por exemplo: `-filter status=running`.
- **`-format string`**
    - **Finalidade**: Controla o formato da saída. É uma opção poderosa para automação e scripts.
    - **Valores possíveis**:
        - `'table'`: (Padrão) Exibe a saída em uma tabela legível com cabeçalhos.
        - `'json'`: Exibe a saída em formato JSON, ideal para ser processado por outras ferramentas como `jq` ou em scripts.
        - `'TEMPLATE'` ou `'table TEMPLATE'`: Permite que você defina um formato de saída customizado usando Go templates. Consulte a [documentação do Docker](https://docs.docker.com/go/formatting/) para mais detalhes sobre a sintaxe dos templates.
- **`-no-trunc`**
    - **Finalidade**: Por padrão, o Docker trunca (encurta) valores longos como o ID do contêiner, a imagem e o comando para que a tabela fique alinhada. Usar `-no-trunc` exibe os valores completos, sem nenhum corte.
- **`-orphans`**
    - **Finalidade**: Inclui na listagem os contêineres "órfãos". Um contêiner órfão é aquele que foi criado para um serviço que não está mais declarado no seu arquivo `docker-compose.yml`. Por padrão, esta opção já vem ativada (`true`), mas você pode desativá-la com `-no-orphans`.
- **`q, --quiet`**
    - **Finalidade**: Suprime toda a saída, exceto os IDs numéricos dos contêineres. É extremamente útil para automação, permitindo que você passe os IDs diretamente para outros comandos do Docker.
    - **Exemplo de uso**: `docker stop $(docker compose ps -q)`
- **`-services`**
    - **Finalidade**: Em vez de listar os contêineres, esta opção lista apenas os **nomes dos serviços** definidos no seu arquivo `docker-compose.yml`.
- **`-status stringArray`**
    - **Finalidade**: Filtra os contêineres com base em um ou mais status específicos. É mais direto que a opção `-filter`.
    - **Valores possíveis**: `paused`, `restarting`, `removing`, `running`, `dead`, `created`, `exited`.
    - **Sintaxe**: Você pode repetir a flag para múltiplos status: `docker compose ps --status running --status paused`.

---

### Tabela Resumo

| Opção | Sintaxe Alternativa | Finalidade |
| --- | --- | --- |
| `--all` | `-a` | Mostra todos os contêineres, incluindo os parados. |
| `--dry-run` |  | Simula a execução do comando sem realizar a ação. |
| `--filter` |  | Filtra a saída com base em uma propriedade (`status`). Ex: `--filter status=running`. |
| `--format` |  | Formata a saída (padrão 'table', 'json', ou template customizado). |
| `--no-trunc` |  | Não encurta a saída, exibindo os valores completos. |
| `--orphans` |  | Inclui contêineres órfãos na listagem (padrão é `true`). Use `--no-orphans` para ocultar. |
| `--quiet` | `-q` | Exibe apenas os IDs numéricos dos contêineres. |
| `--services` |  | Lista os nomes dos serviços do projeto em vez dos contêineres. |
| `--status` |  | Filtra os contêineres por um ou mais status (`running`, `exited`, etc.). |

---

### Exemplos Práticos

Suponha um `docker-compose.yml` com os serviços `backend` e `database`.

1. **Listar apenas os contêineres em execução (comportamento padrão):**
    
    ```bash
    docker compose ps
    
    ```
    
2. **Listar todos os contêineres (incluindo os parados):**
    
    ```bash
    docker compose ps -a
    
    ```
    
3. **Listar apenas os contêineres do serviço `backend`:**
    
    ```bash
    docker compose ps backend
    
    ```
    
4. **Obter apenas os IDs dos contêineres que estão em execução para pará-los:**
    
    ```bash
    docker stop $(docker compose ps -q)
    
    ```
    
5. **Listar os contêineres que saíram com erro (`exited`) ou que estão pausados:**
    
    ```bash
    docker compose ps --status exited --status paused
    
    ```
    
6. **Verificar os nomes de todos os serviços definidos no projeto:**
    
    ```bash
    docker compose ps --services
    
    ```
    
7. **Exibir a lista em formato JSON para usar em um script:**
    
    ```bash
    docker compose ps --format json
    
    ```
    

Espero que esta explicação detalhada tenha esclarecido todas as suas dúvidas sobre o comando `docker compose ps`, Gedê!

Se precisar de mais alguma coisa, é só chamar.

Atenciosamente,
**A.R.I.A.**