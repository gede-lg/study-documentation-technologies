# Events

Aqui está uma explicação detalhada e organizada do comando `docker compose events`, cobrindo sintaxe, parâmetros, finalidades e exemplos de uso. Incluí uma tabela resumindo as opções para facilitar a visualização.

---

## 1. Visão Geral

O comando `docker compose events` faz parte da CLI do Docker Compose (v2+).

Ele permite **receber em tempo real** os eventos gerados pelos containers definidos no seu arquivo `docker-compose.yml`.

Isso é útil para monitorar atividades como criação, início, parada, remoção de containers, mudanças de saúde, e outros eventos relevantes.

---

## 2. Sintaxe Geral

```bash
docker compose events [OPÇÕES] [SERVIÇO...]

```

- `docker compose`
    
    Invoca o plugin do Docker Compose integrado à CLI principal do Docker.
    
- `events`
    
    Subcomando que inicia o streaming de eventos.
    
- `[OPÇÕES]`
    
    Flags que alteram o comportamento do comando.
    
- `[SERVIÇO...]` (opcional)
    
    Lista de serviços (nomes definidos em `docker-compose.yml`) para filtrar os eventos. Se omitido, recebe eventos de **todos** os containers gerenciados pelo Compose naquele diretório.
    

---

## 3. Opções Disponíveis

| Opção | Sintaxe curta | Descrição |
| --- | --- | --- |
| `--dry-run` | — | Simula a execução do comando, **sem** estabelecer stream real de eventos. |
| `--json` | — | Emite cada evento como um **objeto JSON** separado, facilitando consumo programático. |

> Observação: não há versões curtas (-d, -j) para essas opções; é preciso usar o nome completo.
> 

---

## 4. Detalhamento das Opções

### 4.1 `-dry-run`

- **Finalidade:**
    
    Verifica se o comando está correto e quais serviços seriam monitorados, sem, de fato, abrir a conexão de eventos.
    
- **Uso típico:**
    - Diagnóstico de configuração (ex.: quando há dúvida se o projeto Compose está correto).
    - Scripts que validam comandos antes de executá-los.
- **Comportamento:**
    
    Exibe apenas a linha de comando formatada ou uma mensagem indicando que entraria em “modo de execução simulada”.
    

```bash
docker compose events --dry-run web db
# → Simulação: monitorando eventos dos serviços "web" e "db"

```

### 4.2 `-json`

- **Finalidade:**
    
    Serializar cada evento como JSON, uma linha por evento, permitindo integração com ferramentas de processamento (ex.: `jq`, scripts em Python, sistemas de logging centralizado).
    
- **Uso típico:**
    - Coleta de métricas e logs em pipelines CI/CD.
    - Integração com sistemas de observabilidade (ELK, Prometheus via exportadores, etc.).
- **Formato de saída (exemplo):**

```json
{"status":"start","id":"a1b2c3d4e5","from":"nginx:latest","timestamp":"2025-06-10T12:34:56.789Z", ...}
{"status":"die","id":"a1b2c3d4e5","exitCode":0,"timestamp":"2025-06-10T12:35:10.123Z", ...}

```

---

## 5. Exemplos de Uso

1. **Monitorar todos os eventos** (modo interativo, texto legível):
    
    ```bash
    docker compose events
    
    ```
    
    Saída:
    
    ```
    web.1  start   Container web.1 started
    db.1   die     Container db.1 exited with code 0
    
    ```
    
2. **Apenas simular** (sem abrir streaming):
    
    ```bash
    docker compose events --dry-run
    
    ```
    
3. **Filtrar por serviços específicos**:
    
    ```bash
    docker compose events web api
    
    ```
    
4. **Em JSON para integração**:
    
    ```bash
    docker compose events --json
    
    ```
    
5. **Combinar filtro + JSON**:
    
    ```bash
    docker compose events --json api
    
    ```
    

---

## 6. Quando usar

- **Debug e troubleshooting**: entender em que ponto containers falham ou reiniciam.
- **Automação**: scripts que aguardam eventos específicos (por exemplo, aguardar o container do banco de dados ficar “healthy” antes de rodar migrações).
- **Observabilidade**: alimentar streams de log e dashboards em tempo real.

---

## 7. Resumo Rápido

| Item | Descrição breve |
| --- | --- |
| Comando base | `docker compose events` |
| Objetivo | Stream de eventos em tempo real de containers |
| Opções principais | `--dry-run`, `--json` |
| Filtragem | Lista de serviços como argumentos opcionais |
| Uso comum | Debug, Automação, Logging/Observability |

Com essa estrutura, você tem à mão todas as informações sobre sintaxe, opções e cenários de uso do `docker compose events`. Qualquer dúvida ou necessidade de exemplo adicional, é só falar!