# Scale

**Introdução**

O comando `docker compose scale` permite ajustar dinamicamente o número de réplicas (containers) de um ou mais serviços definidos em um arquivo Compose. É útil para aumentar ou reduzir a capacidade de processamento de partes específicas da aplicação sem precisar recriar todo o ambiente. ([manpages.debian.org](https://manpages.debian.org/testing/docker-compose/docker-compose-scale.1))

---

## 1. Sintaxe Geral

```
docker compose scale [SERVIÇO=RÉPLICAS...]

```

- **SERVIÇO**: nome do serviço conforme declarado em `docker-compose.yml`.
- **RÉPLICAS**: quantidade desejada de instâncias para esse serviço.
- Para múltiplos serviços, separe por espaço:
    
    ```
    docker compose scale web=3 api=2 db=1
    ``` :contentReference[oaicite:1]{index=1}
    
    ```
    

---

## 2. Parâmetro Posicional

| Parâmetro | Sintaxe | Descrição |
| --- | --- | --- |
| Serviço e réplicas | `SERVIÇO=RÉPLICAS` | Define quantas réplicas do serviço `SERVIÇO` devem estar em execução. |
| Exemplo | `web=4` | Escala o serviço `web` para 4 containers. |

*Se omitido, o comando não fará nada (é necessário pelo menos um par `SERVIÇO=RÉPLICAS`).* ([manpages.debian.org](https://manpages.debian.org/testing/docker-compose/docker-compose-scale.1))

---

## 3. Opções Disponíveis

| Opção | Sintaxe | Finalidade | Padrão |
| --- | --- | --- | --- |
| Ajuda | `-h`, `--help` | Exibe a ajuda específica do subcomando `scale`. | falso |
| Modo “dry run” | `--dry-run` | Mostra quais ações seriam executadas, sem realmente alterá-las (herdada de comandos pai). | falso |
| Sem dependências | `--no-deps` | Não inicia serviços dos quais o `SERVIÇO` depende; escala apenas o(s) serviço(s) especificado(s). | falso |
- **`-dry-run`**: simula a operação, exibindo os passos que seriam tomados, mas sem criar, destruir ou alterar containers. ([manpages.debian.org](https://manpages.debian.org/testing/docker-compose/docker-compose-scale.1))
- **`-no-deps`**: ao escalar um serviço, impede que o Docker Compose também suba containers de serviços vinculados (graphic dependencies). ([manpages.debian.org](https://manpages.debian.org/testing/docker-compose/docker-compose-scale.1))

---

## 4. Exemplos de Uso

1. **Escalar um único serviço**
    
    ```bash
    docker compose scale web=5
    
    ```
    
    Sobe ou remove containers para que o serviço `web` tenha exatamente 5 réplicas.
    
2. **Escalar múltiplos serviços de uma vez**
    
    ```bash
    docker compose scale web=3 api=2 db=1
    
    ```
    
    Garante que `web` rode com 3 instâncias, `api` com 2 e `db` com 1.
    
3. **Testar sem aplicar mudanças**
    
    ```bash
    docker compose scale --dry-run worker=10
    
    ```
    
    Mostra o que aconteceria para escalar `worker` a 10 réplicas, sem efetivar a operação.
    
4. **Escalar sem subir dependências**
    
    ```bash
    docker compose scale --no-deps cache=4
    
    ```
    
    Ajusta apenas o número de containers do serviço `cache`, sem iniciar serviços que ele vincula.
    

---

> Observação:
> 
> - Se o Compose estiver rodando em modo Swarm (modo cluster), o comando equivalente para serviços Swarm é `docker service scale`.
> - Com as versões mais recentes do Docker Compose, a prática recomendada é usar `docker compose up --scale`, mas o subcomando `scale` ainda é suportado para compatibilidade.

Espero que esta explicação tenha deixado claro como usar cada parte do comando `docker compose scale`. Qualquer dúvida ou necessidade de exemplos adicionais, estou à disposição!