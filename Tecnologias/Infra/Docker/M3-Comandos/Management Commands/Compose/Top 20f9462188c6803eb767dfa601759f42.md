# Top

**Explicação Estruturada do Comando `docker compose top`**

---

## 1. Introdução

O comando `docker compose top` permite visualizar, de forma agregada, os processos em execução dentro de cada contêiner orquestrado pelo Docker Compose. Por baixo dos panos, ele executa `docker top <container>` para cada contêiner pertencente ao(s) serviço(s) especificado(s), exibindo quais processos estão rodando.

---

## 2. Sintaxe Geral

```bash
docker compose top [SERVICES...] [OPTIONS]

```

- **`docker compose`**
    
    Invoca o Docker Compose (v2 ou superior), que utiliza o mesmo binário do Docker CLI.
    
- **`top`**
    
    Subcomando responsável por listar processos em execução nos contêineres.
    
- **`[SERVICES...]`**
    
    Lista opcional de nomes de serviços definidos no arquivo `docker-compose.yml`. Se omitida, serão incluídos todos os serviços do projeto.
    
- **`[OPTIONS]`**
    
    Parâmetros adicionais que alteram o comportamento do comando (detalhados a seguir).
    

---

## 3. Parâmetros e Opções

| Parâmetro | Sintaxe | Finalidade |
| --- | --- | --- |
| `SERVICES...` | `nome1 nome2 ...` | Especifica um ou mais serviços (conforme definidos no Compose).- **Sem serviços:** exibe todos. |
| `--dry-run` | `--dry-run` | Emula a execução, mostrando quais comandos internos seriam disparados (`docker top ...`), **sem** executá-los efetivamente. |

> ⚠️ Observação: existem outras opções globais do Docker Compose (por exemplo -f para especificar um arquivo de configuração), mas aqui focamos apenas nas opções listadas pelo --help do docker compose top.
> 

---

## 4. Exemplos de Uso

1. **Listar todos os processos de todos os serviços**
    
    ```bash
    docker compose top
    
    ```
    
    *Saída:* Para cada contêiner de cada serviço, exibe colunas como PID, usuário, tempo de CPU, comando, etc.
    
2. **Listar processos de serviços específicos**
    
    ```bash
    docker compose top web db
    
    ```
    
    *Saída:* Apenas para os serviços `web` e `db`.
    
3. **Simular sem executar**
    
    ```bash
    docker compose top --dry-run
    
    ```
    
    *Saída:*
    
    ```
    docker top meu_projeto_web_1
    docker top meu_projeto_db_1
    
    ```
    
    — mostra os comandos que seriam executados, sem listar processos de fato.
    
4. **Combinação de serviços e simulação**
    
    ```bash
    docker compose top cache --dry-run
    
    ```
    
    — exibe apenas a simulação do comando interno para o serviço `cache`.
    

---

## 5. Fluxo de Funcionamento

1. **Resolução de Serviços**
    - Identifica todos os contêineres ativos associados aos serviços informados (ou a todos, se não houver filtros).
2. **Emissão de comandos internos**
    - Para cada contêiner, executa `docker top <container_id>` (lista os processos).
3. **Coleta e exibição**
    - Agrega as saídas em formato tabular, com colunas como:
        - **PID**: identificador do processo dentro do contêiner.
        - **USER**: usuário que iniciou o processo.
        - **TIME**: tempo de CPU utilizado.
        - **COMMAND**: comando/processo em execução.

---

## 6. Quando Utilizar?

- **Diagnóstico rápido** de consumo de recursos em contêineres.
- **Verificação** de processos específicos (por exemplo, conferindo se o servidor web ou worker está ativo).
- **Automação** e depuração de scripts que interajam com estados de contêineres.

---

## 7. Dicas Adicionais

- Combine com `docker compose ps` para ver status geral antes de listar processos.
- Use `f` ou `-file` se o seu `docker-compose.yml` tiver nome ou caminho diferente.
- Em scripts, o `-dry-run` pode ajudar a validar quais contêineres seriam inspecionados sem alterar estado.

---

Com esta estrutura, você tem **visão**, **sintaxe**, **parâmetros**, **tabela**, **exemplos** e **contexto de uso** para usar o `docker compose top` de forma eficaz.