# Use

Segue uma explicação estruturada de cada parte do comando `docker buildx use` (note que, internamente, o alias `docker builder use` chama o mesmo subcomando do Buildx):

---

## 1. Objetivo do Comando

**`docker buildx use`** define qual instância de *builder* o Docker Buildx deve usar por padrão nas próximas operações de build.

O Buildx é a extensão avançada do `docker build` que permite:

- **Builders remotos** (por exemplo, BuildKit em outros hosts ou em cluster).
- **Builds multi-plataforma** (cross-compile para várias arquiteturas).
- **Cache distribuído** e **drivers customizados**.

---

## 2. Sintaxe Geral

```bash
docker buildx use [OPÇÕES] NOME

```

| Elemento | Descrição |
| --- | --- |
| `NOME` | Nome (ou ID) da instância de builder registrada (`docker buildx ls` lista as disponíveis). |

---

## 3. Opções do Comando

| Opção | Sintaxe | Finalidade | Padrão |
| --- | --- | --- | --- |
| `--builder` | `--builder <string>` | Sobrescreve o builder configurado, apontando para outra instância registrada. | `"default"` |
| `-D`, `--debug` | `-D`, `--debug` | Exibe logs detalhados (modo debug) durante o processamento do comando, útil para diagnosticar erros de configuração. | desativado |
| `--default` | `--default` | Marca a instância selecionada como *default* **no contexto atual** do Docker (sem afetar outros contextos). | false |
| `--global` | `--global` | Persiste a mudança de builder **em todos** os contextos Docker, tornando-a a escolha padrão globalmente. | false |

### Descrição detalhada

- **`-builder <string>`**
    
    Recebe como argumento o nome (ou ID) do builder que você deseja usar.
    
    ```bash
    docker buildx use --builder minha-instancia
    
    ```
    
    Substitui temporariamente o builder ativo, sem alterar as configurações de *default* ou *global*.
    
- **`D, --debug`**
    
    Ativa **debug logging**, mostrando etapas internas do Buildx e possíveis mensagens de erro detalhadas
    
    ```bash
    docker buildx use --debug minha-instancia
    
    ```
    
- **`-default`**
    
    Faz com que o builder escolhido seja salvo como *default* **no contexto Docker atual** (ver `docker context ls`).
    
    ```bash
    docker buildx use --default minha-instancia
    
    ```
    
- **`-global`**
    
    Aplica a mudança de builder **em todos os contextos** do Docker (inclusive futuros), sem necessidade de repetir o comando em cada contexto.
    
    ```bash
    docker buildx use --global minha-instancia
    
    ```
    

---

## 4. Experimentalidade

Por padrão, flags e comandos experimentais do Buildx ficam ocultos. Para exibi-los:

```bash
export BUILDX_EXPERIMENTAL=1
docker buildx use --help

```

Isso ativa todos os recursos marcados como experimentais em sua instalação.

---

## 5. Exemplos de Uso

1. **Trocar para o builder chamado `ci-builder`**
    
    ```bash
    docker buildx use ci-builder
    
    ```
    
2. **Definir `ci-builder` como *default* no contexto atual**
    
    ```bash
    docker buildx use --default ci-builder
    
    ```
    
3. **Ativar debug e usar `ci-builder` globalmente**
    
    ```bash
    docker buildx use --debug --global ci-builder
    
    ```
    

---

### Dica

Para ver todas as instâncias registradas e seus estados:

```bash
docker buildx ls

```

Assim você confirma o `NAME` exato a ser usado.

---

Com isso, você tem uma visão completa da sintaxe, finalidade e aplicações de cada parâmetro do comando `docker buildx use`.