# Generate

A seguir, uma visão completa e estruturada do comando **`docker trust key generate`**, cobrindo sua sintaxe, parâmetros, opções, finalidade e exemplos de uso.

---

## 1. O que faz este comando

O **`docker trust key generate`** faz parte do subsistema de Trust do Docker (baseado no Notary) e serve para:

- **Gerar** um par de chaves assimétricas (private/public) que serão usadas para assinar imagens Docker.
- **Carregar** a chave recém-gerada na store local de chaves de confiança, permitindo que você a utilize imediatamente para assinar (push) ou verificar (pull) imagens.

Esse mecanismo é a base do **Docker Content Trust**, que garante a integridade e autoria das imagens.

---

## 2. Sintaxe geral

```bash
docker trust key generate [OPTIONS] NAME

```

- **`docker trust key`**: namespace de gerenciamento de chaves de assinatura.
- **`generate`**: action que cria o par de chaves e o carrega.
- **`[OPTIONS]`**: flags que alteram o comportamento padrão.
- **`NAME`**: nome identificador da chave a ser criada.

---

## 3. Parâmetros

| Parâmetro | Obrigatório | Descrição |
| --- | --- | --- |
| `NAME` | Sim | **Nome da chave** a ser gerada. Geralmente é o seu usuário ou um identificador do repositório (ex.: `alice`, `myrepo`). Esse nome será usado depois ao assinar imagens. |

---

## 4. Opções disponíveis

| Opção | Tipo | Padrão | Finalidade |
| --- | --- | --- | --- |
| `--dir string` | string | diretório atual (.) | Define **onde** os arquivos de chave serão gravados. Se não informado, o Docker criará a chave no diretório de trabalho corrente. |

> Observação: você pode especificar um caminho absoluto (ex.: --dir ~/.docker/trust) ou relativo (ex.: --dir keys/).
> 

---

## 5. Fluxo de funcionamento

1. **Validação de parâmetros**
    - Verifica se `NAME` foi fornecido; caso contrário, exibe a ajuda do comando.
2. **Geração do par de chaves**
    - Cria dois arquivos dentro de `-dir`:
        - `NAME.key`: *private key* (criptografada localmente).
        - `NAME.pub`: *public key* (para compartilhar e verificar assinaturas).
3. **Carregamento na store**
    - Atualiza o arquivo de configuração de trust (geralmente em `~/.docker/trust/tuf/`) para incluir a nova chave como um “root” ó “repository key”.
4. **Pronto para uso**
    - Você já pode usar, por exemplo:
        
        ```bash
        docker trust sign --key NAME.key myrepo:latest
        
        ```
        

---

## 6. Exemplos de uso

1. **Gerar chave “alice” no diretório atual**
    
    ```bash
    docker trust key generate alice
    # Cria alice.key e alice.pub em .
    
    ```
    
2. **Gerar chave “repo-key” em um diretório específico**
    
    ```bash
    docker trust key generate --dir ~/.docker/trust repo-key
    # Cria:
    #   ~/.docker/trust/repo-key.key
    #   ~/.docker/trust/repo-key.pub
    
    ```
    
3. **Fluxo típico para assinar uma imagem**
    
    ```bash
    # 1. Gera a chave
    docker trust key generate alice
    
    # 2. Configura o trust para o repositório
    docker trust signer add --key alice.pub alice myrepo
    
    # 3. Assina a imagem
    docker trust sign myrepo:1.0
    
    ```
    

---

## 7. Tabela de referência rápida

| Componente | Sintaxe | Descrição |
| --- | --- | --- |
| Comando base | `docker trust key generate` | Gera e carrega par de chaves para Docker Content Trust. |
| Argumento obrigatório | `NAME` | Identificador que você escolhe para a chave (ex.: usuário ou repositório). |
| Opção | `--dir <diretório>` | Define onde os arquivos `.key` e `.pub` serão criados; padrão é `.`. |

---

Com isso, você tem tudo o que precisa para entender, ajustar e usar o **`docker trust key generate`** em seus fluxos de segurança de imagens Docker. Qualquer dúvida ou necessidade de exemplos adicionais, é só avisar!