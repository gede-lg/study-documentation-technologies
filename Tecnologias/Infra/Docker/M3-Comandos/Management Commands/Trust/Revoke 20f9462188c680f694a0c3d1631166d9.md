# Revoke

A seguir, uma explicação completa e estruturada do comando **`docker trust revoke`**, cobrindo sua finalidade, sintaxe, parâmetros, opções, fluxo de funcionamento e exemplos de uso.

---

## 1. O que faz este comando

O **`docker trust revoke`** remove a confiança (Trust data) de uma imagem Docker específica dentro do esquema de Content Trust. Em outras palavras, ele **revoga** as assinaturas existentes daquela imagem, tornando-a não confiável para pull/verificação até que seja assinada novamente.

---

## 2. Sintaxe geral

```bash
docker trust revoke [OPTIONS] IMAGE[:TAG]

```

- **`IMAGE[:TAG]`**: Repositório e tag da imagem cuja confiança será removida.

---

## 3. Parâmetros

| Parâmetro | Obrigatório | Descrição |
| --- | --- | --- |
| `IMAGE[:TAG]` | Sim | Nome do repositório e tag da imagem (ex.: `minharepo:1.0` ou apenas `minharepo` para todas as tags). |

---

## 4. Opções disponíveis

| Opção | Tipo | Padrão | Finalidade |
| --- | --- | --- | --- |
| `-y`, `--yes` | boolean | `false` | Não solicitar confirmação interativa antes de remover a confiança da imagem. Útil em scripts. |

---

## 5. Fluxo de funcionamento

1. **Validação de parâmetros**
    - Garante que `IMAGE[:TAG]` foi informado; caso contrário, exibe a ajuda.
2. **Confirmação (salvo se `-yes`)**
    - Por padrão, pergunta:
        
        ```
        Are you sure you want to revoke trust for "minharepo:1.0"? [y/N]
        
        ```
        
3. **Atualização do metadata de Trust**
    - Remove a referência à assinatura daquela tag no metadata local (`~/.docker/trust/tuf/`).
4. **Sincronização com o Notary Server**
    - Na próxima operação de push ou inspect, esse estado de “sem confiança” será refletido no servidor.
5. **Estado após revogação**
    - Tentativas de `docker pull --disable-content-trust=false` ou `docker trust inspect` mostrarão que a imagem não possui mais assinatura válida.

---

## 6. Exemplos de uso

1. **Revogar confiança de `minharepo:1.0` com confirmação**
    
    ```bash
    docker trust revoke minharepo:1.0
    # Prompt:
    #   Are you sure you want to revoke trust for "minharepo:1.0"? [y/N]
    # Responda 'y' para confirmar.
    
    ```
    
2. **Revogar sem prompt de confirmação**
    
    ```bash
    docker trust revoke --yes meuapp:latest
    # Remove imediatamente a assinatura de “meuapp:latest” sem solicitar confirmação.
    
    ```
    
3. **Revogar todas as tags de um repositório**
    
    ```bash
    # Para remover confiança de todas as tags, basta omitir a tag:
    docker trust revoke --yes minharepo
    # Isso revoga as assinaturas de todas as tags conhecidas no metadata.
    
    ```
    

---

## 7. Tabela de referência rápida

| Componente | Sintaxe | Descrição |
| --- | --- | --- |
| Comando base | `docker trust revoke` | Revoga (remove) a confiança de uma imagem Docker assinada. |
| Parâmetro | `IMAGE[:TAG]` | Imagem (com tag opcional) cuja assinatura será removida. |
| Opção | `-y`, `--yes` | Executa sem solicitar confirmação interativa. |

---

Com essas informações, você está pronto para revogar assinaturas de imagens Docker quando necessário, garantindo controle fino sobre quais versões são consideradas confiáveis no seu ambiente. Qualquer dúvida, estou à disposição!