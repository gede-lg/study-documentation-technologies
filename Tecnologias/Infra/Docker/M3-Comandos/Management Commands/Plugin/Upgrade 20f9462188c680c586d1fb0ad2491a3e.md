# Upgrade

## Visão Geral

O comando `docker plugin upgrade` atualiza um plugin existente para uma nova versão de imagem. Se nenhum repositório remoto (`REMOTE`) for especificado, o Docker irá refazer o pull da imagem atual e aplicar a atualização automaticamente. Antes de executar o upgrade, **o plugin deve estar desativado**. ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/upgrade/?utm_source=chatgpt.com))

---

## Sintaxe

```bash
docker plugin upgrade [OPÇÕES] PLUGIN [REMOTE]

```

- **PLUGIN**: nome (e opcionalmente tag) do plugin instalado a ser atualizado.
- **REMOTE** (opcional): referência de imagem remota para usar no upgrade (ex.: `meussh/volume-plugin:v2`). Se omitido, o Docker repuxa a imagem atual. ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/upgrade/?utm_source=chatgpt.com))

---

## Parâmetros

| Parâmetro | Descrição |
| --- | --- |
| `PLUGIN` | Identificador do plugin a ser atualizado (por ex., `vieux/sshfs:latest`). |
| `REMOTE` | Referência de uma imagem alternativa para atualizar o plugin (por ex., incluir nova tag ou digest). |

---

## Opções

| Opção | Descrição |
| --- | --- |
| `--disable-content-trust` | **Skip image verification** durante o pull da nova versão (padrão: true). ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/upgrade/?utm_source=chatgpt.com)) |
| `--grant-all-permissions` | **Concede automaticamente** todas as permissões necessárias para executar o plugin atualizado. ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/upgrade/?utm_source=chatgpt.com)) |
| `--skip-remote-check` | **Não verifica** se a imagem remota coincide com a versão local antes de fazer o pull. ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/upgrade/?utm_source=chatgpt.com)) |

---

## Exemplos de Uso

1. **Upgrade repuxando a imagem atual**
    
    ```bash
    docker plugin disable meussh/volume-plugin:latest
    docker plugin upgrade meussh/volume-plugin:latest
    docker plugin enable meussh/volume-plugin:latest
    
    ```
    
    Desativa, atualiza para a última versão disponível e reativa o plugin.
    
2. **Upgrade para uma tag específica**
    
    ```bash
    docker plugin disable traefik:2.9
    docker plugin upgrade traefik:2.9 traefik:2.10
    docker plugin enable traefik:2.10
    
    ```
    
    Atualiza `traefik` da tag `2.9` para `2.10`.
    
3. **Upgrade ignorando verificação de assinatura**
    
    ```bash
    docker plugin disable secure-plugin:stable
    docker plugin upgrade --disable-content-trust secure-plugin:stable secure-plugin:beta
    docker plugin enable secure-plugin:beta
    
    ```
    
    Útil para registries com certificados não confiáveis.
    
4. **Upgrade sem checar compatibilidade remota**
    
    ```bash
    docker plugin disable custom-net-plugin
    docker plugin upgrade --skip-remote-check custom-net-plugin custom-net-plugin:2.0
    docker plugin enable custom-net-plugin:2.0
    
    ```
    
    Força o pull mesmo que o Docker não reconheça mudanças no digest.
    

---

> Dica: Sempre verifique o estado dos plugins antes e depois com:
> 
> 
> ```bash
> docker plugin ls
> docker plugin inspect <PLUGIN>
> 
> ```
> 
> para garantir que a atualização ocorreu conforme esperado.
>