# Create

## Visão Geral

O comando `docker plugin create` constrói um plugin Docker a partir de um diretório de dados que contenha:

1. Um arquivo `config.json` com a configuração do plugin.
2. Um subdiretório `rootfs/` com o sistema de arquivos raiz do plugin.

Após criado, o plugin aparece em `docker plugin ls` e pode ser habilitado com `docker plugin enable` ou publicado em um registry. ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/create/?utm_source=chatgpt.com))

---

## Sintaxe

```bash
docker plugin create [OPÇÕES] PLUGIN PLUGIN-DATA-DIR

```

- **PLUGIN**
    
    Nome (e opcionalmente tag) que será atribuído ao plugin (ex.: `meussh/volume-plugin:latest`).
    
- **PLUGIN-DATA-DIR**
    
    Caminho para o diretório que deve conter **obrigatoriamente**:
    
    - `config.json`
    - `rootfs/`

---

## Descrição

1. **Preparação do diretório**
    - Crie um diretório (por ex., `/home/meu-plugin/`).
    - Dentro dele, coloque o `config.json` com a especificação do plugin (nome, interfaces, mounts, etc.).
    - Adicione `rootfs/` contendo o binário e bibliotecas que o plugin irá executar.
2. **Criação do plugin**
    - O Docker empacota todo o conteúdo de `PLUGIN-DATA-DIR` e gera internamente um artefato de plugin.
3. **Pós-criação**
    - O comando retorna o nome do plugin criado.
    - Você pode listar com `docker plugin ls` e habilitar com `docker plugin enable <PLUGIN>`. ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/create/?utm_source=chatgpt.com))

---

## Opções

| Opção | Descrição |
| --- | --- |
| `--compress` | Compacta (gzip) o contexto antes de enviar ao daemon, reduzindo o tamanho do upload. |

---

## Exemplos de Uso

1. **Estrutura do diretório**
    
    ```bash
    $ ls -l /home/pluginData
    total 4
    -rw-r--r-- 1 root root 500 Mar 10 12:00 config.json
    drwxr-xr-x 2 root root   6 Mar 10 12:00 rootfs
    
    ```
    
2. **Criar o plugin sem compressão**
    
    ```bash
    docker plugin create meussh/volume-plugin:latest /home/pluginData
    
    ```
    
    Retorno:
    
    ```
    meussh/volume-plugin:latest
    ``` :contentReference[oaicite:2]{index=2}
    
    ```
    
3. **Criar o plugin com compressão**
    
    ```bash
    docker plugin create --compress meussh/volume-plugin:latest /home/pluginData
    
    ```
    
    Usa gzip para reduzir banda e tempo de upload. ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/create/?utm_source=chatgpt.com))
    
4. **Listar e habilitar o plugin**
    
    ```bash
    docker plugin ls
    # Exibe o plugin criado (ENABLED=false)
    docker plugin enable meussh/volume-plugin:latest
    
    ```
    
    Agora o plugin estará ativo e pronto para uso. ([docs.docker.com](https://docs.docker.com/reference/cli/docker/plugin/create/?utm_source=chatgpt.com))
    

---

> Dica:
> 
> - Sempre valide seu `config.json` antes de criar o plugin.
> - Use `docker plugin inspect <PLUGIN>` para revisar metadados e confirmar que `rootfs` foi corretamente empacotado.