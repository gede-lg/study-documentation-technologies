# React Router Hooks

## üéØ Introdu√ß√£o e Defini√ß√£o

### Defini√ß√£o Conceitual

**React Router Hooks** s√£o hooks especializados que fornecem acesso a **informa√ß√µes de rota** e **controle de navega√ß√£o** dentro de componentes funcionais. Os principais s√£o: **useParams** (ler par√¢metros din√¢micos), **useNavigate** (navega√ß√£o program√°tica), **useLocation** (estado da rota atual), e **useSearchParams** (query parameters). Representam interface **imperativa** complementar ao roteamento declarativo (`<Link>`).

Esses hooks transformam componentes de "p√°ginas passivas" em **atores ativos** que reagem a mudan√ßas de rota, extraem dados da URL, navegam programaticamente ap√≥s a√ß√µes (submit, logout), e passam estado entre rotas. S√£o ponte entre **URL** (state global) e **componente** (state local).

**Filosofia:** "Rotas s√£o state, hooks s√£o getters/setters." URL √© source of truth compartilhada - hooks permitem **ler** (`useParams`, `useLocation`) e **escrever** (`useNavigate`, `useSearchParams`) esse state de forma idiom√°tica.

### Import√¢ncia no Ecossistema

React Router Hooks s√£o **essenciais** para:

- **Rotas din√¢micas**: Carregar dados baseado em `:id`
- **Navega√ß√£o p√≥s-a√ß√£o**: Redirect ap√≥s login/submit
- **Query params**: Filtros, pagina√ß√£o, busca
- **State entre rotas**: Passar dados sem props drilling

**Contexto:** Hooks foram adicionados em React Router v5.1, mas **v6 reimaginou** API (removeu `useHistory` ‚Üí `useNavigate`). Hoje s√£o interface **prim√°ria** para interagir com router.

---

## üìã Sum√°rio Conceitual

### Hooks Cobertos

1. **useParams**: Par√¢metros din√¢micos de rota
2. **useNavigate**: Navega√ß√£o program√°tica
3. **useLocation**: Informa√ß√µes da rota atual
4. **useSearchParams**: Query parameters (search params)

---

## üîç Fundamentos Te√≥ricos

### Params vs Search Params

**Params (Path params):**
```
URL: /products/123/reviews/456
Params: { productId: '123', reviewId: '456' }
```

**Search params (Query params):**
```
URL: /products?category=electronics&page=2
Search params: { category: 'electronics', page: '2' }
```

### Navega√ß√£o Declarativa vs Imperativa

**Declarativa (Link):**
```javascript
<Link to="/about">About</Link>
// Usu√°rio clica, navega
```

**Imperativa (useNavigate):**
```javascript
const navigate = useNavigate();
// Ap√≥s a√ß√£o ass√≠ncrona
await saveData();
navigate('/success');
```

---

## üîç An√°lise Conceitual Profunda

### 11.2.1 useParams - Par√¢metros Din√¢micos

**Definir rota com params:**
```javascript
<Routes>
  <Route path="/products/:id" element={<ProductDetail />} />
</Routes>
```

**Ler params:**
```javascript
import { useParams } from 'react-router-dom';

function ProductDetail() {
  const { id } = useParams();

  return <div>Product ID: {id}</div>;
}

// URL: /products/123
// id = "123"
```

**‚ö†Ô∏è Params sempre retornam strings:**
```javascript
function ProductDetail() {
  const { id } = useParams();

  console.log(typeof id); // "string"
  console.log(id); // "123"

  // Converter para n√∫mero se necess√°rio
  const numericId = Number(id);
}
```

**M√∫ltiplos params:**
```javascript
<Routes>
  <Route path="/users/:userId/posts/:postId" element={<Post />} />
</Routes>

function Post() {
  const { userId, postId } = useParams();

  return (
    <div>
      User {userId}, Post {postId}
    </div>
  );
}

// URL: /users/42/posts/789
// userId = "42", postId = "789"
```

**Exemplo: Fetch baseado em param:**
```javascript
import { useParams } from 'react-router-dom';
import { useState, useEffect } from 'react';

function ProductDetail() {
  const { id } = useParams();
  const [product, setProduct] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchProduct = async () => {
      setLoading(true);
      try {
        const response = await fetch(`/api/products/${id}`);
        const data = await response.json();
        setProduct(data);
      } catch (error) {
        console.error('Error fetching product:', error);
      } finally {
        setLoading(false);
      }
    };

    fetchProduct();
  }, [id]); // Re-fetch quando id mudar

  if (loading) return <div>Loading...</div>;
  if (!product) return <div>Product not found</div>;

  return (
    <div>
      <h1>{product.name}</h1>
      <p>{product.description}</p>
      <p>Price: ${product.price}</p>
    </div>
  );
}
```

**Optional params (com ?):**
```javascript
<Routes>
  <Route path="/products/:id/:variant?" element={<ProductDetail />} />
</Routes>

function ProductDetail() {
  const { id, variant } = useParams();

  return (
    <div>
      Product {id}
      {variant && <p>Variant: {variant}</p>}
    </div>
  );
}

// /products/123 ‚Üí id="123", variant=undefined
// /products/123/blue ‚Üí id="123", variant="blue"
```

### 11.2.2 useNavigate - Navega√ß√£o Program√°tica

**Navega√ß√£o b√°sica:**
```javascript
import { useNavigate } from 'react-router-dom';

function LoginForm() {
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();

    const success = await login();

    if (success) {
      navigate('/dashboard'); // Navega para /dashboard
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      {/* ... */}
    </form>
  );
}
```

**Navigate com replace (n√£o adiciona no hist√≥rico):**
```javascript
navigate('/dashboard', { replace: true });
// Usu√°rio n√£o pode voltar com back button
// √ötil para redirects p√≥s-login
```

**Navigate relativo:**
```javascript
// Rota atual: /products/123

navigate('reviews'); // ‚Üí /products/123/reviews
navigate('../456'); // ‚Üí /products/456
navigate('.'); // ‚Üí /products/123 (mesma rota)
```

**Navigate para tr√°s/frente:**
```javascript
const navigate = useNavigate();

// Voltar 1 p√°gina
navigate(-1);

// Voltar 2 p√°ginas
navigate(-2);

// Avan√ßar 1 p√°gina
navigate(1);
```

**Navigate com state:**
```javascript
function ProductList() {
  const navigate = useNavigate();

  const handleClick = (product) => {
    navigate('/product/123', {
      state: { from: 'list', product }
    });
  };

  return (
    <button onClick={() => handleClick(productData)}>
      View Product
    </button>
  );
}

// Rota de destino
function ProductDetail() {
  const location = useLocation();
  const { from, product } = location.state || {};

  console.log(from); // "list"
  console.log(product); // { name: "...", ... }
}
```

**Exemplo completo: Form submit ‚Üí Navigate:**
```javascript
import { useNavigate } from 'react-router-dom';
import { useState } from 'react';

function CreateProduct() {
  const navigate = useNavigate();
  const [formData, setFormData] = useState({ name: '', price: '' });
  const [error, setError] = useState('');

  const handleSubmit = async (e) => {
    e.preventDefault();

    try {
      const response = await fetch('/api/products', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      });

      if (!response.ok) throw new Error('Failed to create');

      const newProduct = await response.json();

      // Navegar para produto criado, passando state
      navigate(`/products/${newProduct.id}`, {
        state: { message: 'Product created successfully!' }
      });
    } catch (err) {
      setError(err.message);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        value={formData.name}
        onChange={(e) => setFormData({ ...formData, name: e.target.value })}
        placeholder="Product name"
      />
      <input
        value={formData.price}
        onChange={(e) => setFormData({ ...formData, price: e.target.value })}
        placeholder="Price"
        type="number"
      />
      {error && <p style={{ color: 'red' }}>{error}</p>}
      <button type="submit">Create</button>
    </form>
  );
}
```

### 11.2.3 useLocation - Informa√ß√µes da Rota

**Ler informa√ß√µes da rota:**
```javascript
import { useLocation } from 'react-router-dom';

function MyComponent() {
  const location = useLocation();

  console.log(location.pathname); // "/products/123"
  console.log(location.search); // "?category=electronics&page=2"
  console.log(location.hash); // "#reviews"
  console.log(location.state); // State passado via navigate()
  console.log(location.key); // Unique key da location

  return <div>Current path: {location.pathname}</div>;
}
```

**Exemplo: Highlight nav based on location:**
```javascript
import { useLocation, Link } from 'react-router-dom';

function Navigation() {
  const location = useLocation();

  const isActive = (path) => location.pathname === path;

  return (
    <nav>
      <Link
        to="/"
        style={{ color: isActive('/') ? 'red' : 'black' }}
      >
        Home
      </Link>
      <Link
        to="/about"
        style={{ color: isActive('/about') ? 'red' : 'black' }}
      >
        About
      </Link>
    </nav>
  );
}
// Nota: NavLink faz isso automaticamente (melhor op√ß√£o)
```

**Ler state passado via navigate:**
```javascript
// Origem
navigate('/success', { state: { message: 'Payment successful!' } });

// Destino
function Success() {
  const location = useLocation();
  const { message } = location.state || {};

  return (
    <div>
      {message && <p>{message}</p>}
    </div>
  );
}
```

**Tracking de p√°ginas (Analytics):**
```javascript
import { useLocation } from 'react-router-dom';
import { useEffect } from 'react';

function App() {
  const location = useLocation();

  useEffect(() => {
    // Track page view
    gtag('event', 'page_view', {
      page_path: location.pathname + location.search
    });
  }, [location]);

  return (
    <Routes>
      {/* ... */}
    </Routes>
  );
}
```

**Scroll to top ao mudar rota:**
```javascript
import { useLocation } from 'react-router-dom';
import { useEffect } from 'react';

function ScrollToTop() {
  const { pathname } = useLocation();

  useEffect(() => {
    window.scrollTo(0, 0);
  }, [pathname]);

  return null;
}

// Uso
function App() {
  return (
    <>
      <ScrollToTop />
      <Routes>
        {/* ... */}
      </Routes>
    </>
  );
}
```

### 11.2.4 useSearchParams - Query Parameters

**Ler search params:**
```javascript
import { useSearchParams } from 'react-router-dom';

function ProductList() {
  const [searchParams] = useSearchParams();

  const category = searchParams.get('category');
  const page = searchParams.get('page');
  const sort = searchParams.get('sort');

  return (
    <div>
      Category: {category || 'all'}
      Page: {page || '1'}
      Sort: {sort || 'name'}
    </div>
  );
}

// URL: /products?category=electronics&page=2&sort=price
// category = "electronics"
// page = "2"
// sort = "price"
```

**Escrever search params:**
```javascript
function ProductList() {
  const [searchParams, setSearchParams] = useSearchParams();

  const handleCategoryChange = (newCategory) => {
    setSearchParams({ category: newCategory, page: '1' });
    // URL muda para: /products?category=newCategory&page=1
  };

  return (
    <div>
      <button onClick={() => handleCategoryChange('electronics')}>
        Electronics
      </button>
      <button onClick={() => handleCategoryChange('books')}>
        Books
      </button>
    </div>
  );
}
```

**Atualizar param preservando outros:**
```javascript
function Pagination() {
  const [searchParams, setSearchParams] = useSearchParams();

  const currentPage = parseInt(searchParams.get('page') || '1');

  const handleNextPage = () => {
    // Preserva outros params (category, sort, etc.)
    setSearchParams(prev => {
      prev.set('page', String(currentPage + 1));
      return prev;
    });
  };

  return (
    <div>
      <p>Page {currentPage}</p>
      <button onClick={handleNextPage}>Next</button>
    </div>
  );
}
```

**Remover param:**
```javascript
const handleClearFilter = () => {
  setSearchParams(prev => {
    prev.delete('category');
    return prev;
  });
};
```

**Exemplo completo: Filtros com search params:**
```javascript
import { useSearchParams } from 'react-router-dom';
import { useState, useEffect } from 'react';

function ProductList() {
  const [searchParams, setSearchParams] = useSearchParams();
  const [products, setProducts] = useState([]);

  // Ler params
  const category = searchParams.get('category') || '';
  const minPrice = searchParams.get('minPrice') || '';
  const page = parseInt(searchParams.get('page') || '1');

  // Fetch baseado em params
  useEffect(() => {
    const fetchProducts = async () => {
      const query = new URLSearchParams({
        category,
        minPrice,
        page: String(page)
      }).toString();

      const response = await fetch(`/api/products?${query}`);
      const data = await response.json();
      setProducts(data);
    };

    fetchProducts();
  }, [category, minPrice, page]);

  // Handlers para atualizar params
  const handleCategoryChange = (e) => {
    setSearchParams(prev => {
      if (e.target.value) {
        prev.set('category', e.target.value);
      } else {
        prev.delete('category');
      }
      prev.set('page', '1'); // Reset page ao filtrar
      return prev;
    });
  };

  const handleMinPriceChange = (e) => {
    setSearchParams(prev => {
      if (e.target.value) {
        prev.set('minPrice', e.target.value);
      } else {
        prev.delete('minPrice');
      }
      prev.set('page', '1');
      return prev;
    });
  };

  const handlePageChange = (newPage) => {
    setSearchParams(prev => {
      prev.set('page', String(newPage));
      return prev;
    });
  };

  return (
    <div>
      <div>
        <select value={category} onChange={handleCategoryChange}>
          <option value="">All Categories</option>
          <option value="electronics">Electronics</option>
          <option value="books">Books</option>
        </select>

        <input
          type="number"
          value={minPrice}
          onChange={handleMinPriceChange}
          placeholder="Min price"
        />
      </div>

      <div>
        {products.map(product => (
          <div key={product.id}>{product.name}</div>
        ))}
      </div>

      <div>
        <button
          onClick={() => handlePageChange(page - 1)}
          disabled={page === 1}
        >
          Previous
        </button>
        <span>Page {page}</span>
        <button onClick={() => handlePageChange(page + 1)}>
          Next
        </button>
      </div>
    </div>
  );
}
```

**Search params com form:**
```javascript
function SearchForm() {
  const [searchParams, setSearchParams] = useSearchParams();
  const [query, setQuery] = useState(searchParams.get('q') || '');

  const handleSubmit = (e) => {
    e.preventDefault();
    setSearchParams({ q: query });
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        value={query}
        onChange={(e) => setQuery(e.target.value)}
        placeholder="Search..."
      />
      <button type="submit">Search</button>
    </form>
  );
}

// Submit ‚Üí URL muda para /search?q=react
```

---

## üéØ Aplicabilidade e Contextos

### Quando Usar Cada Hook

**useParams:**
- IDs de recursos (`/products/:id`)
- Slugs (`/blog/:slug`)
- Qualquer identificador na URL

**useNavigate:**
- Ap√≥s submit de form
- Redirect p√≥s-login/logout
- Navega√ß√£o condicional
- Voltar p√°gina (navigate(-1))

**useLocation:**
- Analytics (track page views)
- Conditional rendering baseado em path
- Ler state passado entre rotas
- Scroll to top

**useSearchParams:**
- Filtros
- Pagina√ß√£o
- Sorting
- Search/query
- Qualquer state sharable via URL

---

## ‚ö†Ô∏è Limita√ß√µes e Considera√ß√µes

### Params s√£o Strings

```javascript
const { id } = useParams();
console.log(typeof id); // "string"

// ‚ùå Compara√ß√£o falha
if (id === 123) { } // false (string vs number)

// ‚úÖ Converter
if (Number(id) === 123) { } // true
```

### Search Params s√£o Sempre Strings

```javascript
const [searchParams] = useSearchParams();
const page = searchParams.get('page'); // "2" (string)

// ‚ùå Math operations falham
page + 1 // "21" (concatena√ß√£o)

// ‚úÖ Converter
Number(page) + 1 // 3
```

### State N√£o Persiste em Refresh

```javascript
navigate('/success', { state: { message: 'Success!' } });

// location.state dispon√≠vel at√© refresh
// Ap√≥s refresh: state = null
```

**Solu√ß√£o:** Use localStorage ou search params para state persistente.

### useNavigate Requer Router Context

```javascript
// ‚ùå Fora de <BrowserRouter>
function Component() {
  const navigate = useNavigate(); // ERROR!
}

// ‚úÖ Dentro de <BrowserRouter>
<BrowserRouter>
  <Component /> {/* useNavigate funciona */}
</BrowserRouter>
```

---

## üîó Interconex√µes Conceituais

### Rela√ß√£o com useState

**Search params s√£o "URL state":**
```javascript
// Similar a useState, mas na URL
const [searchParams, setSearchParams] = useSearchParams();

// Equivalente useState
const [filters, setFilters] = useState({});
```

**Vantagem:** State compartilh√°vel (copiar URL = compartilhar state).

### Rela√ß√£o com useEffect

**Fetch baseado em params:**
```javascript
const { id } = useParams();

useEffect(() => {
  fetchProduct(id);
}, [id]); // Re-fetch quando id mudar
```

### Rela√ß√£o com Forms

**Search params com forms controlados:**
```javascript
const [searchParams, setSearchParams] = useSearchParams();
const [formData, setFormData] = useState({
  category: searchParams.get('category') || '',
  minPrice: searchParams.get('minPrice') || ''
});

// Sync form ‚Üí URL
const handleSubmit = () => {
  setSearchParams(formData);
};
```

---

## üöÄ Evolu√ß√£o e Pr√≥ximos Conceitos

### v5 vs v6

**v5:**
```javascript
import { useHistory, useParams, useLocation } from 'react-router-dom';

const history = useHistory();
history.push('/about');
```

**v6:**
```javascript
import { useNavigate, useParams, useLocation } from 'react-router-dom';

const navigate = useNavigate();
navigate('/about');
```

**`useHistory` removido** em v6, substitu√≠do por `useNavigate`.

### Pr√≥ximos Passos

Este m√≥dulo cobriu hooks fundamentais. Pr√≥ximos:

1. **11.3 React Router Avan√ßado** - Nested routes, Outlet, layouts
2. **11.4 Router Features Avan√ßados** - Protected routes, lazy loading, loaders

**Prepara√ß√£o:** Hooks s√£o building blocks. Nested routes (11.3) combinam hooks com rotas hier√°rquicas.

---

## üìö Conclus√£o

### Pontos-Chave

React Router Hooks fornecem:

1. **useParams**: Ler par√¢metros din√¢micos (`:id`)
2. **useNavigate**: Navega√ß√£o program√°tica (ap√≥s a√ß√µes)
3. **useLocation**: Info da rota atual (pathname, state, search)
4. **useSearchParams**: Query params (filtros, pagina√ß√£o)

### Best Practices

1. **Converter params para tipos corretos** (Number, Date, etc.)
2. **useNavigate com replace** para redirects (evitar voltar)
3. **useSearchParams para filtros** (state sharable via URL)
4. **Validate params** (checar se existem, se s√£o v√°lidos)
5. **State transit√≥rio no location.state** (n√£o persiste refresh)

### Patterns Comuns

**Data fetching com params:**
```javascript
const { id } = useParams();

useEffect(() => {
  fetchData(id);
}, [id]);
```

**Form submit ‚Üí Navigate:**
```javascript
const navigate = useNavigate();

const handleSubmit = async () => {
  await saveData();
  navigate('/success');
};
```

**Filtros com search params:**
```javascript
const [searchParams, setSearchParams] = useSearchParams();

const updateFilter = (key, value) => {
  setSearchParams(prev => {
    prev.set(key, value);
    return prev;
  });
};
```

### Filosofia

**"URLs are state, hooks are accessors."**

React Router Hooks transformam URL de "endere√ßo" em **state compartilh√°vel**. Params e search params s√£o state **global** (compartilh√°vel via link), enquanto location.state √© state **transit√≥rio** (n√£o persiste refresh). `useNavigate` √© setter, outros s√£o getters.

**Dominar React Router Hooks = rotas din√¢micas, navega√ß√£o fluida, state na URL.**
