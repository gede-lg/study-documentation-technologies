# Arquitetura de AplicaÃ§Ã£o React

## ğŸ¯ IntroduÃ§Ã£o e DefiniÃ§Ã£o

### DefiniÃ§Ã£o Conceitual

**Arquitetura de AplicaÃ§Ã£o** Ã© a **organizaÃ§Ã£o estrutural de alto nÃ­vel** de uma aplicaÃ§Ã£o React, definindo **como componentes, dados e lÃ³gica sÃ£o organizados, conectados e escalados**. Conceitualmente, representa **blueprint do sistema** - decisÃµes fundamentais sobre estrutura de pastas, fluxo de dados, separaÃ§Ã£o de responsabilidades e patterns que guiam desenvolvimento de features.

### Problema que Resolve

**Sem Arquitetura**:
- CÃ³digo desorganizado e espalhado
- DifÃ­cil encontrar/modificar features
- Reuso impossÃ­vel
- Escala quebra aplicaÃ§Ã£o
- Onboarding lento

**Com Arquitetura**:
- CÃ³digo organizado e previsÃ­vel
- Features isoladas e encontrÃ¡veis
- Componentes reutilizÃ¡veis
- Escala sem dor
- Onboarding rÃ¡pido

---

## ğŸ“ Estrutura de Pastas

### Feature-Based (Recomendado)

```
src/
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx
â”‚   â”‚   â”‚   â””â”€â”€ SignupForm.tsx
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â””â”€â”€ useAuth.ts
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ authApi.ts
â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â””â”€â”€ auth.types.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ products/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductList.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductCard.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ProductDetail.tsx
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useProducts.ts
â”‚   â”‚   â”‚   â””â”€â”€ useProduct.ts
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ productsApi.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â””â”€â”€ cart/
â”‚       â”œâ”€â”€ components/
â”‚       â”œâ”€â”€ hooks/
â”‚       â””â”€â”€ api/
â”‚
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ components/  # Componentes reutilizÃ¡veis
â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”‚   â””â”€â”€ Modal.tsx
â”‚   â”œâ”€â”€ hooks/       # Hooks genÃ©ricos
â”‚   â”‚   â”œâ”€â”€ useLocalStorage.ts
â”‚   â”‚   â””â”€â”€ useDebounce.ts
â”‚   â”œâ”€â”€ utils/       # FunÃ§Ãµes utilitÃ¡rias
â”‚   â”‚   â”œâ”€â”€ format.ts
â”‚   â”‚   â””â”€â”€ validate.ts
â”‚   â””â”€â”€ types/       # Tipos compartilhados
â”‚       â””â”€â”€ common.types.ts
â”‚
â”œâ”€â”€ lib/             # ConfiguraÃ§Ãµes de bibliotecas
â”‚   â”œâ”€â”€ react-query.ts
â”‚   â””â”€â”€ axios.ts
â”‚
â”œâ”€â”€ routes/          # Rotas
â”‚   â””â”€â”€ index.tsx
â”‚
â””â”€â”€ App.tsx
```

**BenefÃ­cios**:
- Features isoladas e independentes
- FÃ¡cil deletar feature inteira
- Clara relaÃ§Ã£o entre arquivos
- Escala bem (adicione features sem limite)

### Layer-Based (Tradicional)

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ LoginForm.tsx
â”‚   â”œâ”€â”€ SignupForm.tsx
â”‚   â”œâ”€â”€ ProductList.tsx
â”‚   â”œâ”€â”€ ProductCard.tsx
â”‚   â”œâ”€â”€ Button.tsx
â”‚   â””â”€â”€ Input.tsx
â”‚
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useProducts.ts
â”‚   â””â”€â”€ useLocalStorage.ts
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ authService.ts
â”‚   â””â”€â”€ productsService.ts
â”‚
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ format.ts
â”‚
â””â”€â”€ types/
    â”œâ”€â”€ auth.types.ts
    â””â”€â”€ product.types.ts
```

**Desvantagens**:
- DifÃ­cil entender features
- Pastas crescem infinitamente
- Acoplamento invisÃ­vel
- DifÃ­cil deletar features

---

## ğŸ›ï¸ Camadas de Arquitetura

### SeparaÃ§Ã£o de Responsabilidades

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Presentation Layer (UI)             â”‚
â”‚  - Components (JSX)                  â”‚
â”‚  - Styling (CSS)                     â”‚
â”‚  - User Interactions                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ Props / Events
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Business Logic Layer                â”‚
â”‚  - Hooks (custom)                    â”‚
â”‚  - Context/State Management          â”‚
â”‚  - Validation                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ API Calls
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Data Access Layer                   â”‚
â”‚  - API clients (Axios, Fetch)        â”‚
â”‚  - React Query / SWR                 â”‚
â”‚  - Caching                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ HTTP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend API                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Exemplo PrÃ¡tico

```tsx
// âŒ Tudo misturado
function ProductList() {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    setLoading(true);
    fetch('/api/products')
      .then(r => r.json())
      .then(data => {
        setProducts(data);
        setLoading(false);
      });
  }, []);

  return (
    <div>
      {loading ? 'Loading...' : products.map(p => (
        <div key={p.id}>{p.name}</div>
      ))}
    </div>
  );
}

// âœ… Separado em camadas
// Data Layer
// api/productsApi.ts
export const productsApi = {
  getAll: () => axios.get('/api/products').then(r => r.data)
};

// Business Logic Layer
// hooks/useProducts.ts
export function useProducts() {
  return useQuery({
    queryKey: ['products'],
    queryFn: productsApi.getAll
  });
}

// Presentation Layer
// components/ProductList.tsx
function ProductList() {
  const { data: products, isLoading } = useProducts();

  if (isLoading) return <LoadingSpinner />;

  return (
    <div>
      {products.map(p => (
        <ProductCard key={p.id} product={p} />
      ))}
    </div>
  );
}

// components/ProductCard.tsx
function ProductCard({ product }) {
  return (
    <div>
      <h3>{product.name}</h3>
      <p>{product.description}</p>
    </div>
  );
}
```

---

## ğŸ”„ Fluxo de Dados

### Unidirecional (One-Way Data Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   State      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Props
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Events
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Handlers    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ setState
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   State      â”‚ (ciclo reinicia)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Lifting State Up

```tsx
// âŒ Estado duplicado
function Parent() {
  return (
    <>
      <ComponentA /> {/* PrÃ³prio estado */}
      <ComponentB /> {/* PrÃ³prio estado */}
    </>
  );
}

// âœ… Estado elevado
function Parent() {
  const [sharedState, setSharedState] = useState('');

  return (
    <>
      <ComponentA value={sharedState} onChange={setSharedState} />
      <ComponentB value={sharedState} onChange={setSharedState} />
    </>
  );
}
```

### ComposiÃ§Ã£o vs Props Drilling

```tsx
// âŒ Props Drilling (passar props por muitos nÃ­veis)
function App() {
  const [user, setUser] = useState(null);

  return <Layout user={user} setUser={setUser} />;
}

function Layout({ user, setUser }) {
  return <Header user={user} setUser={setUser} />;
}

function Header({ user, setUser }) {
  return <UserMenu user={user} setUser={setUser} />;
}

function UserMenu({ user, setUser }) {
  return <div>{user.name}</div>;
}

// âœ… Context (estado global)
const UserContext = createContext();

function App() {
  const [user, setUser] = useState(null);

  return (
    <UserContext.Provider value={{ user, setUser }}>
      <Layout />
    </UserContext.Provider>
  );
}

function UserMenu() {
  const { user } = useContext(UserContext);
  return <div>{user.name}</div>;
}

// âœ… ComposiÃ§Ã£o (passar componentes)
function App() {
  const [user, setUser] = useState(null);

  return (
    <Layout>
      <Header>
        <UserMenu user={user} />
      </Header>
    </Layout>
  );
}
```

---

## ğŸ¯ Patterns Arquiteturais

### Container/Presentational Pattern

```tsx
// Presentational (UI puro)
type ProductCardProps = {
  product: Product;
  onAddToCart: (id: number) => void;
};

function ProductCard({ product, onAddToCart }: ProductCardProps) {
  return (
    <div>
      <h3>{product.name}</h3>
      <p>${product.price}</p>
      <button onClick={() => onAddToCart(product.id)}>
        Add to Cart
      </button>
    </div>
  );
}

// Container (lÃ³gica + dados)
function ProductCardContainer({ productId }: { productId: number }) {
  const { data: product } = useProduct(productId);
  const addToCart = useAddToCart();

  if (!product) return <Skeleton />;

  return (
    <ProductCard
      product={product}
      onAddToCart={addToCart}
    />
  );
}
```

### Custom Hooks Pattern (LÃ³gica ReutilizÃ¡vel)

```tsx
// Hook customizado encapsula lÃ³gica
function useProductWithCart(productId: number) {
  const { data: product, isLoading } = useProduct(productId);
  const addToCart = useAddToCart();
  const { items } = useCart();

  const inCart = items.some(item => item.id === productId);
  const quantity = items.find(item => item.id === productId)?.quantity ?? 0;

  return {
    product,
    isLoading,
    addToCart,
    inCart,
    quantity
  };
}

// Component usa hook
function ProductCard({ productId }) {
  const { product, isLoading, addToCart, inCart, quantity } =
    useProductWithCart(productId);

  if (isLoading) return <Skeleton />;

  return (
    <div>
      <h3>{product.name}</h3>
      {inCart ? (
        <p>In cart: {quantity}</p>
      ) : (
        <button onClick={() => addToCart(productId)}>
          Add to Cart
        </button>
      )}
    </div>
  );
}
```

---

## ğŸ§© ModularizaÃ§Ã£o

### Barrel Exports (index.ts)

```tsx
// features/products/components/index.ts
export { ProductList } from './ProductList';
export { ProductCard } from './ProductCard';
export { ProductDetail } from './ProductDetail';

// features/products/index.ts
export * from './components';
export * from './hooks';
export * from './types';

// Uso em outro arquivo
import { ProductList, useProducts, Product } from '@/features/products';
```

### Absolute Imports

```json
// tsconfig.json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@/components/*": ["src/shared/components/*"],
      "@/hooks/*": ["src/shared/hooks/*"],
      "@/features/*": ["src/features/*"]
    }
  }
}
```

```tsx
// âŒ Relative imports
import Button from '../../../shared/components/Button';
import { useAuth } from '../../features/auth/hooks/useAuth';

// âœ… Absolute imports
import Button from '@/components/Button';
import { useAuth } from '@/features/auth';
```

---

## ğŸš€ ConclusÃ£o

Arquitetura de AplicaÃ§Ã£o React inclui:
- **Estrutura**: Feature-based (escalÃ¡vel) vs Layer-based
- **Camadas**: Presentation â†’ Business Logic â†’ Data Access
- **Fluxo**: Unidirecional, lifting state, Context
- **Patterns**: Container/Presentational, Custom Hooks
- **ModularizaÃ§Ã£o**: Barrel exports, absolute imports

Boa arquitetura Ã© invisÃ­vel quando funciona - permite foco em features, nÃ£o em onde colocar arquivos.
