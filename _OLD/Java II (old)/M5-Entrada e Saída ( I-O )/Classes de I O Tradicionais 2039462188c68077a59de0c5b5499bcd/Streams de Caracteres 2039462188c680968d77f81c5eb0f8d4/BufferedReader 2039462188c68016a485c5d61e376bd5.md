# BufferedReader

**1. Introdução**

O tema principal aqui é o **`BufferedReader`**, uma classe do pacote `java.io` usada para ler fluxos de caracteres de forma eficiente.

- **Visão Geral :** `BufferedReader` faz o “buffering” (armazenamento em memória temporária) de dados lidos de uma fonte de caracteres — por exemplo, arquivos de texto ou streams de rede — reduzindo o número de operações de I/O e, consequentemente, melhorando a performance.
- **Relevância:** Em aplicações de backend, é comum processar grandes volumes de texto (logs, arquivos de configuração, respostas HTTP). Ler caractere a caractere sem buffering gera muitas chamadas de sistema e degrada o desempenho. `BufferedReader` otimiza esse processo.
- **Definições e Conceitos Fundamentais:**
    - **Tema principal:** `BufferedReader` em si, sua finalidade e funcionamento.
    - **Subtemas:**
        - *Fluxos de caracteres* (`Reader`/`Writer`) – abstratos que trabalham com texto.
        - *Buffering* – técnica de armazenar blocos de dados para reduzir chamadas de I/O.
        - *Tratamento de exceções e recursos* – lidar com `IOException` e fechar streams corretamente.

---

**2. Sumário**

1. **Introdução**
2. **Sumário**
3. **Conteúdo Detalhado**
    - 3.1 Sintaxe e Estrutura
    - 3.2 Componentes Principais
    - 3.3 Restrições de Uso
4. **Exemplos de Código Otimizados**
    - 4.1 Leitura Básica de Arquivo
    - 4.2 Leitura Avançada com Charset Específico
    - 4.3 Marcações de Posição (mark/reset)
5. **Informações Adicionais**
6. **Referências para Estudo Independente**

---

**3. Conteúdo Detalhado**

### 3.1 Sintaxe e Estrutura

```java
// Importações essenciais
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

// Declaração típica
BufferedReader br = new BufferedReader(new FileReader("caminho/para/arquivo.txt"));

```

- **Construtor principal:**
    
    ```java
    BufferedReader(Reader in)
    BufferedReader(Reader in, int sz)  // buffer customizado em bytes
    
    ```
    
    - `in` é qualquer subclasse de `Reader` (e.g., `FileReader`, `InputStreamReader`).
    - `sz` define o tamanho do buffer (em caracteres); o padrão costuma ser 8 KB.

### 3.2 Componentes Principais

- **`read()`**
    
    ```java
    int read() throws IOException
    
    ```
    
    Lê um caractere e retorna seu valor Unicode (0–65535) ou `-1` ao final do stream.
    
- **`read(char[] cbuf, int off, int len)`**
Lê até `len` caracteres em `cbuf`, começando em `off`; retorna número de caracteres lidos ou `1`.
- **`readLine()`**
    
    ```java
    String readLine() throws IOException
    
    ```
    
    Lê uma linha (até que encontre `\\n`, `\\r` ou `\\r\\n`) e retorna sem os caracteres de quebra de linha, ou `null` no fim do arquivo.
    
- **`ready()`**
    
    ```java
    boolean ready() throws IOException
    
    ```
    
    Indica se a próxima chamada a `read()` não bloqueará.
    
- **`mark(int readAheadLimit)` / `reset()`**
Permitem “marcar” a posição atual no buffer e, depois, voltar a ela desde que não ultrapasse `readAheadLimit` caracteres.
- **`close()`**
Fecha o fluxo e libera recursos; sempre em bloco `finally` ou try-with-resources.

### 3.3 Restrições de Uso

- **Buffering vs. memória:** Buffers grandes reduzem chamadas de I/O mas consomem mais RAM. Ajuste `sz` conforme o contexto.
- **Fluxos de caracteres apenas:** Para dados binários (imagens, PDF), use `BufferedInputStream`.
- **Mark/reset limitado:** Nem todos os `Reader`s suportam; verifique `markSupported()`.
- **Tratamento de exceções:** Falhas de I/O (p. ex., arquivo não encontrado) geram `IOException` que deve ser capturada ou repassada.

---

**4. Exemplos de Código Otimizados**

### 4.1 Leitura Básica de Arquivo

```java
try (BufferedReader br = new BufferedReader(new FileReader("dados.txt"))) {
    String linha;
    while ((linha = br.readLine()) != null) {
        System.out.println(linha);
    }
} catch (IOException e) {
    e.printStackTrace();
}

```

- Usa *try-with-resources* para fechar automaticamente.
- Loop simples para processar cada linha.

### 4.2 Leitura com Charset Específico

```java
import java.io.InputStreamReader;
import java.nio.charset.StandardCharsets;

try (BufferedReader br = new BufferedReader(
         new InputStreamReader(
             new FileInputStream("dados_utf8.txt"),
             StandardCharsets.UTF_8))) {
    br.lines()
      .filter(l -> !l.trim().isEmpty())
      .forEach(System.out::println);
}

```

- Garante leitura correta de acentuação.
- Usa `Stream<String>` via `br.lines()` para pipeline funcional.

### 4.3 Marcações de Posição (mark/reset)

```java
try (BufferedReader br = new BufferedReader(new FileReader("log.txt"))) {
    if (br.markSupported()) {
        br.mark(1024);               // marca até 1 024 chars
        String firstLine = br.readLine();
        // ... processa firstLine ...
        br.reset();                  // volta ao início
        // podemos reler desde o começo
    }
}

```

- Útil para pré-visualizar e depois reprocessar dados.

---

**5. Informações Adicionais**

- **Performance:** Para grandes arquivos, ajustar buffer ou usar `Files.newBufferedReader(Path)` (Java 7+).
- **Alternativa NIO:** `java.nio.file.Files.lines(Path)` retorna `Stream<String>` com lazy loading.
- **Fluxos Decorator:** `BufferedReader` faz parte do padrão *Decorator*, adicionando comportamento a qualquer `Reader`.
- **Concorrência:** `BufferedReader` NÃO é thread-safe; sincronize externamente se necessário.

---

**6. Referências para Estudo Independente**

- **Documentação Oracle:**
    - [`BufferedReader` (Java 11 API)](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/BufferedReader.html)
    - [`Reader` (Java 11 API)](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/Reader.html)
- **Artigos e Tutoriais:**
    - Baeldung: [Guide to Java BufferedReader](https://www.baeldung.com/java-bufferedreader)
    - Vogella: [Java I/O Tutorial](https://www.vogella.com/tutorials/JavaIO/article.html)
- **Livros:**
    - *“Effective Java”*, Joshua Bloch (capítulo sobre I/O e boas práticas)
    - *“Java: Como Programar”*, Deitel & Deitel (seção de fluxos de I/O)