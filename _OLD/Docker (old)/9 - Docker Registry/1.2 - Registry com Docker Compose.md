
#### Passo 1: Criar o Arquivo `docker-compose.yml`

1. **Estrutura do Arquivo**:
   - Crie um diretório e um arquivo `docker-compose.yml`:
     ```sh
     mkdir -p ~/docker_registry_compose
     cd ~/docker_registry_compose
     touch docker-compose.yml
     ```

2. **Conteúdo do Arquivo**:
   - Adicione o seguinte conteúdo ao `docker-compose.yml`:
     ```yaml
     version: '3'

     services:
       registry:
         image: registry:2
         ports:
           - "5000:5000"
         environment:
           REGISTRY_HTTP_TLS_CERTIFICATE: /certs/domain.crt
           REGISTRY_HTTP_TLS_KEY: /certs/domain.key
           REGISTRY_AUTH: htpasswd
           REGISTRY_AUTH_HTPASSWD_REALM: Registry Realm
           REGISTRY_AUTH_HTPASSWD_PATH: /auth/htpasswd
         volumes:
           - ./data:/var/lib/registry
           - ./certs:/certs
           - ./auth:/auth
         restart: always
     ```

#### Passo 2: Preparar o Ambiente

1. **Gerar Certificados TLS e Criar Arquivo de Senhas**:
   - Siga os mesmos passos para gerar certificados e criar o arquivo de senhas descritos na Parte 1.

2. **Estrutura de Diretórios**:
   - Certifique-se de que a estrutura de diretórios esteja assim:
     ```sh
     ~/docker_registry_compose/
     ├── auth
     │   └── htpasswd
     ├── certs
     │   ├── domain.crt
     │   └── domain.key
     └── data
     ```

#### Passo 3: Iniciar o Docker Compose

1. **Subir o Serviço**:
   - Execute o Docker Compose para subir o serviço:
     ```sh
     docker-compose up -d
     ```

#### Passo 4: Usar o Registry

1. **Configurar o Docker para Confiar no Certificado e Usar o Registry**:
   - Siga os mesmos passos descritos na Parte 1 para configurar o Docker, logar, e fazer push/pull das imagens.