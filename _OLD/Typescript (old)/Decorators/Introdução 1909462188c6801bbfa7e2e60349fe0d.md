# Introdução

Decorators são uma funcionalidade poderosa do TypeScript que permite modificar o comportamento de classes, métodos, propriedades ou parâmetros de forma declarativa. Inspirados por conceitos de metaprogramação, os decorators ajudam a escrever código mais limpo, reutilizável e modular. Eles são especialmente relevantes em frameworks modernos (como Angular) e em aplicações que se beneficiam da injeção de dependências, logging, validação e outros aspectos transversais sem poluir a lógica de negócio.

## 2. Sumário

- [Introdução](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#1-introdu%C3%A7%C3%A3o)
- [Sumário](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#2-sum%C3%A1rio)
- [Conteúdo Detalhado](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#3-conte%C3%BAdo-detalhado)
    - [3.1 Definição e Conceitos Fundamentais](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#31-defini%C3%A7%C3%A3o-e-conceitos-fundamentais)
    - [3.2 Sintaxe e Estrutura](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#32-sintaxe-e-estrutura)
    - [3.3 Componentes Principais](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#33-componentes-principais)
    - [3.4 Uso Avançado](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#34-uso-avan%C3%A7ado)
- [Exemplos de Código Otimizados](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#4-exemplos-de-c%C3%B3digo-otimizados)
- [Informações Adicionais](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#5-informa%C3%A7%C3%B5es-adicionais)
- [Referências para Estudo Independente](https://chatgpt.com/c/67a22ce2-8578-8003-a4b4-36cbf36efed4#6-refer%C3%AAncias-para-estudo-independente)

## 3. Conteúdo Detalhado

### 3.1 Definição e Conceitos Fundamentais

**Decorators:**

São funções que permitem modificar ou estender o comportamento de classes, métodos, propriedades ou parâmetros. Eles atuam como "anotações" ou "metadados" que, quando aplicados, podem alterar a execução de determinado código.

**Tipos de Decorators em TypeScript:**

No TypeScript, os principais tipos de decorators são:

- **Class Decorators:** Modificam ou estendem a definição de uma classe.
- **Method Decorators:** Aplicados em métodos, permitindo interceptar ou modificar a execução.
- **Property Decorators:** Aplicados em propriedades, possibilitando a adição de metadados ou a modificação de comportamentos.
- **Parameter Decorators:** Utilizados para adicionar metadados aos parâmetros dos métodos.

**Conceitos Básicos vs. Avançados:**

- **Básicos:** Entender a sintaxe, os tipos disponíveis e como aplicar um decorator em uma classe ou método.
- **Avançados:** Explorar a manipulação de metadados, criação de decorators parametrizados (que aceitam argumentos) e a combinação de múltiplos decorators para casos complexos.

### 3.2 Sintaxe e Estrutura

A sintaxe básica de um decorator em TypeScript consiste em uma função que recebe como parâmetro o alvo (por exemplo, a classe ou o método) e retorna ou modifica o que foi decorado.

### Exemplo Básico de Class Decorator:

```tsx
// Decorator simples que adiciona uma propriedade à classe
function addTimestamp(target: Function) {
  target.prototype.timestamp = new Date();
}

@addTimestamp
class MinhaClasse {
  constructor(public nome: string) {}
}

const instancia = new MinhaClasse("Teste");
console.log((instancia as any).timestamp); // Exibe a data atual

```

### Exemplo Básico de Method Decorator:

```tsx
// Decorator que loga a execução do método
function log(target: any, propertyKey: string, descriptor: PropertyDescriptor) {
  const metodoOriginal = descriptor.value;
  descriptor.value = function (...args: any[]) {
    console.log(`Método ${propertyKey} chamado com os argumentos: ${JSON.stringify(args)}`);
    return metodoOriginal.apply(this, args);
  };
  return descriptor;
}

class Calculadora {
  @log
  somar(a: number, b: number): number {
    return a + b;
  }
}

const calc = new Calculadora();
calc.somar(2, 3); // Logs e retorno do método

```

### Exemplo Básico de Property Decorator:

```tsx
// Decorator que define um valor padrão para a propriedade
function defaultValue(value: any) {
  return function (target: any, propertyKey: string) {
    let _val = value;
    Object.defineProperty(target, propertyKey, {
      get: () => _val,
      set: (novoValor) => {
        _val = novoValor;
      },
      enumerable: true,
      configurable: true,
    });
  };
}

class Configuracao {
  @defaultValue("localhost")
  host: string;
}

const config = new Configuracao();
console.log(config.host); // Imprime "localhost"

```

### Exemplo Básico de Parameter Decorator:

```tsx
// Decorator que adiciona metadados ao parâmetro
function required(target: any, propertyKey: string, parameterIndex: number) {
  const metadataKey = `required_${propertyKey}`;
  if (Array.isArray(target[metadataKey])) {
    target[metadataKey].push(parameterIndex);
  } else {
    target[metadataKey] = [parameterIndex];
  }
}

class Servico {
  metodo(@required nome: string) {
    console.log(`Olá, ${nome}`);
  }
}

```

### 3.3 Componentes Principais

- **Funções Decoradoras:**
    
    São funções que recebem um ou mais parâmetros (conforme o tipo de decorator) e podem modificar o comportamento do elemento decorado.
    
- **Métodos e Propriedades:**
    
    Decorators podem interceptar a definição de métodos e propriedades, alterando sua implementação, adicionando funcionalidades ou modificando sua visibilidade e comportamento.
    
- **Interação Entre Decorators:**
    
    É possível combinar múltiplos decorators em uma mesma classe ou método. A ordem de aplicação geralmente é de cima para baixo, mas o comportamento pode depender da implementação interna dos decorators.
    

### 3.4 Uso Avançado

- **Decorators Parametrizados:**
    
    São decorators que aceitam parâmetros para fornecer configurações dinâmicas.
    
    ```tsx
    // Decorator parametrizado para controlar o acesso
    function autorizacao(role: string) {
      return function (target: any, propertyKey: string, descriptor: PropertyDescriptor) {
        const metodoOriginal = descriptor.value;
        descriptor.value = function (...args: any[]) {
          // Simulação de verificação de papel
          if (this.usuario && this.usuario.role === role) {
            return metodoOriginal.apply(this, args);
          } else {
            throw new Error("Acesso negado: usuário sem permissão.");
          }
        };
        return descriptor;
      };
    }
    
    class Controlador {
      usuario = { role: 'admin' };
    
      @autorizacao('admin')
      acaoSensivel() {
        console.log("Ação sensível executada.");
      }
    }
    
    const controlador = new Controlador();
    controlador.acaoSensivel(); // Executa com sucesso para admin
    
    ```
    
- **Integração com Metaprogramação:**
    
    Decorators podem ser usados para implementar injeção de dependências e registrar metadados, facilitando a criação de frameworks ou bibliotecas que manipulam comportamentos dinâmicos.
    
- **Validação e Logging:**
    
    Em aplicações complexas, decorators são frequentemente usados para validar entradas, registrar logs de execução e monitorar performance sem interferir diretamente na lógica de negócio.
    

## 4. Exemplos de Código Otimizados

### Exemplo Completo com Vários Decorators

```tsx
// Decorator para registrar a execução de um método
function logExecution(target: any, propertyKey: string, descriptor: PropertyDescriptor) {
  const originalMethod = descriptor.value;
  descriptor.value = function (...args: any[]) {
    console.log(`Executando ${propertyKey} com argumentos: ${JSON.stringify(args)}`);
    const result = originalMethod.apply(this, args);
    console.log(`Resultado de ${propertyKey}: ${result}`);
    return result;
  };
  return descriptor;
}

// Decorator parametrizado para validar parâmetros
function validateNumber(target: any, propertyKey: string, parameterIndex: number) {
  const metadataKey = `__validate_${propertyKey}_parameters`;
  if (Array.isArray(target[metadataKey])) {
    target[metadataKey].push(parameterIndex);
  } else {
    target[metadataKey] = [parameterIndex];
  }
}

class CalculadoraAvancada {
  // Aplicação de um decorator em um método
  @logExecution
  multiplicar(@validateNumber a: number, @validateNumber b: number): number {
    // Aqui, poderia ser implementada uma lógica de validação utilizando os metadados
    return a * b;
  }
}

const calcAvancada = new CalculadoraAvancada();
calcAvancada.multiplicar(4, 5); // Logs detalhados e retorno do cálculo

```

> Nota: Em implementações avançadas, você pode combinar metadados coletados por decorators de parâmetros para validar os argumentos antes da execução do método.
> 

## 5. Informações Adicionais

- **Combinação de Decorators:**
    
    Ao aplicar múltiplos decorators em um único elemento, é importante conhecer a ordem de execução e como cada decorator pode influenciar o comportamento dos outros.
    
- **Compatibilidade com ES7/ESNext:**
    
    Decorators são uma proposta de padrão ECMAScript e, embora estejam em estágios avançados de discussão, sua implementação no TypeScript já permite o uso em projetos. Fique atento às atualizações do ECMAScript para evitar surpresas em futuras versões do JavaScript.
    
- **Debug e Performance:**
    
    O uso excessivo ou mal planejado de decorators pode dificultar o debug do código e impactar a performance da aplicação. É recomendado usá-los com critério e sempre documentar sua finalidade.
    
- **Ferramentas e Bibliotecas:**
    
    Muitos frameworks e bibliotecas (como Angular e NestJS) utilizam decorators para oferecer funcionalidades avançadas, tornando-os essenciais para o desenvolvimento moderno em TypeScript.
    

## 6. Referências para Estudo Independente

- **Documentação Oficial do TypeScript:**
    
    [Decorators (Experimental)](https://www.typescriptlang.org/docs/handbook/decorators.html)
    
- **Artigos e Tutoriais:**
    - [Understanding TypeScript Decorators](https://blog.logrocket.com/understanding-typescript-decorators/)
    - [A Deep Dive into TypeScript Decorators](https://medium.com/@davidkpiano/a-deep-dive-into-typescript-decorators-9c5b2d25c142)
- **Livros:**
    - *Programming TypeScript* – Boris Cherny
    - *Mastering TypeScript* – Nathan Rozentals
- **Repositórios e Exemplos no GitHub:**
    - [TypeScript Decorators Examples](https://github.com/justjavac/typescript-decorator)

---

Este conteúdo oferece uma visão detalhada e prática sobre decorators em TypeScript, abordando desde os conceitos básicos até usos avançados, com exemplos de código claros e referências para aprofundamento. Explore cada seção para entender como os decorators podem melhorar a organização e a flexibilidade do seu código!