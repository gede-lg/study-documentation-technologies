# keyof e typeof

## 1. Introdução

Os operadores `keyof` e `typeof` são ferramentas poderosas no TypeScript que permitem uma tipagem mais dinâmica e flexível. **`keyof`** é utilizado para obter as chaves de um objeto como um tipo, facilitando a criação de tipos que dependem das propriedades de outros objetos. **`typeof`**, por sua vez, pode ser usado tanto para obter o tipo de uma variável quanto para definir tipos baseados em valores existentes. Combinados, esses operadores aumentam significativamente a expressividade e a reutilização de tipos no desenvolvimento com TypeScript, promovendo código mais seguro e robusto.

## 2. Sumário

1. [Introdução](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#1-introdu%C3%A7%C3%A3o)
2. [Sumário](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#2-sum%C3%A1rio)
3. [Conteúdo Detalhado](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#3-conte%C3%BAdo-detalhado)
    - [Definição e Conceitos Fundamentais](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#defini%C3%A7%C3%A3o-e-conceitos-fundamentais)
    - [Sintaxe e Estrutura](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#sintaxe-e-estrutura)
    - [Componentes Principais](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#componentes-principais)
    - [Uso Avançado](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#uso-avan%C3%A7ado)
4. [Exemplos de Código Otimizados](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#4-exemplos-de-c%C3%B3digo-otimizados)
    - [`keyof`](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#keyof)
    - [`typeof`](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#typeof)
5. [Informações Adicionais](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#5-informa%C3%A7%C3%B5es-adicionais)
6. [Referências para Estudo Independente](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#6-refer%C3%AAncias-para-estudo-independente)
7. [Formatação em Markdown](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#7-formata%C3%A7%C3%A3o-em-markdown)
8. [Conclusão](https://chatgpt.com/c/678d6091-dd58-8003-9b75-fa42bf893843#8-conclus%C3%A3o)

## 3. Conteúdo Detalhado

### Definição e Conceitos Fundamentais

**Tema Principal:** `keyof` e `typeof` em TypeScript

**Subtemas:**

- **`keyof`:** Obtenção das chaves de objetos como tipos.
- **`typeof`:** Uso em variáveis e definição de tipos baseados em valores.

**Conceitos Básicos vs. Avançados:**

- **Básicos:** Compreensão individual de `keyof` e `typeof`, suas definições e usos simples.
- **Avançados:** Combinação de `keyof` e `typeof` com generics, tipos condicionais, mapeamento de tipos e manipulação avançada de tipos dinâmicos.

### Sintaxe e Estrutura

**`keyof`:**
Permite extrair as chaves de um objeto como um tipo de união de literais de string.

```tsx
interface Pessoa {
    nome: string;
    idade: number;
    email?: string;
}

type ChavesPessoa = keyof Pessoa; // "nome" | "idade" | "email"

```

**`typeof`:**
Usado para obter o tipo de uma variável ou expressão existente.

```tsx
let numero = 42;
type TipoNumero = typeof numero; // number

const pessoa = {
    nome: "João",
    idade: 30,
};

type TipoPessoa = typeof pessoa;
// {
//     nome: string;
//     idade: number;
// }

```

### Componentes Principais

### `keyof`

- **Descrição:** Operador que extrai as chaves de um tipo de objeto como um tipo de união de literais de string.
- **Uso Comum:** Criar tipos que dependem das propriedades de outros objetos, como em funções que manipulam propriedades dinamicamente.
- **Interação:** Frequentemente usado com generics para criar tipos reutilizáveis e seguros.

### `typeof`

- **Descrição:** Operador que obtém o tipo de uma variável ou expressão existente.
- **Uso Comum:** Definir tipos com base em valores existentes, evitando redundância e mantendo a consistência.
- **Interação:** Pode ser combinado com outros operadores de tipo para criar tipos dinâmicos e flexíveis.

### Uso Avançado

- **Combinação com Generics:**
    
    ```tsx
    function pegarValor<T, K extends keyof T>(obj: T, chave: K): T[K] {
        return obj[chave];
    }
    
    const pessoa = { nome: "Ana", idade: 25 };
    const nome = pegarValor(pessoa, "nome"); // string
    const idade = pegarValor(pessoa, "idade"); // number
    
    ```
    
- **Tipos Condicionais com `keyof` e `typeof`:**
    
    ```tsx
    type PropriedadeObrigatoria<T, K extends keyof T> = T[K] extends undefined ? never : K;
    
    interface Produto {
        id: number;
        nome: string;
        descricao?: string;
    }
    
    type PropsObrigatorias = PropriedadeObrigatoria<Produto, keyof Produto>; // "id" | "nome"
    
    ```
    
- **Mapeamento de Tipos Dinâmicos:**
    
    ```tsx
    type LeituraSomente<T> = {
        readonly [P in keyof T]: T[P];
    };
    
    interface Configuracao {
        url: string;
        metodo: string;
    }
    
    type ConfiguracaoSomenteLeitura = LeituraSomente<Configuracao>;
    // {
    //     readonly url: string;
    //     readonly metodo: string;
    // }
    
    ```
    

## 4. Exemplos de Código Otimizados

### `keyof`

```tsx
// Interface de exemplo
interface Livro {
    titulo: string;
    autor: string;
    paginas: number;
}

// Utilizando keyof para criar um tipo das chaves de Livro
type ChavesLivro = keyof Livro; // "titulo" | "autor" | "paginas"

// Função que recebe uma chave válida de Livro
function obterValorLivro(livro: Livro, chave: ChavesLivro) {
    return livro[chave];
}

const meuLivro: Livro = {
    titulo: "1984",
    autor: "George Orwell",
    paginas: 328,
};

const titulo = obterValorLivro(meuLivro, "titulo"); // "1984"
const paginas = obterValorLivro(meuLivro, "paginas"); // 328
// obterValorLivro(meuLivro, "editora"); // Erro: Argument of type '"editora"' is not assignable to parameter of type 'ChavesLivro'.

```

### `typeof`

```tsx
// Definindo uma variável
const configuracao = {
    apiUrl: "https://api.exemplo.com",
    timeout: 5000,
};

// Utilizando typeof para definir um tipo baseado na variável configuracao
type ConfiguracaoTipo = typeof configuracao;
// {
//     apiUrl: string;
//     timeout: number;
// }

// Função que utiliza o tipo ConfiguracaoTipo
function configurarApp(config: ConfiguracaoTipo) {
    console.log(`API URL: ${config.apiUrl}`);
    console.log(`Timeout: ${config.timeout}ms`);
}

const novaConfiguracao: ConfiguracaoTipo = {
    apiUrl: "https://api.novo.com",
    timeout: 3000,
};

configurarApp(novaConfiguracao);

```

### Combinação de `keyof` e `typeof` com Generics

```tsx
// Objeto exemplo
const usuario = {
    nome: "Lucas",
    idade: 28,
    email: "lucas@example.com",
};

// Utilizando typeof para obter o tipo do objeto usuario
type Usuario = typeof usuario;

// Utilizando keyof para obter as chaves do tipo Usuario
type ChavesUsuario = keyof Usuario; // "nome" | "idade" | "email"

// Função genérica que utiliza keyof e typeof
function atualizarPropriedade<T, K extends keyof T>(obj: T, chave: K, valor: T[K]): T {
    obj[chave] = valor;
    return obj;
}

const usuarioAtualizado = atualizarPropriedade(usuario, "idade", 29);
// usuarioAtualizado idade: 29

```

### Funções com `keyof` e `typeof`

```tsx
// Definindo uma função que retorna uma chave específica de um objeto
function pegarChave<T>(obj: T, chave: keyof T): keyof T {
    return chave;
}

const produto = {
    id: 101,
    nome: "Camiseta",
    preco: 49.99,
};

const chaveNome = pegarChave(produto, "nome"); // "nome"
// const chaveCor = pegarChave(produto, "cor"); // Erro: Argument of type '"cor"' is not assignable to parameter of type 'keyof typeof produto'.

```

## 5. Informações Adicionais

- **Diferença entre `keyof` e `typeof`:**
    - **`keyof`:** Foca nas chaves de um tipo de objeto, útil para operações que dependem das propriedades do objeto.
    - **`typeof`:** Obtém o tipo de uma variável ou expressão, permitindo a reutilização de tipos baseados em valores existentes.
- **Uso com Interfaces e Classes:**
    - `keyof` pode ser utilizado com interfaces para criar tipos baseados nas propriedades definidas.
    - `typeof` pode ser usado para obter tipos de instâncias de classes ou valores de classes estáticas.
- **Integração com Tipos Avançados:**
    - **Tipos Mapeados:** Combinação de `keyof` com tipos mapeados para criar tipos derivados.
        
        ```tsx
        type PartialLivro = {
            [P in keyof Livro]?: Livro[P];
        };
        
        ```
        
    - **Tipos Condicionais:** Uso de `keyof` e `typeof` em tipos condicionais para criar lógica de tipagem mais complexa.
        
        ```tsx
        type ValoresDeChave<T, K extends keyof T> = T[K] extends string ? "String" : "Outro";
        
        ```
        
- **Boas Práticas:**
    - **Reutilização de Tipos:** Utilize `keyof` e `typeof` para evitar duplicação de definições de tipos, promovendo DRY (Don't Repeat Yourself).
    - **Segurança de Tipos:** Aproveite esses operadores para garantir que apenas chaves válidas e tipos corretos sejam utilizados, prevenindo erros em tempo de compilação.

## 6. Referências para Estudo Independente

- [Documentação Oficial do TypeScript - `keyof`](https://www.typescriptlang.org/docs/handbook/2/keyof-types.html)
- [Documentação Oficial do TypeScript - `typeof`](https://www.typescriptlang.org/docs/handbook/2/type-queries.html)
- [TypeScript Deep Dive - `keyof` e `typeof`](https://basarat.gitbook.io/typescript/type-system/keyof-typeof)
- [Artigo: Understanding `keyof` and `typeof` in TypeScript](https://www.typescriptlang.org/docs/handbook/advanced-types.html#keyof-typeof)
- [Livro: Programming TypeScript](https://www.oreilly.com/library/view/programming-typescript/9781492037644/)
- [Curso: Advanced TypeScript no Udemy](https://www.udemy.com/course/advanced-typescript/)
- [GitHub Repository - TypeScript Samples](https://github.com/microsoft/TypeScriptSamples)

## 7. Formatação em Markdown

Este documento está organizado utilizando a sintaxe Markdown, com cabeçalhos (`#`, `##`, `###`) para estruturar as seções, listas ordenadas e não ordenadas para itens detalhados, e trechos de código formatados com blocos de código ```typescript``` para melhor legibilidade e compreensão dos exemplos apresentados.

## 8. Conclusão

Os operadores **`keyof`** e **`typeof`** são ferramentas indispensáveis no TypeScript para a criação de tipos dinâmicos e flexíveis. **`keyof`** permite extrair as chaves de um objeto como um tipo de união, facilitando a criação de funções e tipos que dependem das propriedades de outros objetos de forma segura e reutilizável. **`typeof`** possibilita a obtenção de tipos de variáveis e expressões existentes, promovendo a consistência e evitando redundância na definição de tipos. Ao dominar esses operadores, os desenvolvedores podem criar sistemas de tipagem mais robustos, seguros e eficientes, aproveitando ao máximo os benefícios da tipagem estática que o TypeScript oferece. Integrar **`keyof`** e **`typeof`** com outros recursos avançados de TypeScript, como generics e tipos condicionais, amplia ainda mais as possibilidades de modelagem de dados, resultando em aplicações mais escaláveis e de fácil manutenção.