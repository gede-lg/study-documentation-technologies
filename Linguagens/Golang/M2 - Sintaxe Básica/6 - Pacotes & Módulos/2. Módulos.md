### Módulos em Go

#### O que são Módulos?

Os módulos em Go são a forma moderna de gerenciar o código-fonte e suas dependências. Um módulo é uma coleção de pacotes Go que são versionados juntos. Eles permitem que você controle as versões das bibliotecas que seu projeto depende e ajudam a evitar problemas de compatibilidade.

##### Para que servem?

Os módulos servem para:
- **Gerenciar dependências:** Facilitar a inclusão e atualização de bibliotecas externas.
- **Versão do código:** Permitir a especificação de versões específicas de pacotes para garantir a compatibilidade.
- **Compartilhar código:** Facilitar o compartilhamento e reuso de pacotes entre diferentes projetos.

#### Como Funcionam?

Os módulos são controlados por dois arquivos principais:
- **go.mod:** Este arquivo define o módulo e suas dependências.
- **go.sum:** Este arquivo registra os checksums das dependências para garantir a integridade.

##### Criação de um Módulo

1. **Inicializar um novo módulo:**

   Navegue até o diretório raiz do seu projeto e execute:

   ```sh
   go mod init myproject
   ```

   Isso cria um arquivo `go.mod` que define o nome do módulo.

2. **Estrutura de um arquivo `go.mod`:**

   ```go
   module myproject

   go 1.16

   require (
       github.com/some/package v1.2.3
   )
   ```

   Aqui, `module myproject` define o nome do módulo, `go 1.16` define a versão do Go utilizada, e `require` lista as dependências do módulo com suas versões.

3. **Adicionar dependências:**

   Para adicionar uma nova dependência, você pode usar o comando `go get`:

   ```sh
   go get github.com/some/package@v1.2.3
   ```

   Isso adiciona a dependência ao arquivo `go.mod` e atualiza `go.sum`.

##### Importação de Pacotes de Módulos

Para usar um pacote de um módulo no seu código, basta importá-lo normalmente:

```go
package main

import (
    "fmt"
    "github.com/some/package"
)

func main() {
    package.SomeFunction()
    fmt.Println("Hello, Go Modules!")
}
```

#### Gerenciamento de Dependências

Confira mais detalhes em:
[[1.3 Gerenciamento de Dependências]]

Gerenciar dependências em Go com módulos é simples, mas há algumas práticas e comandos importantes a serem conhecidos.

##### Comandos Principais

1. **`go get`**:
   - Adiciona uma nova dependência ou atualiza uma existente.
   - Exemplo: `go get github.com/some/package@v1.2.3`

2. **`go mod tidy`**:
   - Remove dependências não utilizadas e adiciona qualquer dependência faltante que esteja no código, mas não no `go.mod`.
   - Exemplo: `go mod tidy`

3. **`go mod vendor`**:
   - Cria um diretório `vendor/` que contém todas as dependências do módulo. Isso é útil para garantir que todas as dependências estão presentes e não dependem da conectividade da rede.
   - Exemplo: `go mod vendor`

4. **`go mod verify`**:
   - Verifica a integridade das dependências baixadas comparando com os checksums em `go.sum`.
   - Exemplo: `go mod verify`

5. **`go mod download`**:
   - Faz o download das dependências listadas no `go.mod`.
   - Exemplo: `go mod download`

##### `go.sum` File

O arquivo `go.sum` armazena os checksums das dependências. Isso garante que as dependências não foram modificadas por terceiros. Sempre que uma dependência é adicionada ou atualizada, o `go.sum` é atualizado automaticamente.

#### Exemplo Completo

Vamos criar um exemplo completo de um projeto Go com módulos.

**Estrutura do projeto:**

```
myproject/
    go.mod
    go.sum
    main.go
    math/
        math.go
```

**math/math.go:**

```go
package math

// Add soma dois inteiros e retorna o resultado.
func Add(a int, b int) int {
    return a + b
}
```

**main.go:**

```go
package main

import (
    "fmt"
    "myproject/math"
)

func main() {
    sum := math.Add(3, 4)
    fmt.Println("Soma:", sum)
}
```

**go.mod:**

```go
module myproject

go 1.16
```

1. **Inicialize o módulo:**

   Navegue até o diretório raiz do projeto e execute:

   ```sh
   go mod init myproject
   ```

2. **Adicionar uma dependência:**

   Vamos adicionar uma dependência fictícia:

   ```sh
   go get github.com/some/package@v1.2.3
   ```

   Isso adiciona a linha correspondente no `require` do `go.mod` e atualiza o `go.sum`.

3. **Executar o programa:**

   ```sh
   go run main.go
   ```

   Isso compila e executa o programa, utilizando as dependências especificadas.

#### Práticas Recomendadas

1. **Mantenha seu `go.mod` limpo:** Use `go mod tidy` regularmente para remover dependências não utilizadas.
2. **Use versões específicas:** Especifique versões específicas para evitar que mudanças em pacotes externos quebrem seu código.
3. **Verifique a integridade:** Use `go mod verify` para garantir que as dependências não foram comprometidas.
4. **Documente as dependências:** Mantenha um histórico claro das mudanças de dependências no seu repositório de controle de versão.

#### Conclusão

Os módulos em Go são uma ferramenta poderosa para gerenciar dependências e versionar seu código de maneira eficaz. Com a introdução dos módulos, Go tornou-se mais robusto e escalável, permitindo que desenvolvedores mantenham seus projetos organizados e compatíveis com bibliotecas externas.