
Go oferece um suporte robusto para manipulação de JSON através do pacote `encoding/json`. Dentro deste pacote, a estrutura `Decoder` permite a leitura e decodificação de streams de dados JSON. A seguir, veremos uma explicação detalhada sobre o tipo `Decoder` e suas principais funções.
### O que é e para que serve?

`Decoder` é uma estrutura no pacote `encoding/json` que facilita a decodificação de JSON a partir de um stream, como um arquivo ou uma conexão de rede. Ele é útil para trabalhar com grandes documentos JSON ou quando você deseja ler e processar JSON incrementalmente.

### Quando utilizar?

Utilize `Decoder` quando você estiver trabalhando com streams de dados JSON e precisar decodificá-los em estruturas Go de forma eficiente e incremental. Isso é particularmente útil para grandes documentos JSON ou dados recebidos via rede.

> [!NOTE]
> # Func NewDecoder

### O que é e para que serve?

A função `NewDecoder` cria um novo decodificador que lê de um `io.Reader`. Um `io.Reader` pode ser qualquer fonte de entrada, como um arquivo, uma conexão de rede ou um buffer de memória.

### Sintaxe de Uso

```go
func NewDecoder(r io.Reader) *Decoder
```

### Exemplos

```go
file, err := os.Open("data.json")
if err != nil {
    log.Fatal(err)
}
defer file.Close()

decoder := json.NewDecoder(file)
```

### Restrições de Uso

O `io.Reader` passado para `NewDecoder` deve fornecer dados JSON válidos. Se os dados não forem JSON, as operações subsequentes falharão.

> [!NOTE]
> # Func Buffered

### O que é e para que serve?

`Buffered` retorna um `io.Reader` que fornece os dados não consumidos ainda pelo decodificador. Isso pode ser útil para acessar diretamente o buffer de dados restantes.

### Sintaxe de Uso

```go
func (dec *Decoder) Buffered() io.Reader
```

### Exemplos

```go
bufferedReader := decoder.Buffered()
```

### Restrições de Uso

O `io.Reader` retornado pode conter dados adicionais além do JSON, dependendo da origem dos dados.

> [!NOTE]
> # Func Decode

### O que é e para que serve?

`Decode` lê o próximo valor JSON do stream e o armazena na variável `v`, que deve ser um ponteiro para uma estrutura de dados apropriada.

### Sintaxe de Uso

```go
func (dec *Decoder) Decode(v any) error
```

### Exemplos

```go
var data MyStruct
err := decoder.Decode(&data)
if err != nil {
    log.Fatal(err)
}
```

### Restrições de Uso

`Decode` espera que `v` seja um ponteiro para a estrutura de destino. Se `v` não for um ponteiro ou se o JSON não puder ser deserializado na estrutura de destino, a função retornará um erro.

> [!NOTE]
> # Func DisallowUnknownFields

### O que é e para que serve?

`DisallowUnknownFields` instrui o decodificador a retornar um erro quando encontrar campos desconhecidos no JSON. Isso é útil para garantir que o JSON corresponda exatamente à estrutura esperada.

### Sintaxe de Uso

```go
func (dec *Decoder) DisallowUnknownFields()
```

### Exemplos

```go
decoder.DisallowUnknownFields()
```

### Restrições de Uso

Utilize esta função quando precisar de um controle estrito sobre os campos permitidos no JSON. Campos extras no JSON causarão um erro de decodificação.

> [!NOTE]
> # Func InputOffset

### O que é e para que serve?

`InputOffset` retorna o número de bytes lidos do stream até o momento. Isso pode ser útil para rastrear o progresso da decodificação.

### Sintaxe de Uso

```go
func (dec *Decoder) InputOffset() int64
```

### Exemplos

```go
offset := decoder.InputOffset()
```

### Restrições de Uso

A função é segura para uso durante a decodificação, mas os dados retornados são válidos apenas até a próxima leitura do decodificador.

> [!NOTE]
> # Func More

### O que é e para que serve?

`More` retorna `true` se houver mais dados JSON a serem lidos no stream. É útil para verificar se todos os valores foram decodificados.

### Sintaxe de Uso

```go
func (dec *Decoder) More() bool
```

### Exemplos

```go
for decoder.More() {
    var data MyStruct
    err := decoder.Decode(&data)
    if err != nil {
        log.Fatal(err)
    }
    // Process data
}
```

### Restrições de Uso

A função só faz sentido em streams de dados onde múltiplos valores JSON estão presentes.

> [!NOTE]
> # Func Token

### O que é e para que serve?

`Token` retorna o próximo token JSON no stream. Um token pode ser uma delimitação (`{`, `}`, `[`, `]`), uma string, um número ou um valor literal (`true`, `false`, `null`).

### Sintaxe de Uso

```go
func (dec *Decoder) Token() (Token, error)
```

### Exemplos

```go
for {
    token, err := decoder.Token()
    if err == io.EOF {
        break
    }
    if err != nil {
        log.Fatal(err)
    }
    fmt.Printf("Token: %v\n", token)
}
```

### Restrições de Uso

`Token` é útil para processamento de baixo nível de JSON. Para a maioria das operações, `Decode` é mais conveniente.

> [!NOTE]
> # Func UseNumber

### O que é e para que serve?

`UseNumber` instrui o decodificador a tratar todos os números JSON como o tipo `json.Number`, em vez de float64. Isso é útil para evitar perda de precisão em números grandes.

### Sintaxe de Uso

```go
func (dec *Decoder) UseNumber()
```

### Exemplos

```go
decoder.UseNumber()

var data map[string]interface{}
err := decoder.Decode(&data)
if err != nil {
    log.Fatal(err)
}

if num, ok := data["number"].(json.Number); ok {
    // Trabalhe com json.Number
}
```

### Restrições de Uso

Utilize esta função se você precisa preservar a precisão de números grandes ou se precisa fazer processamento adicional dos números após a decodificação.

## Conclusão

O tipo `Decoder` e suas funções associadas fornecem uma maneira poderosa e flexível de trabalhar com streams de dados JSON em Go. Eles permitem a decodificação incremental, controle sobre campos desconhecidos, rastreamento do progresso da leitura e mais. Utilizar essas ferramentas corretamente pode tornar seu código mais robusto e eficiente ao lidar com dados JSON.