# Guia Completo do Comando `format` do Dart CLI

## Sumário

- [Introdução](#introdução)
- [O que é e para que serve o comando `format`](#o-que-é-e-para-que-serve-o-comando-format)
- [Sintaxe de Uso](#sintaxe-de-uso)
- [Opções de Parâmetros](#opções-de-parâmetros)
  - [`--line-length`](#--line-length)
  - [`--fix`](#--fix)
  - [`--dry-run` ou `-n`](#--dry-run-ou--n)
  - [`--set-exit-if-changed`](#--set-exit-if-changed)
  - [`--output`](#--output)
  - [`--overwrite`](#--overwrite)
  - [`--help` ou `-h`](#--help-ou--h)
- [Exemplos de Uso](#exemplos-de-uso)
- [Restrições de Uso](#restrições-de-uso)
- [Boas Práticas e Dicas](#boas-práticas-e-dicas)
- [Conclusão](#conclusão)

---

## Introdução

O Dart é uma linguagem de programação otimizada para desenvolvimento de aplicativos móveis, web e de servidor. Para manter a consistência e a legibilidade do código, é fundamental seguir padrões de formatação. O comando `format` do Dart CLI é uma ferramenta poderosa que automatiza esse processo, garantindo que seu código esteja sempre alinhado com as diretrizes de estilo recomendadas.

---

## O que é e para que serve o comando `format`

### O que é?

O comando `dart format` é uma utilidade de linha de comando que formata o código-fonte Dart de acordo com o [Guia de Estilo do Dart](https://dart.dev/guides/language/effective-dart/style). Ele ajusta automaticamente a indentação, espaçamento, quebras de linha e outros aspectos do código para melhorar a legibilidade e a consistência.

### Para que serve?

- **Consistência de Estilo:** Garante que todo o código em um projeto siga o mesmo padrão de formatação.
- **Melhora a Legibilidade:** Código bem formatado é mais fácil de ler e entender.
- **Facilita a Colaboração:** Quando todos os membros da equipe usam o mesmo estilo, reduz-se o tempo gasto em revisões de código focadas em estilo.
- **Automação:** Evita a necessidade de formatar código manualmente, economizando tempo e reduzindo erros humanos.

---

## Sintaxe de Uso

```bash
dart format [opções] <arquivo ou diretório>
```

- **`[opções]`**: Parâmetros que modificam o comportamento do formatador.
- **`<arquivo ou diretório>`**: Um ou mais arquivos ou diretórios a serem formatados.

**Exemplo Básico:**

```bash
dart format lib/main.dart
```

Formata o arquivo `main.dart` localizado na pasta `lib`.

---

## Opções de Parâmetros

O comando `format` oferece várias opções para personalizar o processo de formatação.

### `--line-length`

- **Descrição:** Define o comprimento máximo das linhas. O valor padrão é 80 caracteres.
- **Sintaxe:**

  ```bash
  dart format --line-length=<número> <arquivo ou diretório>
  ```

- **Quando Utilizar:**

  - Quando o projeto adota um comprimento de linha diferente do padrão.
  - Para melhorar a legibilidade em telas maiores ou menores.

- **Exemplo:**

  ```bash
  dart format --line-length=100 lib/
  ```

  Formata todos os arquivos na pasta `lib/` com linhas de até 100 caracteres.

### `--fix`

- **Descrição:** Aplica correções de estilo que não são feitas por padrão pelo formatador, como a remoção de `new` ou `const` desnecessários.
- **Sintaxe:**

  ```bash
  dart format --fix <arquivo ou diretório>
  ```

- **Quando Utilizar:**

  - Para atualizar o código para as práticas mais recentes recomendadas.
  - Ao migrar código legado para padrões atuais.

- **Exemplo:**

  ```bash
  dart format --fix lib/main.dart
  ```

### `--dry-run` ou `-n`

- **Descrição:** Exibe quais arquivos seriam formatados sem realmente modificá-los.
- **Sintaxe:**

  ```bash
  dart format --dry-run <arquivo ou diretório>
  ```
  
  ou
  
  ```bash
  dart format -n <arquivo ou diretório>
  ```

- **Quando Utilizar:**

  - Para verificar quais arquivos estão fora do padrão antes de aplicar as mudanças.
  - Em pipelines de CI/CD para identificar problemas de formatação.

- **Exemplo:**

  ```bash
  dart format --dry-run lib/
  ```

### `--set-exit-if-changed`

- **Descrição:** Retorna um código de saída diferente de zero se algum arquivo seria modificado pela formatação.
- **Sintaxe:**

  ```bash
  dart format --set-exit-if-changed <arquivo ou diretório>
  ```

- **Quando Utilizar:**

  - Em processos automatizados para garantir que o código esteja formatado corretamente.
  - Para falhar uma build se a formatação não estiver conforme o padrão.

- **Exemplo:**

  ```bash
  dart format --set-exit-if-changed lib/
  ```

### `--output`

- **Descrição:** Controla como a saída formatada é apresentada.
- **Opções:**
  - `write` (padrão): Escreve as mudanças diretamente nos arquivos.
  - `show`: Exibe o código formatado no console.
  - `json`: Fornece informações sobre as mudanças em formato JSON.

- **Sintaxe:**

  ```bash
  dart format --output=<opção> <arquivo ou diretório>
  ```

- **Quando Utilizar:**

  - **`show`**: Para visualizar o código formatado sem alterar os arquivos.
  - **`json`**: Para integrar com outras ferramentas que processam JSON.

- **Exemplo:**

  ```bash
  dart format --output=show lib/main.dart
  ```

### `--overwrite`

- **Descrição:** Sobrescreve arquivos somente leitura durante a formatação.
- **Sintaxe:**

  ```bash
  dart format --overwrite <arquivo ou diretório>
  ```

- **Quando Utilizar:**

  - Quando precisa forçar a formatação em arquivos protegidos.
  - Deve ser usado com cautela para evitar perda de dados.

- **Exemplo:**

  ```bash
  dart format --overwrite lib/
  ```

### `--help` ou `-h`

- **Descrição:** Exibe ajuda detalhada sobre o comando `format` e suas opções.
- **Sintaxe:**

  ```bash
  dart format --help
  ```

- **Quando Utilizar:**

  - Para obter informações rápidas sobre como usar o comando e suas opções.

---

## Exemplos de Uso

### Formatar Todos os Arquivos em um Diretório

```bash
dart format lib/
```

Formata todos os arquivos Dart dentro da pasta `lib/` e suas subpastas.

### Formatar Múltiplos Arquivos Específicos

```bash
dart format lib/main.dart test/widget_test.dart
```

Formata apenas os arquivos `main.dart` e `widget_test.dart`.

### Verificar Quais Arquivos Precisam de Formatação (Sem Modificar)

```bash
dart format --dry-run lib/
```

Lista os arquivos que seriam alterados pelo formatador.

### Integrar com Processos de Build

Para garantir que o código esteja sempre formatado corretamente:

```bash
dart format --set-exit-if-changed lib/
```

Se algum arquivo precisar de formatação, o comando retornará um código de saída diferente de zero, útil para pipelines de CI/CD.

### Exibir o Código Formatado no Console

```bash
dart format --output=show lib/main.dart
```

Mostra o código formatado de `main.dart` no terminal, sem alterar o arquivo original.

### Formatar com Comprimento de Linha Personalizado

```bash
dart format --line-length=120 lib/
```

Define o comprimento máximo de linha para 120 caracteres durante a formatação.

---

## Restrições de Uso

- **Apenas Arquivos `.dart`:** O comando `format` só formata arquivos com extensão `.dart`. Outros tipos de arquivos serão ignorados.
- **Alterações Irreversíveis:** Uma vez aplicado, o formatador modifica os arquivos. Recomenda-se usar controle de versão para poder reverter se necessário.
- **Conflitos de Merge:** Aplicar formatação em grandes partes do código pode causar conflitos em branches paralelos. Planeje a formatação em coordenação com a equipe.
- **Cuidado com `--overwrite`:** Sobrescrever arquivos somente leitura pode causar perda de dados se não houver backup adequado.

---

## Boas Práticas e Dicas

- **Integrar com a IDE:** Configure seu editor (VS Code, Android Studio, etc.) para formatar o código automaticamente ao salvar.
- **Uso de Hooks Git:** Utilize hooks de pré-commit para formatar o código antes de cada commit, garantindo que todo o código no repositório esteja formatado.
  
  **Exemplo de Hook de Pré-Commit:**

  Crie um arquivo chamado `pre-commit` em `.git/hooks/` com o seguinte conteúdo:

  ```bash
  #!/bin/sh
  dart format .
  git add .
  ```

- **Consistência de Configurações:** Certifique-se de que toda a equipe utiliza as mesmas configurações de formatação, especialmente o comprimento de linha.
- **Revisões de Código Focadas:** Com o código já formatado, as revisões podem se concentrar na lógica e funcionalidade, não no estilo.
- **Evitar Formatações em Massa Sem Necessidade:** Grandes reformatações podem dificultar o tracking de histórico e revisões. Aplique formatação conforme necessário.

---

## Conclusão

O comando `format` do Dart CLI é uma ferramenta indispensável para manter a qualidade e consistência do código em projetos Dart. Ao automatizar a formatação, você economiza tempo e reduz erros, permitindo que você e sua equipe se concentrem no que realmente importa: construir excelentes aplicações.

---

**Referências Adicionais:**

- [Documentação Oficial do Dart - Format](https://dart.dev/tools/dart-format)
- [Guia de Estilo do Dart](https://dart.dev/guides/language/effective-dart/style)
- [Integração do Dart Format com Editores](https://dart.dev/tools/dart-format#using-dart-format-in-editors)

---

**Observação:** Manter um código bem formatado não é apenas uma questão estética, mas também uma prática que facilita a manutenção, colaboração e escalabilidade do projeto. A adoção consistente do `dart format` contribui significativamente para a saúde a longo prazo do seu código-base.